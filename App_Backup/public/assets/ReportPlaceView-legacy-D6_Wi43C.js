System.register(["./index-legacy-DryGZUwD.js","./html5-qrcode-legacy-D5DtuMLO.js"],function(e,l){"use strict";var a,t,u,n,o,i,r,s,d,c,v,m,_,f,p,b,g,y,k,w,h,R,x,S,C,D,V,j,L;return{setters:[e=>{a=e.d,t=e.r,u=e.bm,n=e.o,o=e.s,i=e.c,r=e.w,s=e.u,d=e.B,c=e.bG,v=e.b,m=e.e,_=e.O,f=e.P,p=e.Q,b=e.p,g=e.S,y=e.k,k=e.D,w=e.G,h=e.E,R=e.t,x=e.N,S=e.aj,C=e.n,D=e.b5,V=e.F,j=e.bC,L=e.y},null],execute:function(){e("default",a({__name:"ReportPlaceView",setup(e){const l=u(),a=d(),P=t(!1),T=t(""),q=t("success"),E=Number(l.params.id),F=t(null),G=t(""),N=t(null),O=t(!1);async function submitReport(){var e,l;if(!F.value||!G.value.trim())return;O.value=!0;const{error:t}=await o.from("location_reports").insert([{location_id:F.value.id,description:G.value.trim(),created_at:(new Date).toISOString(),reported_by:null!==(e=null===(l=N.value)||void 0===l?void 0:l.id)&&void 0!==e?e:null}]);O.value=!1,t?(T.value="Failed to submit report.",q.value="danger"):(T.value="✅ Report submitted successfully!",q.value="success",setTimeout(()=>a.back(),1e3)),P.value=!0}return n(async()=>{const{data:{user:e}}=await o.auth.getUser();N.value=e,E&&async function fetchPlace(){const{data:e,error:l}=await o.from("locations").select("id, name, image, lat, lng, location_types(name)").eq("id",E).single();l?(T.value="❌ Location not found.",q.value="danger",P.value=!0,setTimeout(()=>a.back(),1500)):F.value=e}()}),(e,l)=>{const t=c("ion-input");return v(),i(s(L),null,{default:r(()=>[m(s(_),null,{default:r(()=>[m(s(f),null,{default:r(()=>[m(s(p),null,{default:r(()=>l[3]||(l[3]=[b("Report Location",-1)])),_:1,__:[3]})]),_:1})]),_:1}),m(s(g),{class:"ion-padding"},{default:r(()=>[F.value?(v(),i(s(k),{key:0},{default:r(()=>[m(s(w),null,{default:r(()=>[m(s(h),null,{default:r(()=>[b(R(F.value.name),1)]),_:1})]),_:1}),m(s(x),null,{default:r(()=>[m(s(S),null,{default:r(()=>{var e;return[m(s(C),{position:"stacked"},{default:r(()=>l[4]||(l[4]=[b("Type",-1)])),_:1,__:[4]}),m(t,{value:(null===(e=F.value.location_types)||void 0===e?void 0:e.name)||"Halal Location",readonly:""},null,8,["value"])]}),_:1}),m(s(S),null,{default:r(()=>[m(s(D),{label:"Reason","label-placement":"floating",modelValue:G.value,"onUpdate:modelValue":l[0]||(l[0]=e=>G.value=e),"auto-grow":"",placeholder:"Explain what’s wrong with this location"},null,8,["modelValue"])]),_:1}),m(s(V),{expand:"block",color:"danger",onClick:submitReport,disabled:!G.value.trim()||O.value},{default:r(()=>l[5]||(l[5]=[b(" Submit Report ",-1)])),_:1,__:[5]},8,["disabled"]),m(s(V),{expand:"block",fill:"clear",onClick:l[1]||(l[1]=e=>s(a).back())},{default:r(()=>l[6]||(l[6]=[b(" Cancel ",-1)])),_:1,__:[6]})]),_:1})]),_:1})):y("",!0),m(s(j),{"is-open":P.value,message:T.value,color:q.value,duration:"2000",onDidDismiss:l[2]||(l[2]=e=>P.value=!1),style:{transform:"translateY(-55px)"}},null,8,["is-open","message","color"])]),_:1})]),_:1})}}}))}}});
