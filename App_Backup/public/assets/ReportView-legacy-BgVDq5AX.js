System.register(["./index-legacy-DryGZUwD.js","./html5-qrcode-legacy-D5DtuMLO.js"],function(e,l){"use strict";var a,u,t,o,n,r,d,s,c,i,v,f,_,m,p,b,g,y,k,w,R,x,h,S,C,D,P,V,j;return{setters:[e=>{a=e.d,u=e.r,t=e.bm,o=e.o,n=e.s,r=e.c,d=e.w,s=e.u,c=e.B,i=e.b,v=e.e,f=e.O,_=e.P,m=e.Q,p=e.p,b=e.S,g=e.k,y=e.D,k=e.G,w=e.E,R=e.t,x=e.N,h=e.aj,S=e.n,C=e.by,D=e.b5,P=e.F,V=e.bC,j=e.y},null],execute:function(){e("default",a({__name:"ReportView",setup(e){const l=t(),a=c(),q=u(!1),B=u(""),E=u("success"),F=l.params.barcode,O=u(null),T=u(""),U=u(null),G=u(!1);async function submitReport(){var e,l;if(!O.value||!T.value.trim())return;G.value=!0;const{error:u}=await n.from("product_reports").insert([{barcode:O.value.barcode,description:T.value.trim(),created_at:(new Date).toISOString(),reported_by:null!==(e=null===(l=U.value)||void 0===l?void 0:l.id)&&void 0!==e?e:null}]);G.value=!1,u?(B.value="Failed to submit report.",E.value="danger"):(B.value="Report submitted!",E.value="success",setTimeout(()=>a.back(),1e3)),q.value=!0}return o(async()=>{const{data:{user:e}}=await n.auth.getUser();U.value=e,F&&async function fetchProduct(){const{data:e,error:l}=await n.from("products").select("*").eq("barcode",F).single();l?(B.value="âŒ Product not found.",E.value="danger",q.value=!0,setTimeout(()=>a.back(),1500)):O.value=e}()}),(e,l)=>(i(),r(s(j),null,{default:d(()=>[v(s(f),null,{default:d(()=>[v(s(_),null,{default:d(()=>[v(s(m),null,{default:d(()=>l[3]||(l[3]=[p("Report Product",-1)])),_:1,__:[3]})]),_:1})]),_:1}),v(s(b),{class:"ion-padding"},{default:d(()=>[O.value?(i(),r(s(y),{key:0},{default:d(()=>[v(s(k),null,{default:d(()=>[v(s(w),null,{default:d(()=>[p(R(O.value.name),1)]),_:1})]),_:1}),v(s(x),null,{default:d(()=>[v(s(h),null,{default:d(()=>[v(s(S),{position:"stacked"},{default:d(()=>l[4]||(l[4]=[p("Barcode",-1)])),_:1,__:[4]}),v(s(C),{value:O.value.barcode,readonly:""},null,8,["value"])]),_:1}),v(s(h),null,{default:d(()=>[v(s(D),{label:"Reason","label-placement":"floating",modelValue:T.value,"onUpdate:modelValue":l[0]||(l[0]=e=>T.value=e),"auto-grow":"",placeholder:"Explain the issue"},null,8,["modelValue"])]),_:1}),v(s(P),{expand:"block",color:"danger",onClick:submitReport,disabled:!T.value.trim()||G.value},{default:d(()=>l[5]||(l[5]=[p(" Submit Report ",-1)])),_:1,__:[5]},8,["disabled"]),v(s(P),{expand:"block",fill:"clear",onClick:l[1]||(l[1]=e=>s(a).back())},{default:d(()=>l[6]||(l[6]=[p(" Cancel ",-1)])),_:1,__:[6]})]),_:1})]),_:1})):g("",!0),v(s(V),{"is-open":q.value,message:B.value,color:E.value,duration:"2000",onDidDismiss:l[2]||(l[2]=e=>q.value=!1),style:{transform:"translateY(-55px)"}},null,8,["is-open","message","color"])]),_:1})]),_:1}))}}))}}});
