!function(){function _defineProperty(e,a,t){return(a=function _toPropertyKey(e){var a=function _toPrimitive(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,a||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:a+""}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}System.register(["./index-legacy-DryGZUwD.js","./index-legacy-DeRWDn8A.js","./useDailyMissions-legacy-BvsQ50IF.js","./html5-qrcode-legacy-D5DtuMLO.js"],function(e,a){"use strict";var t,i,o,r,s,n,l,c,d,u,m,p,h,v,f,g,b,y,x,_,w,k,M,j,$,T,P,C,z,S,L,D,A,N,Y,q,O,H,B,R,I,U,E,F,W,J,Z,G,K,Q,V,X,ee,ae,te,ie,oe,re,se,ne,le,ce,de,ue,me,pe,he,ve,fe,ge,be,ye,xe,_e,we,ke,Me,je,$e;return{setters:[e=>{t=e.r,i=e.s,o=e.z,r=e.d,s=e.A,n=e.B,l=e.o,c=e.C,d=e.c,u=e.b,m=e.u,p=e.D,h=e.w,v=e.e,f=e.i,g=e.E,b=e.p,y=e.t,x=e.F,_=e.j,w=e.k,k=e.G,M=e.H,j=e.J,$=e.l,T=e.K,P=e.L,C=e.M,z=e.n,S=e.N,L=e.O,D=e.P,A=e.Q,N=e.R,Y=e.S,q=e.T,O=e.U,H=e.V,B=e.W,R=e.X,I=e.m,U=e.Y,E=e.Z,F=e.$,W=e.a0,J=e.a1,Z=e._,G=e.a2,K=e.a3,Q=e.a4,V=e.a5,X=e.a6,ee=e.a7,ae=e.a8,te=e.a,ie=e.a9,oe=e.aa,re=e.ab,se=e.ac,ne=e.ad,le=e.ae,ce=e.af,de=e.ag,ue=e.ah,me=e.ai,pe=e.aj,he=e.ak,ve=e.al,fe=e.y},e=>{ge=e.C,be=e.p,ye=e.a,xe=e.b,_e=e.A,we=e.B,ke=e.c,Me=e.L,je=e.D},e=>{$e=e.u},null],execute:function(){var a=document.createElement("style");function getLevelLabel(e){return`Level ${o(e)}`}function getLevelColor(e){const a=o(e);return a<10?"medium":a<50?"primary":a<100?"success":"warning"}a.textContent=".mission-icon-container[data-v-5668c9ed]{width:100%;height:70px;background:var(--ion-background-color);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.8rem;position:relative;box-shadow:inset 0 0 10px rgba(0,0,0,.02)}.bonus-card-premium .mission-icon-container[data-v-5668c9ed]{background:linear-gradient(135deg,var(--ion-background-color) 0%,rgba(var(--ion-color-carrot-rgb),.1) 100%)}.is-completed.bonus-card-premium .mission-icon-container[data-v-5668c9ed]{background:linear-gradient(135deg,var(--ion-background-color) 0%,rgba(var(--ion-color-success-rgb),.15) 100%)}.mission-completed-border[data-v-5668c9ed]{border:1.5px solid rgba(var(--ion-color-success-rgb),.4)!important}.mini-badge[data-v-5668c9ed]{position:absolute;top:-4px;right:-4px;font-size:.6rem;--padding-start: 4px;--padding-end: 4px;border-radius:4px}.discover-points[data-v-5668c9ed]{font-size:.7rem;color:var(--ion-color-carrot);font-weight:700;margin-top:2px}.mission-progress-overlay[data-v-5668c9ed]{position:absolute;top:4px;right:4px;width:18px;height:18px}.mini-circular-chart[data-v-5668c9ed]{display:block}.circle-bg[data-v-5668c9ed]{fill:none;stroke:#eee;stroke-width:4}.circle[data-v-5668c9ed]{fill:none;stroke-width:4;stroke-linecap:round;stroke:var(--ion-color-carrot);transition:stroke-dasharray .3s ease}.missions-vertical-list[data-v-5668c9ed]{display:flex;flex-direction:column;gap:16px}.v-mission-item[data-v-5668c9ed]{background:var(--ion-color-light);padding:16px;border-radius:16px}.v-mission-info[data-v-5668c9ed]{display:flex;align-items:center;gap:16px;margin-bottom:12px}.v-icon-wrap[data-v-5668c9ed]{width:40px;height:40px;background:var(--ion-background-color);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.4rem}.v-text-wrap[data-v-5668c9ed]{flex:1}.v-label[data-v-5668c9ed]{font-weight:700;font-size:.95rem}.v-progress-text[data-v-5668c9ed]{font-size:.8rem;color:var(--ion-color-medium)}.v-points[data-v-5668c9ed]{font-weight:800;color:var(--ion-color-carrot)}.bonus-item.can-claim[data-v-5668c9ed]{border:1.5px solid var(--ion-color-carrot);animation:gentlePulse-5668c9ed 2s infinite}.bonus-item.completed[data-v-5668c9ed]{opacity:.8}.pulse-bg[data-v-5668c9ed]{animation:pulseBg-5668c9ed 2s infinite}@keyframes gentlePulse-5668c9ed{0%{box-shadow:0 0 rgba(var(--ion-color-carrot-rgb),.2)}70%{box-shadow:0 0 0 8px rgba(var(--ion-color-carrot-rgb),0)}to{box-shadow:0 0 rgba(var(--ion-color-carrot-rgb),0)}}@keyframes pulseBg-5668c9ed{0%{transform:scale(1);background:var(--ion-background-color)}50%{transform:scale(1.05);background:rgba(var(--ion-color-carrot-rgb),.1)}to{transform:scale(1);background:var(--ion-background-color)}}.loading-state[data-v-5668c9ed]{width:100%;display:flex;justify-content:center;padding:20px}.view-all-btn[data-v-5668c9ed]{position:relative}.red-dot[data-v-5668c9ed]{position:absolute;top:-2px;right:-4px;width:9px;height:9px;background-color:var(--ion-color-danger);border-radius:50%;border:2px solid var(--ion-card-background, #fff);box-shadow:0 0 5px rgba(var(--ion-color-danger-rgb),.5);z-index:10}.bonus-dashboard-card[data-v-5668c9ed]{background:linear-gradient(135deg,#4d2b0a,#2d1a06)!important;border-color:rgba(var(--ion-color-carrot-rgb),.5)!important;border-style:solid!important;border-width:1.5px!important;box-shadow:0 4px 15px rgba(var(--ion-color-carrot-rgb),.15)!important;padding:0!important}.bonus-dashboard-card.is-claimed[data-v-5668c9ed]{background:linear-gradient(135deg,#0e2a1a,#05140d)!important;border-color:rgba(var(--ion-color-success-rgb),.4)!important;box-shadow:none!important}.bonus-dashboard-card .mission-icon-container[data-v-5668c9ed]{background:transparent!important;box-shadow:none!important;height:80px}.bonus-dashboard-card .discover-label[data-v-5668c9ed]{padding:0 8px 12px!important}.pulse-ring[data-v-5668c9ed]{position:absolute;width:32px;height:32px;border:2px solid var(--ion-color-carrot);border-radius:50%;animation:pulse-5668c9ed 2s infinite;opacity:0}@keyframes pulse-5668c9ed{0%{transform:scale(.5);opacity:0}50%{opacity:.5}to{transform:scale(1.5);opacity:0}}.completion-message[data-v-5668c9ed]{display:flex;align-items:center;justify-content:center;gap:10px;background:rgba(var(--ion-color-success-rgb),.1);padding:12px;border-radius:12px;margin-top:16px;border:1px dashed rgba(var(--ion-color-success-rgb),.3)}.completion-message p[data-v-5668c9ed]{margin:0;font-size:.85rem;font-weight:600;color:var(--ion-color-success-shade)}.completion-message ion-icon[data-v-5668c9ed]{font-size:1.4rem}.modal-completion-info[data-v-5668c9ed]{text-align:center;padding:5px;color:var(--ion-color-medium)}.modal-completion-info p[data-v-5668c9ed]{font-weight:800;font-size:1.1rem;color:var(--ion-color-success);margin-bottom:4px}.fade-in[data-v-5668c9ed]{animation:fadeIn-5668c9ed .5s ease-in}@keyframes fadeIn-5668c9ed{0%{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}.featured-card[data-v-3a235bac]{display:flex;flex-direction:column;justify-content:center}.chart-flex[data-v-3a235bac]{display:flex;justify-content:center;align-items:center;width:100%;padding:20px 0}.chart-flex canvas[data-v-3a235bac]{width:100%;max-height:400px}.scan-row[data-v-3a235bac]{margin-top:10px;display:flex;gap:1rem;flex-wrap:wrap}.scan-row[data-v-3a235bac]>*{flex:1}.scan-row ion-button[data-v-3a235bac]{text-transform:none;font-size:1.4rem;font-weight:600;height:80px;--border-radius: 16px}.prayer-card[data-v-3a235bac]{--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0}.prayer-card ion-card-header[data-v-3a235bac]{padding:4px 4px 2px}.prayer-card ion-card-title[data-v-3a235bac]{font-size:1rem;font-weight:600}.prayer-card ion-card-content[data-v-3a235bac]{padding:0}.prayer-header[data-v-3a235bac]{display:flex;justify-content:space-between;align-items:center}.current-time[data-v-3a235bac]{font-size:.8rem;font-weight:500;color:var(--ion-color-medium);letter-spacing:.04em}.prayer-horizontal[data-v-3a235bac]{display:flex;gap:12px;overflow-x:auto;overflow-y:hidden;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none;padding:4px 4px 2px}.prayer-horizontal[data-v-3a235bac]::-webkit-scrollbar{display:none}.prayer-track[data-v-3a235bac]{display:grid;grid-auto-flow:column;grid-auto-columns:minmax(80px,1fr);gap:12px;width:100%;padding:4px 12px 2px}@media (min-width: 1024px){.prayer-track[data-v-3a235bac]{grid-auto-columns:minmax(100px,1fr)}}.prayer-header-row[data-v-3a235bac]{display:flex;align-items:center;justify-content:space-between;gap:8px}.qibla-header-btn[data-v-3a235bac]{font-weight:600;--padding-start: 10px;--padding-end: 10px}.prayer-pill[data-v-3a235bac]{flex:0 0 80px;scroll-snap-align:center;border-radius:6px;padding:7px 6px;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .25s ease;flex-shrink:0}.prayer-pill.now[data-v-3a235bac]{border:1px dashed rgba(217,119,6,.6)}.prayer-pill .label[data-v-3a235bac]{font-size:.7rem;color:var(--ion-color-medium)}.prayer-pill .time[data-v-3a235bac]{font-size:1rem;font-weight:600;margin-top:0}.prayer-pill.active[data-v-3a235bac]{background:rgba(217,119,6,.18);color:var(--ion-color-carrot);transform:scale(1.05);box-shadow:0 0 0 1px rgba(217,119,6,.4),0 6px 18px rgba(217,119,6,.25)}.prayer-pill.active .label[data-v-3a235bac]{color:var(--ion-color-carrot)}.qibla-row[data-v-3a235bac]{display:flex;justify-content:center;padding:6px 12px 4px}.qibla-btn[data-v-3a235bac]{font-size:.75rem;height:28px;--padding-start: 12px;--padding-end: 12px}.qibla-btn--block[data-v-3a235bac]{width:100%;height:32px;font-size:.8rem}.prayer-title-main[data-v-3a235bac]{font-size:1rem;font-weight:600}.prayer-title-location[data-v-3a235bac]{font-size:.75rem;color:var(--ion-color-medium);margin-top:2px}\n",document.head.appendChild(a);var Te={exports:{}};!function(e){class PrayTime{constructor(e){_defineProperty(this,"dtr",e=>e*Math.PI/180),_defineProperty(this,"rtd",e=>180*e/Math.PI),_defineProperty(this,"sin",e=>Math.sin(this.dtr(e))),_defineProperty(this,"cos",e=>Math.cos(this.dtr(e))),_defineProperty(this,"tan",e=>Math.tan(this.dtr(e))),_defineProperty(this,"arcsin",e=>this.rtd(Math.asin(e))),_defineProperty(this,"arccos",e=>this.rtd(Math.acos(e))),_defineProperty(this,"arctan",e=>this.rtd(Math.atan(e))),_defineProperty(this,"arccot",e=>this.rtd(Math.atan(1/e))),_defineProperty(this,"arctan2",(e,a)=>this.rtd(Math.atan2(e,a))),this.methods={MWL:{fajr:18,isha:17},ISNA:{fajr:15,isha:15},Egypt:{fajr:19.5,isha:17.5},Makkah:{fajr:18.5,isha:"90 min"},Karachi:{fajr:18,isha:18},Tehran:{fajr:17.7,maghrib:4.5,midnight:"Jafari"},Jafari:{fajr:16,maghrib:4,midnight:"Jafari"},France:{fajr:12,isha:12},Russia:{fajr:16,isha:15},Singapore:{fajr:20,isha:18},defaults:{isha:14,maghrib:"1 min",midnight:"Standard"}},this.settings={dhuhr:"0 min",asr:"Standard",highLats:"NightMiddle",tune:{},format:"24h",rounding:"nearest",utcOffset:"auto",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,location:[0,-(new Date).getTimezoneOffset()/4],iterations:1},this.labels=["Fajr","Sunrise","Dhuhr","Asr","Sunset","Maghrib","Isha","Midnight"],this.method(e||"MWL")}method(e){return this.set(this.methods.defaults).set(this.methods[e])}adjust(e){return this.set(e)}location(e){return this.set({location:e})}timezone(e){return this.set({timezone:e})}tune(e){return this.set({tune:e})}round(e="nearest"){return this.set({rounding:e})}format(e){return this.set({format:e})}set(e){return Object.assign(this.settings,e),this}utcOffset(e="auto"){return"number"==typeof e&&Math.abs(e)<16&&(e*=60),this.set({timezone:"UTC"}),this.set({utcOffset:e})}times(e=0){"number"==typeof e&&(e=new Date(e<1e3?Date.now()+864e5*e:e)),e.constructor===Date&&(e=[e.getFullYear(),e.getMonth()+1,e.getDate()]),this.utcTime=Date.UTC(e[0],e[1]-1,e[2]);let a=this.computeTimes();return this.formatTimes(a),a}getTimes(e,a,t="auto",i=0,o="24h"){if(!a)return this.times(e);const r="auto"==t?t:t+i;return this.location(a).utcOffset(r).format(o),this.times(e)}setMethod(e){this.method(e)}computeTimes(){let e={fajr:5,sunrise:6,dhuhr:12,asr:13,sunset:18,maghrib:18,isha:18,midnight:24};for(let a=0;a<this.settings.iterations;a++)e=this.processTimes(e);return this.adjustHighLats(e),this.updateTimes(e),this.tuneTimes(e),this.convertTimes(e),e}processTimes(e){const a=this.settings;return{fajr:this.angleTime(a.fajr,e.fajr,-1),sunrise:this.angleTime(.833,e.sunrise,-1),dhuhr:this.midDay(e.dhuhr),asr:this.angleTime(this.asrAngle(a.asr,e.asr),e.asr),sunset:this.angleTime(.833,e.sunset),maghrib:this.angleTime(a.maghrib,e.maghrib),isha:this.angleTime(a.isha,e.isha),midnight:this.midDay(e.midnight)+12}}updateTimes(e){const a=this.settings;if(this.isMin(a.maghrib)&&(e.maghrib=e.sunset+this.value(a.maghrib)/60),this.isMin(a.isha)&&(e.isha=e.maghrib+this.value(a.isha)/60),"Jafari"==a.midnight){const t=this.angleTime(a.fajr,29,-1)+24;e.midnight=(e.sunset+(this.adjusted?e.fajr+24:t))/2}e.dhuhr+=this.value(a.dhuhr)/60}tuneTimes(e){const a=this.settings.tune;for(let t in e)t in a&&(e[t]+=a[t]/60)}convertTimes(e){const a=this.settings.location[1];for(let t in e){const i=e[t]-a/15,o=this.utcTime+Math.floor(36e5*i);e[t]=this.roundTime(o)}}roundTime(e){const a={up:"ceil",down:"floor",nearest:"round"}[this.settings.rounding];if(!a)return e;return 6e4*Math[a](e/6e4)}sunPosition(e){const a=this.settings.location[1],t=this.utcTime/864e5-10957.5+this.value(e)/24-a/360,i=this.mod(357.529+.98560028*t,360),o=this.mod(280.459+.98564736*t,360),r=this.mod(o+1.915*this.sin(i)+.02*this.sin(2*i),360),s=23.439-36e-8*t,n=this.mod(this.arctan2(this.cos(s)*this.sin(r),this.cos(r))/15,24);return{declination:this.arcsin(this.sin(s)*this.sin(r)),equation:o/15-n}}midDay(e){const a=this.sunPosition(e).equation;return this.mod(12-a,24)}angleTime(e,a,t=1){const i=this.settings.location[0],o=this.sunPosition(a).declination,r=-this.sin(e)-this.sin(i)*this.sin(o),s=this.arccos(r/(this.cos(i)*this.cos(o)))/15;return this.midDay(a)+s*t}asrAngle(e,a){const t={Standard:1,Hanafi:2}[e]||this.value(e),i=this.settings.location[0],o=this.sunPosition(a).declination;return-this.arccot(t+this.tan(Math.abs(i-o)))}adjustHighLats(e){const a=this.settings;if("None"==a.highLats)return;this.adjusted=!1;const t=24+e.sunrise-e.sunset;Object.assign(e,{fajr:this.adjustTime(e.fajr,e.sunrise,a.fajr,t,-1),isha:this.adjustTime(e.isha,e.sunset,a.isha,t),maghrib:this.adjustTime(e.maghrib,e.sunset,a.maghrib,t)})}adjustTime(e,a,t,i,o=1){const r={NightMiddle:.5,OneSeventh:1/7,AngleBased:1/60*this.value(t)}[this.settings.highLats]*i,s=(e-a)*o;return(isNaN(e)||s>r)&&(e=a+r*o,this.adjusted=!0),e}formatTimes(e){for(let a in e)e[a]=this.formatTime(e[a])}formatTime(e){const a=this.settings.format;return isNaN(e)?"-----":"function"==typeof a?a(e):"x"==a.toLowerCase()?Math.floor(e/("X"==a?1e3:1)):this.timeToString(e,a)}timeToString(e,a){const t=this.settings.utcOffset,i=new Date(e+6e4*("auto"==t?0:t)).toLocaleTimeString("en-US",{timeZone:this.settings.timezone,hour12:"24h"!=a,hour:"24h"==a?"2-digit":"numeric",minute:"2-digit"});return"12H"==a?i.replace(/ ?[AP]M/,""):i}value(e){return+String(e).split(/[^0-9.+-]/)[0]}isMin(e){return-1!=String(e).indexOf("min")}mod(e,a){return(e%a+a)%a}}e.exports&&(e.exports={PrayTime:PrayTime})}(Te);var Pe=Te.exports;const Ce={class:"card-header-row"},ze={key:0,class:"red-dot"},Se={key:0,class:"discover-grid compact-grid"},Le={key:1,class:"completion-message fade-in",style:{"margin-top":"0"}},De={key:2,class:"discover-grid compact-grid"},Ae={class:"mission-icon-container"},Ne={key:0,class:"pulse-ring"},Ye={class:"discover-name",style:{"margin-top":"3px","font-weight":"800"}},qe={class:"discover-points"},Oe={class:"mission-icon-container"},He={key:0,class:"mission-progress-overlay"},Be={viewBox:"0 0 36 36",class:"mini-circular-chart"},Re={class:"discover-name",style:{"margin-top":"3px"}},Ie={class:"discover-points"},Ue={class:"missions-vertical-list"},Ee=["onClick"],Fe={class:"v-mission-info"},We={class:"v-icon-wrap"},Je={class:"v-text-wrap"},Ze={class:"v-label"},Ge={class:"v-progress-text"},Ke={class:"v-points"},Qe={class:"v-mission-info"},Ve={class:"v-text-wrap"},Xe={class:"v-label"},ea={class:"v-progress-text"},aa={key:0},ta={key:1},ia={key:2},oa={class:"v-points"},ra={key:0,class:"modal-completion-info"},sa=Z(r({__name:"DailyMissions",setup(e){const a=t(!1),{t:i}=s(),{missions:o,loading:r,claimedBonus:Z,allCompleted:G,fetchProgress:K,checkAndAwardBonus:Q}=$e(),V=n(),navigateToMission=e=>{switch(a.value=!1,e){case"open_app":V.push("/home");break;case"scan_ingredients":case"find_muslim_friendly":V.push("/scan");break;case"view_place_details":V.push("/explore");break;case"scan_barcode":V.push({path:"/search",query:{scan:"true"}});break;case"add_product":V.push("/add")}},getIcon=e=>{switch(e){case"scan-outline":return J;case"heart-outline":return W;case"location-outline":return F;case"barcode-outline":return E;case"add-circle-outline":return U;case"home-outline":return I;default:return C}};async function handleClaimBonus(){await Q()}return l(()=>{K()}),c(()=>{K()}),(e,t)=>(u(),d(m(p),{class:"compact-section no-pointer"},{default:h(()=>[v(m(k),null,{default:h(()=>[f("div",Ce,[v(m(g),null,{default:h(()=>[b(y(e.$t("dailyMissions.title")),1)]),_:1}),v(m(x),{fill:"clear",size:"small",color:"carrot",onClick:t[0]||(t[0]=e=>a.value=!0),class:"view-all-btn"},{default:h(()=>[b(y(e.$t("dailyMissions.viewAll"))+" ",1),m(Z)?w("",!0):(u(),_("div",ze))]),_:1})])]),_:1}),v(m(S),null,{default:h(()=>[m(r)?(u(),_("div",Se,[(u(),_(M,null,j(3,e=>v(m(p),{key:"mission-skel-"+e,class:"discover-item discover-item--compact"},{default:h(()=>[v(m(B),{animated:"",style:{width:"100%",height:"70px","border-radius":"10px"}}),v(m(B),{animated:"",style:{width:"80%",height:"14px",margin:"6px auto"}})]),_:2},1024)),64))])):m(G)&&m(Z)?(u(),_("div",Le,[v(m($),{icon:m(T),color:"success"},null,8,["icon"]),f("p",null,y(e.$t("dailyMissions.allCompletedMsg")),1)])):(u(),_("div",De,[m(G)?(u(),d(m(p),{key:0,class:P(["discover-item","discover-item--compact","bonus-dashboard-card",{"is-claimed":m(Z)}]),button:"",onClick:handleClaimBonus},{default:h(()=>[f("div",Ae,[v(m($),{icon:m(C),color:m(Z)?"success":"warning"},null,8,["icon","color"]),m(Z)?w("",!0):(u(),_("div",Ne))]),v(m(z),{class:"discover-label discover-label--compact"},{default:h(()=>[f("p",Ye,y(m(Z)?e.$t("dailyMissions.bonusClaimed"):e.$t("dailyMissions.claimBonus")),1),f("p",qe,y(e.$t("dailyMissions.bonusPoints",{label:e.$t("dailyMissions.xp")})),1)]),_:1})]),_:1},8,["class"])):w("",!0),(u(!0),_(M,null,j(m(o),a=>(u(),d(m(p),{key:a.id,class:P(["discover-item","discover-item--compact",{"mission-completed-border":a.completed}]),button:"",onClick:e=>navigateToMission(a.id)},{default:h(()=>[f("div",Oe,[v(m($),{icon:getIcon(a.icon),color:a.completed?"success":"medium"},null,8,["icon","color"]),a.completed?w("",!0):(u(),_("div",He,[(u(),_("svg",Be,[t[3]||(t[3]=f("path",{class:"circle-bg",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"},null,-1)),f("path",{class:"circle",style:R({strokeDasharray:Math.min(100,a.current/a.required*100)+", 100"}),d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"},null,4)]))]))]),v(m(z),{class:"discover-label discover-label--compact"},{default:h(()=>[f("p",Re,y(e.$t("dailyMissions.missions."+a.id)),1),f("p",Ie,y(a.current)+"/"+y(a.required)+" â€¢ +"+y(a.points)+" "+y(e.$t("dailyMissions.xp")),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]))]),_:1}),v(m(H),{"is-open":a.value,onDidDismiss:t[2]||(t[2]=e=>a.value=!1),"initial-breakpoint":.75,breakpoints:[0,.75,1]},{default:h(()=>[v(m(L),null,{default:h(()=>[v(m(D),null,{default:h(()=>[v(m(A),null,{default:h(()=>[b(y(e.$t("dailyMissions.title")),1)]),_:1}),v(m(N),{slot:"end"},{default:h(()=>[v(m(x),{onClick:t[1]||(t[1]=e=>a.value=!1)},{default:h(()=>[b(y(e.$t("dailyMissions.close")),1)]),_:1})]),_:1})]),_:1})]),_:1}),v(m(Y),{class:"ion-padding"},{default:h(()=>[f("div",Ue,[(u(!0),_(M,null,j(m(o),a=>(u(),_("div",{key:a.id,class:P(["v-mission-item",{completed:a.completed}]),onClick:e=>navigateToMission(a.id),style:{cursor:"pointer"}},[f("div",Fe,[f("div",We,[v(m($),{icon:getIcon(a.icon),color:a.completed?"success":"medium"},null,8,["icon","color"])]),f("div",Je,[f("div",Ze,y(e.$t("dailyMissions.missions."+a.id)),1),f("div",Ge,y(a.current)+" / "+y(a.required)+" "+y(e.$t("dailyMissions.completed")),1)]),f("div",Ke,"+"+y(a.points)+" "+y(e.$t("dailyMissions.xp")),1)]),v(m(O),{value:a.current/a.required,color:a.completed?"success":"carrot"},null,8,["value","color"])],10,Ee))),128)),f("div",{class:P(["v-mission-item bonus-item",{completed:m(Z),"can-claim":m(G)&&!m(Z)}]),onClick:handleClaimBonus,style:{cursor:"pointer"}},[f("div",Qe,[f("div",{class:P(["v-icon-wrap",{"pulse-bg":m(G)&&!m(Z)}])},[v(m($),{icon:m(q),color:m(Z)?"success":m(G)?"carrot":"medium"},null,8,["icon","color"])],2),f("div",Ve,[f("div",Xe,y(e.$t("dailyMissions.dailyBonus")),1),f("div",ea,[m(Z)?(u(),_("span",aa,y(e.$t("dailyMissions.alreadyClaimed")),1)):m(G)?(u(),_("span",ta,y(e.$t("dailyMissions.claimXpBonus")),1)):(u(),_("span",ia,y(e.$t("dailyMissions.dailyBonusDesc")),1))])]),f("div",oa,"+50 "+y(e.$t("dailyMissions.xp")),1)]),v(m(O),{value:m(Z)||m(G)?1:m(o).filter(e=>e.completed).length/m(o).length,color:m(Z)||m(G)?"success":"carrot"},null,8,["value","color"])],2),m(G)&&m(Z)?(u(),_("div",ra,[f("p",null,y(e.$t("dailyMissions.masteryAchieved")),1),f("small",null,y(e.$t("dailyMissions.comeBackTomorrow")),1)])):w("",!0)])]),_:1})]),_:1},8,["is-open"])]),_:1}))}}),[["__scopeId","data-v-5668c9ed"]]),na={class:"prayer-header-row"},la={class:"prayer-title-main"},ca={class:"prayer-title-location"},da={key:0,class:"prayer-horizontal"},ua={key:1,class:"qibla-row"},ma={class:"prayer-track"},pa=["data-key"],ha={class:"label"},va={class:"time"},fa={class:"scan-row"},ga={class:"scan-row"},ba={class:"card-header-row"},ya={key:0,class:"discover-grid compact-grid"},xa={key:1,class:"discover-grid compact-grid"},_a=["src","alt"],wa={class:"discover-name"},ka={class:"card-header-row"},Ma={key:0,class:"discover-grid"},ja={key:1,class:"discover-grid"},$a=["src","alt"],Ta={class:"card-header-row"},Pa={key:0,class:"discover-grid"},Ca={key:1,class:"discover-grid"},za=["src","alt"],Sa={class:"card-header-row"},La={key:0,class:"discover-grid"},Da={key:1,class:"discover-grid"},Aa=["src","alt"],Na={class:"discover-name"},Ya={style:{"font-size":"12px",color:"var(--ion-color-medium)"}},qa={class:"chart-flex"},Oa={class:"chart-flex"},Ha={style:{display:"flex","align-items":"center",width:"100%"}},Ba={style:{width:"28px","text-align":"center","font-weight":"600"}},Ra={key:0},Ia={key:1},Ua={key:2},Ea={key:3},Fa=["src","alt"],Wa={style:{margin:"0","font-weight":"600","font-size":"1rem","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},Ja={style:{margin:"0","font-size":"0.8rem",color:"var(--ion-color-medium)"}},Za={key:0},Ga=["src","alt"],Ka={style:{"margin-top":"6px","font-size":"1rem"}},Qa={style:{margin:"4px 0","font-size":"0.85rem",color:"var(--ion-color-medium)"}},Va={key:0,style:{"margin-top":"6px","font-size":"0.8rem",color:"var(--ion-color-dark)"}},Xa={style:{margin:"4px 0","font-size":"0.9rem","font-weight":"600"}},et={style:{margin:"4px 0","font-size":"0.85rem",color:"var(--ion-color-medium)"}},at=r({__name:"HomeView",setup(e){let a=null;const o=t(null),r=t(null);ge.register(be,ye,xe,_e,we,ke,Me);const T=je,C=n(),{t:D}=s(),{fetchProgress:A}=$e(),N=t(null),q=t(null),O=t(!0),H=t(!0),R=t(!0),I=t([]),U=t([]),W=t(!0),Z=t([]),Te=t(null),{leaderboard:Ce,loading:ze,fetchLeaderboard:Se}=function useLeaderboard(){const e=t([]),a=t(!1),o=t(null);return{leaderboard:e,loading:a,error:o,fetchLeaderboard:async function fetchLeaderboard(t=10){a.value=!0,o.value=null;const{data:r,error:s}=await i.from("user_profiles").select("id, display_name, avatar_url, points, donor_type, public_leaderboard, bio").gt("points",0).order("points",{ascending:!1}).limit(t);!s&&r&&(e.value=r.map((e,a)=>({...e,display_name:e.public_leaderboard?e.display_name:`Anonymous #${a+1}`,avatar_url:e.public_leaderboard?e.avatar_url:"https://placehold.co/64x64"}))),s?(console.error("âŒ Error fetching leaderboard:",s),o.value=s.message,e.value=[]):e.value=null!=r?r:[],a.value=!1}}}(),Le=t(!1),De={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",align:"center",labels:{color:getComputedStyle(document.documentElement).getPropertyValue("--ion-color-dark").trim(),boxWidth:14,font:{size:12},padding:8}}}},Ae=t({labels:["Halal","Muslim-friendly","Syubhah","Haram"],datasets:[{backgroundColor:["#28a745","#007bff","#ffc107","#dc3545"],data:[0,0,0,0]}]}),Ne=t({labels:[],datasets:[{backgroundColor:["#3498db","#2ecc71","#f1c40f","#e74c3c","#9b59b6","#1abc9c","#e67e22"],data:[]}]}),Ye=t([]),qe=t(!0),Oe=t(null),He=t(!0),Be=t(null);G.extend(K),G.extend(Q),G.extend(V);const Re=t(G.tz.guess());function fromNowToTaipei(e){return e?G.utc(e).tz(Re.value).fromNow():""}const Ie=t(G().tz(Re.value));async function fetchRecentNews(){W.value=!0;const{data:e,error:a}=await i.from("news").select("id, title, header_image, created_at").order("created_at",{ascending:!1}).limit(15);!a&&e&&(Z.value=e.map(e=>({id:e.id,title:e.title,cover:e.header_image||"https://placehold.co/400x250?text=News",created_at:e.created_at}))),W.value=!1}const Ue={gold:3,silver:2,bronze:1},Ee=X(()=>[...Ye.value].sort((e,a)=>(Ue[a.partner_tier]||0)-(Ue[e.partner_tier]||0)));async function fetchPrayerTimes(){He.value=!0;const e=await async function getUserLocation(){const e=localStorage.getItem("hf_user_location");if(e){const a=JSON.parse(e);return Te.value=a,a}try{let e,s;if(ie.isNativePlatform()){if("granted"!==(await re.requestPermissions()).location)throw new Error("Location permission denied");const a=await re.getCurrentPosition({enableHighAccuracy:!0});e=a.coords.latitude,s=a.coords.longitude}else{const a=await new Promise((e,a)=>{navigator.geolocation.getCurrentPosition(e,a)});e=a.coords.latitude,s=a.coords.longitude}let n=D("home.currentLocation");try{var a,t,i,o;const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${s}`,{headers:{Accept:"application/json","User-Agent":"HalalFormosaApp/1.0"}});console.log("Reverse status:",r.status);const l=await r.json();n=(null===(a=l.address)||void 0===a?void 0:a.city)||(null===(t=l.address)||void 0===t?void 0:t.town)||(null===(i=l.address)||void 0===i?void 0:i.municipality)||(null===(o=l.address)||void 0===o?void 0:o.state)||D("home.currentLocation")}catch(r){console.warn("[Reverse Geocode Failed]",r)}return Te.value={lat:e,lng:s,city:n},localStorage.setItem("hf_user_location",JSON.stringify(Te.value)),Te.value}catch(s){return console.warn("[GPS] Using fallback Taipei"),Te.value={lat:25.033,lng:121.5654,city:D("home.taipei")},Te.value}}(),a=new Pe.PrayTime("MWL");a.location([e.lat,e.lng]).timezone(Re.value).format("24h").adjust({highLats:"AngleBased"});const t=a.getTimes(new Date);Oe.value={fajr:t.fajr,sunrise:t.sunrise,dhuhr:t.dhuhr,asr:t.asr,maghrib:t.maghrib,isha:t.isha},He.value=!1}const Fe=X(()=>Oe.value?[{key:"fajr",label:D("home.prayers.fajr"),time:Oe.value.fajr},{key:"dhuhr",label:D("home.prayers.dhuhr"),time:Oe.value.dhuhr},{key:"asr",label:D("home.prayers.asr"),time:Oe.value.asr},{key:"maghrib",label:D("home.prayers.maghrib"),time:Oe.value.maghrib},{key:"isha",label:D("home.prayers.isha"),time:Oe.value.isha}]:[]),We=X(()=>{if(!Oe.value)return null;const e=Ie.value,a=e.format("YYYY-MM-DD"),t=Fe.value.map(e=>({...e,timeObj:G.tz(`${a} ${e.time}`,"YYYY-MM-DD HH:mm",Re.value)}));for(let i=0;i<t.length;i++){const a=t[i],o=t[i+1];if(o){if(e.isAfter(a.timeObj)&&e.isBefore(o.timeObj))return a.key}else if(e.isAfter(a.timeObj))return a.key}return"isha"}),Je=X(()=>{if(!Oe.value)return null;const e=Ie.value;for(const t of Fe.value){const a=G.tz(`${e.format("YYYY-MM-DD")} ${t.time}`,"YYYY-MM-DD HH:mm",Re.value);if(a.isAfter(e))return{...t,timeObj:a}}const a=G.tz(`${e.add(1,"day").format("YYYY-MM-DD")} ${Oe.value.fajr}`,"YYYY-MM-DD HH:mm",Re.value);return{key:"fajr",label:D("home.prayers.fajr"),time:Oe.value.fajr,timeObj:a}}),Ze=X(()=>We.value);ee(()=>Ze.value,async e=>{e&&(await se(),requestAnimationFrame(()=>{const a=Be.value;if(!a)return;const t=a.querySelector(`.prayer-pill[data-key="${e}"]`);if(!t)return;const i=t.offsetLeft-a.clientWidth/2+t.clientWidth/2;a.scrollTo({left:i,behavior:"smooth"})}))},{immediate:!0});const Ge=X(()=>{if(!Je.value)return"";const e=Je.value.timeObj.diff(Ie.value,"second");if(e<=0)return"00:00:00";return[Math.floor(e/3600),Math.floor(e%3600/60),e%60].map(e=>String(e).padStart(2,"0")).join(":")});function closePopover(){o.value=null,r.value=null}async function fetchRecentProducts(){H.value=!0;const{data:e,error:a}=await i.from("products").select("barcode, name, status, photo_front_url, created_at, product_categories(name)").eq("approved",!0).order("created_at",{ascending:!1}).limit(15);!a&&e&&(I.value=e.map(e=>{var a;return{barcode:e.barcode,name:e.name,status:e.status,category:(null===(a=e.product_categories)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.name)||"",image:e.photo_front_url,created_at:e.created_at}})),H.value=!1}async function fetchRecentLocations(){R.value=!0;const{data:e,error:a}=await i.from("locations").select("id, name, image, type_id, location_types(name), created_at").eq("approved",!0).order("created_at",{ascending:!1}).limit(15);!a&&e&&(U.value=e.map(e=>{var a;return{id:e.id,name:e.name,image:e.image,type:(null===(a=e.location_types)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.name)||"",created_at:e.created_at}})),R.value=!1}async function fetchStats(){O.value=!0;const{data:e}=await i.from("products").select("status, created_at");if(e){const a={Halal:0,"Muslim-friendly":0,Syubhah:0,Haram:0};e.forEach(e=>{void 0!==a[e.status]&&a[e.status]++}),function updateChartSmoothly(e,a){se(()=>{var t;if(null===(t=e.value)||void 0===t||!t.chart)return;const i=e.value.chart;i.data.datasets[0].data=a,i.update("active")})}(N,Object.values(a))}O.value=!1}async function fetchLocationCategoryStats(){const{data:e,error:a}=await i.from("locations").select("\n    id,\n    name,\n    image,\n    created_at,\n    location_types!inner ( name )\n  ").eq("approved",!0);if(!a&&e){const a={};null==e||e.forEach(e=>{var t;const i=(null===(t=e.location_types)||void 0===t?void 0:t.name)||D("home.unknown");a[i]=(a[i]||0)+1});const t=Object.keys(a),i=Object.values(a);Ne.value={labels:t,datasets:[{backgroundColor:["#3498db","#2ecc71","#e67e22","#9b59b6","#f1c40f","#e74c3c","#1abc9c"],data:i}]}}}async function fetchHomePartners(){qe.value=!0;const{data:e,error:a}=await i.from("partners").select("\n    id,\n    name,\n    logo_url,\n    partner_tier\n  ").eq("is_active",!0).order("partner_tier",{ascending:!1}).limit(6);if(a)return console.error("[Home Partners]",a),void(qe.value=!1);Ye.value=(null!=e?e:[]).map(e=>({id:e.id,name:e.name,partner_tier:e.partner_tier,logo:e.logo_url||`https://placehold.co/300x300?text=${encodeURIComponent(e.name)}`})),qe.value=!1}async function refreshAllData(){console.log("ðŸ  [Home] Refreshing all data...");const e=[fetchStats(),fetchLocationCategoryStats(),fetchRecentProducts(),fetchRecentLocations(),fetchRecentNews(),Se(),fetchHomePartners()];Le.value&&e.push(A()),await Promise.allSettled(e),ie.isNativePlatform()&&oe()}function goScan(){ae.log("home_scan_ingredient"),C.push("/scan")}function goToSearchAndScan(){ae.log("home_scan_barcode"),C.push({path:"/search",query:{scan:"true"}})}function goQibla(){ae.log("home_find_qibla_click"),C.push({path:"/qibla",query:{from:"home"}})}function viewMorePartners(){ae.log("home_viewmore_partners"),C.push("/partners")}function viewMoreProducts(){ae.log("home_viewmore_products"),C.push("/search")}function viewMoreLocations(){ae.log("home_viewmore_locations"),C.push("/explore")}function viewMoreNews(){ae.log("home_viewmore_news"),C.push("/news")}return c(async()=>{ae.log("home_page_open");const{data:e}=await i.auth.getSession();Le.value=!!e.session,refreshAllData(),fetchPrayerTimes(),function startClock(){a=window.setInterval(()=>{Ie.value=G().tz(Re.value)},1e3)}()}),l(()=>{refreshAllData()}),te(()=>{a&&(clearInterval(a),a=null)}),(e,a)=>(u(),d(m(fe),null,{default:h(()=>[v(m(L),null,{default:h(()=>[v(ne,{title:e.$t("home.title"),showProfile:!0},null,8,["title"])]),_:1}),v(m(Y),{class:"ion-padding"},{default:h(()=>[v(m(le),{slot:"fixed",onIonRefresh:a[0]||(a[0]=e=>async function handleRefresh(e){await refreshAllData(),e.target.complete()}(e))},{default:h(()=>[v(m(ce))]),_:1}),v(m(p),{class:"prayer-card"},{default:h(()=>[v(m(k),null,{default:h(()=>[f("div",na,[v(m(g),null,{default:h(()=>[Je.value&&Te.value?(u(),_(M,{key:0},[f("div",la,y(e.$t("home.prayerNotification",{label:Je.value.label,time:Ge.value})),1),f("div",ca,[v(m($),{icon:m(F),slot:"start"},null,8,["icon"]),b(" "+y(Te.value.city||e.$t("home.currentLocation")),1)])],64)):(u(),_(M,{key:1},[b(y(e.$t("home.prayerTimes")),1)],64))]),_:1}),v(m(x),{size:"small",fill:"outline",color:"carrot",class:"qibla-header-btn",onClick:goQibla},{default:h(()=>[b(" ðŸ§­ "+y(e.$t("home.qibla")),1)]),_:1})])]),_:1}),v(m(S),null,{default:h(()=>[He.value?(u(),_("div",da,[(u(),_(M,null,j(5,e=>f("div",{key:"prayer-skel-"+e,class:"prayer-pill skeleton"},[v(m(B),{animated:"",style:{width:"50%",height:"12px","border-radius":"6px"}}),v(m(B),{animated:"",style:{width:"70%",height:"22px","margin-top":"6px","border-radius":"6px"}})])),64))])):w("",!0),He.value?(u(),_("div",ua,[v(m(B),{animated:"",style:{width:"110px",height:"28px","border-radius":"999px"}})])):(u(),_("div",{key:2,class:"prayer-horizontal",ref_key:"prayerScroll",ref:Be},[f("div",ma,[(u(!0),_(M,null,j(Fe.value,e=>(u(),_("div",{key:e.key,"data-key":e.key,class:P(["prayer-pill",e.key===We.value?"active":""])},[f("span",ha,y(e.label),1),f("span",va,y(e.time),1)],10,pa))),128))])],512))]),_:1})]),_:1}),v(m(p),{class:"featured-card no-pointer"},{default:h(()=>[v(m(k),null,{default:h(()=>[v(m(g),null,{default:h(()=>[b(y(e.$t("home.mainFeature")),1)]),_:1})]),_:1}),v(m(S),null,{default:h(()=>[f("div",fa,[v(m(x),{expand:"block",color:"carrot",onClick:goScan},{default:h(()=>[v(m($),{icon:m(J),slot:"start"},null,8,["icon"]),b(" "+y(e.$t("home.scan")),1)]),_:1})]),f("div",ga,[v(m(x),{expand:"block",color:"carrot",onClick:goToSearchAndScan},{default:h(()=>[v(m($),{icon:m(E),slot:"start"},null,8,["icon"]),b(" "+y(e.$t("home.scanBarcode")),1)]),_:1})])]),_:1})]),_:1}),v(m(p),{class:"compact-section no-pointer"},{default:h(()=>[v(m(k),null,{default:h(()=>[f("div",ba,[v(m(g),null,{default:h(()=>[b(y(e.$t("home.ourPartners")),1)]),_:1}),v(m(x),{fill:"clear",size:"small",color:"carrot",onClick:viewMorePartners},{default:h(()=>[b(y(e.$t("home.viewMore")),1)]),_:1})])]),_:1}),v(m(S),null,{default:h(()=>[qe.value?(u(),_("div",ya,[(u(),_(M,null,j(5,e=>v(m(p),{key:"partner-skel-"+e,class:"discover-item discover-item--compact"},{default:h(()=>[v(m(B),{animated:"",style:{width:"100%",height:"120px","border-radius":"12px"}}),v(m(B),{animated:"",style:{width:"80%",height:"14px",margin:"6px auto"}})]),_:2},1024)),64))])):(u(),_("div",xa,[(u(!0),_(M,null,j(Ee.value,a=>(u(),d(m(p),{key:a.id,class:P(["discover-item","discover-item--compact",a.partner_tier]),button:"",onClick:e=>function openPartner(e){ae.log("home_partner_click",{id:e.id,name:e.name}),C.push(`/partner/${e.id}`)}(a)},{default:h(()=>[a.partner_tier?(u(),d(m(de),{key:0,class:P(["tier-badge",a.partner_tier])},{default:h(()=>[b(y(e.$t("home.partnerTier",{tier:a.partner_tier.toUpperCase()})),1)]),_:2},1032,["class"])):w("",!0),f("img",{src:a.logo,alt:a.name,class:"discover-img discover-img--compact"},null,8,_a),v(m(z),{class:"discover-label discover-label--compact"},{default:h(()=>[f("p",wa,y(a.name),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]))]),_:1})]),_:1}),Le.value?(u(),d(sa,{key:0})):w("",!0),v(m(p),{class:"no-pointer"},{default:h(()=>[v(m(k),null,{default:h(()=>[f("div",ka,[v(m(g),null,{default:h(()=>[b(y(e.$t("home.discoverProducts")),1)]),_:1}),v(m(x),{fill:"clear",size:"small",color:"carrot",onClick:viewMoreProducts},{default:h(()=>[b(y(e.$t("home.viewMore")),1)]),_:1})])]),_:1}),v(m(S),null,{default:h(()=>[H.value?(u(),_("div",Ma,[(u(),_(M,null,j(5,e=>v(m(p),{key:"skeleton-p-"+e,class:"discover-item"},{default:h(()=>[v(m(B),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),v(m(B),{animated:"",style:{width:"95%",height:"30px",margin:"6px auto"}}),v(m(B),{animated:"",style:{width:"40%",height:"12px",margin:"0 auto"}})]),_:2},1024)),64))])):(u(),_("div",ja,[(u(!0),_(M,null,j(I.value,a=>(u(),d(m(p),{key:a.barcode,class:"discover-item",button:"",onClick:e=>async function openProduct(e){ae.log("home_product_click",{barcode:e.barcode,name:e.name,status:e.status}),C.push(`/item/${e.barcode}`)}(a)},{default:h(()=>[f("img",{src:a.image||"https://placehold.co/200x200",alt:e.$t("home.altProduct"),class:"discover-img"},null,8,$a),v(m(z),{class:"discover-label"},{default:h(()=>[v(m(ue),{class:P("Halal"===a.status?"chip-success":"Muslim-friendly"===a.status?"chip-primary":"Syubhah"===a.status?"chip-warning":"Haram"===a.status?"chip-danger":"chip-medium"),style:{"font-size":"14px","margin-bottom":"4px"}},{default:h(()=>[b(y(a.status),1)]),_:2},1032,["class"]),f("p",null,y(e.$t("home.added"))+" "+y(fromNowToTaipei(a.created_at)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1}),v(m(p),{class:"no-pointer"},{default:h(()=>[v(m(k),null,{default:h(()=>[f("div",Ta,[v(m(g),null,{default:h(()=>[b(y(e.$t("home.discoverLocations")),1)]),_:1}),v(m(x),{fill:"clear",size:"small",color:"carrot",onClick:viewMoreLocations},{default:h(()=>[b(y(e.$t("home.viewMore")),1)]),_:1})])]),_:1}),v(m(S),null,{default:h(()=>[R.value?(u(),_("div",Pa,[(u(),_(M,null,j(5,e=>v(m(p),{key:"skeleton-l-"+e,class:"discover-item"},{default:h(()=>[v(m(B),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),v(m(B),{animated:"",style:{width:"90%",height:"12px",margin:"6px auto"}}),v(m(B),{animated:"",style:{width:"80%",height:"12px",margin:"6px auto"}}),v(m(B),{animated:"",style:{width:"40%",height:"12px",margin:"0 auto"}})]),_:2},1024)),64))])):(u(),_("div",Ca,[(u(!0),_(M,null,j(U.value,a=>(u(),d(m(p),{key:a.id,class:"discover-item",button:"",onClick:e=>async function openLocation(e){ae.log("home_location_click",{id:e.id,name:e.name,type:e.type}),C.push(`/place/${e.id}`)}(a)},{default:h(()=>[f("img",{src:a.image||"https://placehold.co/200x200",alt:e.$t("home.altLocation"),class:"discover-img"},null,8,za),v(m(z),{class:"discover-label"},{default:h(()=>[f("h3",null,y(a.name),1),f("p",null,y(e.$t("home.added"))+" "+y(fromNowToTaipei(a.created_at)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1}),v(m(p),{class:"no-pointer"},{default:h(()=>[v(m(k),null,{default:h(()=>[f("div",Sa,[v(m(g),null,{default:h(()=>[b(y(e.$t("home.latestNews")),1)]),_:1}),v(m(x),{fill:"clear",size:"small",color:"carrot",onClick:viewMoreNews},{default:h(()=>[b(y(e.$t("home.viewMore")),1)]),_:1})])]),_:1}),v(m(S),null,{default:h(()=>[W.value?(u(),_("div",La,[(u(),_(M,null,j(5,e=>v(m(p),{key:"news-skeleton-"+e,class:"discover-item"},{default:h(()=>[v(m(B),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),v(m(B),{animated:"",style:{width:"90%",height:"14px",margin:"6px auto"}}),v(m(B),{animated:"",style:{width:"60%",height:"12px",margin:"0 auto"}})]),_:2},1024)),64))])):(u(),_("div",Da,[(u(!0),_(M,null,j(Z.value,a=>(u(),d(m(p),{key:a.id,class:"discover-item",style:{height:"210px"},button:"",onClick:e=>function openNews(e){ae.log("home_news_click",{id:e.id,title:e.title}),C.push(`/news/${e.id}`)}(a)},{default:h(()=>[f("img",{src:a.cover||"https://placehold.co/400x250?text=News",class:"discover-img",alt:e.$t("home.altNews")},null,8,Aa),v(m(z),{class:"discover-label"},{default:h(()=>[f("h3",Na,y(a.title),1),f("p",Ya,y(fromNowToTaipei(a.created_at)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1}),v(m(p),null,{default:h(()=>[v(m(k),null,{default:h(()=>[v(m(g),null,{default:h(()=>[b(y(e.$t("home.productStatus")),1)]),_:1})]),_:1}),f("div",qa,[v(m(T),{ref_key:"doughnutRef",ref:N,data:Ae.value,options:De},null,8,["data"])])]),_:1}),v(m(p),null,{default:h(()=>[v(m(k),null,{default:h(()=>[v(m(g),null,{default:h(()=>[b(y(e.$t("home.locationCategories")),1)]),_:1})]),_:1}),f("div",Oa,[v(m(T),{ref_key:"locationChartRef",ref:q,data:Ne.value,options:De},null,8,["data"])])]),_:1}),v(m(p),null,{default:h(()=>[v(m(k),null,{default:h(()=>[v(m(g),null,{default:h(()=>[b(y(e.$t("home.leaderboard")),1)]),_:1})]),_:1}),v(m(S),null,{default:h(()=>[m(ze)?(u(),d(m(B),{key:1,animated:"",style:{width:"100%",height:"120px","border-radius":"8px"}})):(u(),d(m(me),{key:0},{default:h(()=>[(u(!0),_(M,null,j(m(Ce),(a,t)=>(u(),d(m(pe),{key:a.id,lines:"none",button:"",onClick:e=>function openUserProfile(e,a){ae.log("home_leaderboard_profile",{user_id:e.id,display_name:e.display_name}),o.value=e,r.value=a}(a,e)},{default:h(()=>[f("div",Ha,[f("div",Ba,[0===t?(u(),_("span",Ra,"ðŸ¥‡")):1===t?(u(),_("span",Ia,"ðŸ¥ˆ")):2===t?(u(),_("span",Ua,"ðŸ¥‰")):(u(),_("span",Ea,y(t+1),1))]),v(m(he),{style:{width:"40px",height:"40px",margin:"0 10px"}},{default:h(()=>[f("img",{src:a.public_leaderboard?a.avatar_url||"https://placehold.co/64x64":`https://placehold.co/64x64?text=${e.$t("home.unknownAvatar")}`,alt:e.$t("home.altAvatar")},null,8,Fa)]),_:2},1024),v(m(z),{style:{flex:"1","min-width":"0"}},{default:h(()=>[f("h2",Wa,y(a.public_leaderboard?a.display_name:e.$t("home.anonymousWithIndex",{index:t+1})),1),f("p",Ja,y(m(getLevelLabel)(a.points)),1)]),_:2},1024),v(m(de),{color:m(getLevelColor)(a.points),style:{"white-space":"nowrap","font-size":"0.75rem","min-width":"70px","text-align":"center"}},{default:h(()=>[b(y(e.$t("home.pointsCount",{points:a.points})),1)]),_:2},1032,["color"])])]),_:2},1032,["onClick"]))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),v(m(ve),{"is-open":!!o.value,event:r.value,onDidDismiss:closePopover},{default:h(()=>[v(m(Y),{class:"ion-padding",style:{"text-align":"center","min-width":"220px"}},{default:h(()=>[o.value?(u(),_("div",Za,[o.value.public_leaderboard?(u(),_(M,{key:0},[v(m(he),{style:{width:"60px",height:"60px",margin:"auto"}},{default:h(()=>[f("img",{src:o.value.avatar_url||"https://placehold.co/60x60?text=?",alt:e.$t("home.altAvatar")},null,8,Ga)]),_:1}),f("h3",Ka,y(o.value.display_name),1),f("p",Qa,y(m(getLevelLabel)(o.value.points))+" ("+y(e.$t("home.pointsCount",{points:o.value.points}))+") ",1),o.value.bio?(u(),_("p",Va,y(o.value.bio),1)):w("",!0)],64)):(u(),_(M,{key:1},[f("p",Xa,y(e.$t("home.anonymous")),1),f("p",et,y(m(getLevelLabel)(o.value.points))+" ("+y(e.$t("home.pointsCount",{points:o.value.points}))+") ",1)],64))])):w("",!0)]),_:1})]),_:1},8,["is-open","event"])]),_:1}))}});e("default",Z(at,[["__scopeId","data-v-3a235bac"]]))}}})}();
