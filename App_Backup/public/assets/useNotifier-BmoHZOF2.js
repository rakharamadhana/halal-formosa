import{s as n}from"./index-D9IhqqAc.js";function useNotifier(){return{notifyEvent:async(e,t,o,c,i={},a=["discord","onesignal"])=>{try{const s="myapp://";i.link||("new_product"!==e&&"update_product"!==e||!i.barcode?"new_place"!==e&&"update_place"!==e||!i.id?"new_article"!==e&&"update_article"!==e||!i.id||(i.link="".concat(s,"news/").concat(i.id)):i.link="".concat(s,"place/").concat(i.id):i.link="".concat(s,"item/").concat(i.barcode));const{data:{session:r}}=await n.auth.getSession(),l={"Content-Type":"application/json"};(null==r?void 0:r.access_token)?l.Authorization="Bearer ".concat(r.access_token):l.Authorization="Bearer ".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN2bWx3bnptaGVpaXNoa2R3YWZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMzNDk3OTUsImV4cCI6MjA2ODkyNTc5NX0.DQ5Xuq0F2x_5EJAMzUQreAWY9ecyTCd3mORl-Fo0Ydo");const u={type:null!=e?e:"unknown",title:null!=t?t:"Notification",message:null!=o?o:"",image:c||null,data:i||{},channels:a},d=await fetch("".concat("https://svmlwnzmheiishkdwafk.supabase.co","/functions/v1/notify-event"),{method:"POST",headers:l,body:JSON.stringify(u)});return d.ok?(console.log("✅ notifyEvent sent:",e,i.link||"no link"),{success:!0}):(console.error("❌ notifyEvent failed:",await d.text()),{success:!1})}catch(s){return console.error("❌ notifyEvent exception:",s),{success:!1,error:String(s)}}}}}export{useNotifier as u};
