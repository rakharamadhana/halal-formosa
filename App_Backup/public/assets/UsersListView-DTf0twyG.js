import{d as a,a2 as s,a5 as e,r as t,o as l,c as i,w as n,u as r,s as o,B as c,b as u,e as d,O as f,ad as v,aN as _,S as p,ae as h,af as m,ai as g,j as U,H as w,J as y,aj as k,L as b,ak as x,n as j,i as I,t as L,ag as N,p as R,cf as B,cg as C,y as M,_ as q}from"./index-D9IhqqAc.js";import"./html5-qrcode-D_4nuB1t.js";const A=["src"],F={key:1,class:"avatar-placeholder"},H={class:"user-name"},J={class:"user-email"},O={class:"user-meta"},S={class:"last-active"},V=q(a({__name:"UsersListView",setup(a){s.extend(e);const q=c(),V=t([]),z=t(!1),D=t(!1);async function handleRefresh(a){await fetchUsers(!0),a.target.complete()}async function fetchUsers(a=!1){a&&(V.value=[],D.value=!1);const s=V.value.length,{data:e,error:t}=await o.rpc("get_admin_user_list",{p_limit:15,p_offset:s});t?console.error("‚ùå Failed to load users:",t):((!e||e.length<15)&&(D.value=!0),V.value.push(...e))}async function loadMore(a){z.value||D.value||(z.value=!0,await fetchUsers(),z.value=!1),a.target.complete()}return l(()=>fetchUsers(!0)),(a,e)=>(u(),i(r(M),null,{default:n(()=>[d(r(f),null,{default:n(()=>[d(v,{title:"Users",icon:r(_),showBack:!0},null,8,["icon"])]),_:1}),d(r(p),{class:"ion-padding"},{default:n(()=>[d(r(h),{slot:"fixed",onIonRefresh:handleRefresh},{default:n(()=>[d(r(m))]),_:1}),d(r(g),null,{default:n(()=>[(u(!0),U(w,null,y(V.value,a=>(u(),i(r(k),{key:a.user_id,button:"",detail:"",class:b({inactive:0===a.total_activities}),onClick:s=>function openUser(a){q.push("/admin/users/".concat(a.user_id))}(a)},{default:n(()=>[d(r(x),{slot:"start"},{default:n(()=>[a.avatar_url?(u(),U("img",{key:0,src:a.avatar_url,alt:"User Avatar"},null,8,A)):(u(),U("div",F," üë§ "))]),_:2},1024),d(r(j),null,{default:n(()=>{return[I("h2",H,L(a.display_name||a.email||"Unknown User"),1),I("p",J,L(a.email),1),I("div",O,[d(r(N),{color:a.total_activities>1e3?"warning":"primary"},{default:n(()=>[R(L(a.total_activities)+" activities ",1)]),_:2},1032,["color"]),I("span",S," Last active "+L((e=a.last_active,e?s(e).fromNow():"Never active")),1)])];var e}),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),d(r(B),{threshold:"100px",onIonInfinite:loadMore,disabled:D.value},{default:n(()=>[d(r(C),{"loading-spinner":"bubbles","loading-text":"Loading users..."})]),_:1},8,["disabled"])]),_:1})]),_:1}))}}),[["__scopeId","data-v-37f71cf2"]]);export{V as default};
