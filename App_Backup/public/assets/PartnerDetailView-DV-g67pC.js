import{d as e,bm as a,r as t,o as l,a8 as r,c as i,w as n,u as o,s,b as d,e as u,O as c,ad as p,S as _,i as v,j as m,W as f,H as g,X as h,L as y,k as w,t as b,ag as k,p as x,J as C,ah as P,D as z,G as L,E as q,N as $,n as j,aS as D,V as N,F as S,bp as T,br as B,y as V,bN as W,_ as H}from"./index-D9IhqqAc.js";import{Z as I}from"./zoom-oVw40Yze.js";import{B as E}from"./index-mXqEtQG2.js";import"./html5-qrcode-D_4nuB1t.js";const F={class:"hero-cover"},G={key:0,class:"hero-content"},J=["src","alt"],O={class:"body-name"},X={class:"ion-padding"},Z={class:"scope-inline"},A={key:1,class:"body-description"},K={key:1,class:"program-list"},M={key:1,class:"discover-grid"},Q=["src"],R={class:"discover-name"},U={key:1,class:"discover-grid"},Y=["src"],ee={class:"discover-name"},ae={style:{"font-size":"12px",color:"var(--ion-color-medium)"}},te={key:1,class:"discover-grid"},le=["src"],re={class:"discover-name"},ie={style:{"font-size":"12px",color:"var(--ion-color-medium)"}},ne={key:0},oe={key:1},se={key:2},de={class:"swiper-zoom-container"},ue=["src","alt"],ce=H(e({__name:"PartnerDetailView",setup(e){const H=a().params.id,ce=t(!0),pe=t(!1);function openLogoPreview(){r.log("partner_logo_preview",{partner_id:_e.value.id,partner_name:_e.value.name,partner_tier:_e.value.partner_tier}),pe.value=!0}function closeLogoPreview(){pe.value=!1}const _e=t({id:"",name:"",logo:"",verified:!1,partner_tier:null,scopes:[],about:"",programs:[],address:"",phone:"",email:"",website:""});const ve=t([]),me=t(!1);const fe=t([]),ge=t(!1);const he=t([]),ye=t(!1);async function openWebsite(){r.log("partner_website_click",{partner_id:_e.value.id,partner_name:_e.value.name,partner_tier:_e.value.partner_tier,website:_e.value.website}),await E.open({url:_e.value.website,windowName:"_self",toolbarColor:"#e67e22",presentationStyle:"fullscreen"})}return l(async()=>{H&&(ce.value=!0,await async function fetchPartner(e){var a,t,l,r,i,n,o,d,u;const{data:c,error:p}=await s.from("partners").select("\n    id,\n    name,\n    slug,\n    logo_url,\n    verified,\n    partner_tier,\n    about,\n    address,\n    phone,\n    email,\n    website,\n\n    partners_scopes (\n      partner_scopes (\n        id,\n        name,\n        icon,\n        color\n      )\n    ),\n\n    partner_programs (\n      id,\n      name\n    )\n  ").eq("id",e).single();p?console.error("[Partner]",p):_e.value={id:c.id,name:c.name,logo:c.logo_url,verified:c.verified,partner_tier:c.partner_tier,about:null!=(a=c.about)?a:"",address:null!=(t=c.address)?t:"",phone:null!=(l=c.phone)?l:"",email:null!=(r=c.email)?r:"",website:null!=(i=c.website)?i:"",scopes:null!=(o=null==(n=c.partners_scopes)?void 0:n.map(e=>e.partner_scopes.name))?o:[],programs:null!=(u=null==(d=c.partner_programs)?void 0:d.map(e=>e.name))?u:[]}}(H),ce.value=!1,r.log("partner_detail_open",{partner_id:_e.value.id,partner_name:_e.value.name,partner_tier:_e.value.partner_tier,verified:_e.value.verified}),"gold"===_e.value.partner_tier&&(!async function fetchCertifiedProducts(){if("gold"!==_e.value.partner_tier)return;me.value=!0;const{data:e,error:a}=await s.from("product_certifications").select("\n      id,\n      certified_at,\n      products (\n        id,\n        barcode,\n        name,\n        status,\n        photo_front_url\n      )\n    ").eq("partner_id",_e.value.id).eq("status","active");!a&&e&&(ve.value=e.filter(e=>e.products).map(e=>({...e.products,certified_at:e.certified_at}))),me.value=!1}(),async function fetchCertifiedLocations(){if("gold"!==_e.value.partner_tier)return;ge.value=!0;const{data:e,error:a}=await s.from("location_certifications").select("\n      certified_at,\n      locations (\n        id,\n        name,\n        image,\n        address,\n        location_types ( name )\n      )\n    ").eq("partner_id",_e.value.id).eq("status","active");!a&&e&&(fe.value=e.filter(e=>e.locations).map(e=>({...e.locations,certified_at:e.certified_at}))),ge.value=!1}(),async function fetchPartnerTrips(){if("gold"!==_e.value.partner_tier)return;ye.value=!0;const{data:e,error:a}=await s.from("trips").select("\n      id,\n      title,\n      title_zh,\n      cover_url,\n      duration,\n      external_url\n    ").eq("provider_id",_e.value.id).eq("is_active",!0).order("created_at",{ascending:!1});!a&&e&&(he.value=e),ye.value=!1}()))}),(e,a)=>(d(),i(o(V),null,{default:n(()=>[u(o(c),null,{default:n(()=>[u(p,{title:_e.value.name||e.$t("partner.detailTitle"),showBack:!0,icon:"none"},null,8,["title"])]),_:1}),u(o(_),null,{default:n(()=>[v("div",F,[ce.value?(d(),m("div",G,[u(o(f),{animated:"",style:{width:"96px",height:"96px","border-radius":"12px","margin-bottom":"8px"}}),u(o(f),{animated:"",style:{width:"180px",height:"20px"}})])):(d(),m(g,{key:1},[v("div",{class:"hero-bg",style:h({backgroundImage:"url(".concat(_e.value.logo,")")})},null,4),v("div",{class:y(["hero-content","gold"===_e.value.partner_tier&&"hf-gold-glow"])},[v("div",{class:y(["hero-logo-wrap",{"gold-glow-wrap":"gold"===_e.value.partner_tier}]),onClick:openLogoPreview},[v("img",{src:_e.value.logo,alt:_e.value.name,class:"hero-logo clickable"},null,8,J)],2),v("h2",O,b(_e.value.name),1),_e.value.partner_tier?(d(),i(o(k),{key:0,class:y(["tier-badge","partner-detail-badge","".concat(_e.value.partner_tier),"ion-text-uppercase"])},{default:n(()=>[x(b(_e.value.partner_tier)+" Partner ",1)]),_:1},8,["class"])):_e.value.verified?(d(),i(o(k),{key:1,color:"success",class:"verified-badge"},{default:n(()=>a[0]||(a[0]=[x(" Verified Halal Certification Body ",-1)])),_:1,__:[0]})):w("",!0)],2)],64))]),v("div",X,[v("div",Z,[(d(!0),m(g,null,C(_e.value.scopes,e=>(d(),i(o(P),{key:e,class:"scope-chip chip-primary"},{default:n(()=>[x(b(e),1)]),_:2},1024))),128))]),u(o(z),null,{default:n(()=>[u(o(L),null,{default:n(()=>[u(o(q),null,{default:n(()=>[x(b(e.$t("partner.about")),1)]),_:1})]),_:1}),u(o($),null,{default:n(()=>[ce.value?(d(),m(g,{key:0},[u(o(f),{animated:"",style:{width:"100%",height:"14px","margin-bottom":"8px"}}),u(o(f),{animated:"",style:{width:"95%",height:"14px","margin-bottom":"8px"}}),u(o(f),{animated:"",style:{width:"80%",height:"14px"}})],64)):(d(),m("p",A,b(_e.value.about),1))]),_:1})]),_:1}),ce.value||_e.value.programs.length?(d(),i(o(z),{key:0},{default:n(()=>[u(o(L),null,{default:n(()=>[u(o(q),null,{default:n(()=>[x(b(e.$t("partner.programs")),1)]),_:1})]),_:1}),u(o($),null,{default:n(()=>[ce.value?(d(),m(g,{key:0},[u(o(f),{animated:"",style:{width:"90%",height:"14px","margin-bottom":"6px"}}),u(o(f),{animated:"",style:{width:"75%",height:"14px","margin-bottom":"6px"}}),u(o(f),{animated:"",style:{width:"60%",height:"14px"}})],64)):(d(),m("ul",K,[(d(!0),m(g,null,C(_e.value.programs,e=>(d(),m("li",{key:e},b(e),1))),128))]))]),_:1})]),_:1})):w("",!0),"gold"===_e.value.partner_tier&&(me.value||ve.value.length)?(d(),i(o(z),{key:1},{default:n(()=>[u(o(L),null,{default:n(()=>[u(o(q),null,{default:n(()=>a[1]||(a[1]=[x(" Certified Products ",-1)])),_:1,__:[1]})]),_:1}),u(o($),null,{default:n(()=>[me.value?(d(),m(g,{key:0},[u(o(f),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),u(o(f),{animated:"",style:{width:"80%",height:"14px","margin-top":"8px"}})],64)):(d(),m("div",M,[(d(!0),m(g,null,C(ve.value,e=>(d(),i(o(z),{key:e.id,class:"discover-item",button:"",onClick:a=>function openCertifiedProduct(e){r.log("partner_certified_product_click",{partner_id:_e.value.id,partner_name:_e.value.name,partner_tier:_e.value.partner_tier,product_id:e.id,product_barcode:e.barcode,product_name:e.name}),W.push("/item/".concat(e.barcode))}(e)},{default:n(()=>[v("img",{src:e.photo_front_url||"https://placehold.co/200x200",class:"discover-img"},null,8,Q),u(o(j),{class:"discover-label"},{default:n(()=>[v("p",R,b(e.name),1),u(o(P),{color:"success",style:{"font-size":"12px"}},{default:n(()=>[x(b(e.status),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1})):w("",!0),"gold"===_e.value.partner_tier&&(ge.value||fe.value.length)?(d(),i(o(z),{key:2},{default:n(()=>[u(o(L),null,{default:n(()=>[u(o(q),null,{default:n(()=>a[2]||(a[2]=[x(" Certified Locations ",-1)])),_:1,__:[2]})]),_:1}),u(o($),null,{default:n(()=>[ge.value?(d(),m(g,{key:0},[u(o(f),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),u(o(f),{animated:"",style:{width:"80%",height:"14px","margin-top":"8px"}})],64)):(d(),m("div",U,[(d(!0),m(g,null,C(fe.value,e=>(d(),i(o(z),{key:e.id,class:"discover-item",button:"",onClick:a=>function openCertifiedLocation(e){r.log("partner_certified_location_click",{partner_id:_e.value.id,partner_name:_e.value.name,partner_tier:_e.value.partner_tier,location_id:e.id,location_name:e.name}),W.push("/place/".concat(e.id))}(e)},{default:n(()=>[v("img",{src:e.image||"https://placehold.co/200x200",class:"discover-img"},null,8,Y),u(o(j),{class:"discover-label"},{default:n(()=>{var a;return[v("p",ee,b(e.name),1),v("p",ae,b(null==(a=e.location_types)?void 0:a.name),1)]}),_:2},1024)]),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1})):w("",!0),"gold"===_e.value.partner_tier&&(ye.value||he.value.length)?(d(),i(o(z),{key:3},{default:n(()=>[u(o(L),null,{default:n(()=>[u(o(q),null,{default:n(()=>a[3]||(a[3]=[x(" Partner Trips ",-1)])),_:1,__:[3]})]),_:1}),u(o($),null,{default:n(()=>[ye.value?(d(),m(g,{key:0},[u(o(f),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),u(o(f),{animated:"",style:{width:"80%",height:"14px","margin-top":"8px"}})],64)):(d(),m("div",te,[(d(!0),m(g,null,C(he.value,a=>(d(),i(o(z),{key:a.id,class:"discover-item",button:"",onClick:e=>async function openTrip(e){r.log("partner_trip_click",{partner_id:_e.value.id,partner_name:_e.value.name,partner_tier:_e.value.partner_tier,trip_id:e.id,trip_title:e.title}),await s.rpc("increment_trip_view",{p_trip_id:e.id}),await E.open({url:e.external_url,windowName:"_self",toolbarColor:"#e67e22",presentationStyle:"fullscreen"})}(a)},{default:n(()=>[v("img",{src:a.cover_url||"https://placehold.co/200x200",class:"discover-img"},null,8,le),u(o(j),{class:"discover-label"},{default:n(()=>[v("p",re,b("zh-tw"===e.$i18n.locale&&a.title_zh||a.title),1),v("p",ie," ðŸ•’ "+b(a.duration),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1})):w("",!0),u(o(z),null,{default:n(()=>[u(o(L),null,{default:n(()=>[u(o(q),null,{default:n(()=>[x(b(e.$t("partner.contact")),1)]),_:1})]),_:1}),u(o($),null,{default:n(()=>[ce.value?(d(),m(g,{key:0},[u(o(f),{animated:"",style:{width:"80%",height:"14px","margin-bottom":"8px"}}),u(o(f),{animated:"",style:{width:"60%",height:"14px","margin-bottom":"8px"}}),u(o(f),{animated:"",style:{width:"70%",height:"14px"}})],64)):(d(),m(g,{key:1},[_e.value.address?(d(),m("p",ne,"ðŸ“ "+b(_e.value.address),1)):w("",!0),_e.value.phone?(d(),m("p",oe,"ðŸ“ž "+b(_e.value.phone),1)):w("",!0),_e.value.email?(d(),m("p",se,"âœ‰ï¸ "+b(_e.value.email),1)):w("",!0),_e.value.website?(d(),m("a",{key:3,href:"#",onClick:D(openWebsite,["prevent"]),class:"external-link"}," ðŸŒ "+b(_e.value.website),1)):w("",!0)],64))]),_:1})]),_:1})])]),_:1}),u(o(N),{"is-open":pe.value,onDidDismiss:closeLogoPreview},{default:n(()=>[u(o(_),{fullscreen:""},{default:n(()=>[u(o(S),{fill:"solid",color:"carrot",class:"image-modal-close-btn",onClick:closeLogoPreview},{default:n(()=>a[4]||(a[4]=[x(" âœ• ",-1)])),_:1,__:[4]}),u(o(T),{modules:[o(I)],zoom:!0,"slides-per-view":1,class:"fullscreen-swiper"},{default:n(()=>[u(o(B),null,{default:n(()=>[v("div",de,[v("img",{src:_e.value.logo,alt:_e.value.name},null,8,ue)])]),_:1})]),_:1},8,["modules"])]),_:1})]),_:1},8,["is-open"])]),_:1}))}}),[["__scopeId","data-v-540493d4"]]);export{ce as default};
