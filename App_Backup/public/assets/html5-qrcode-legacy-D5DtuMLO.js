System.register([],function(e,t){"use strict";return{execute:function(){function _mergeNamespaces(e,t){for(var r=0;r<t.length;r++){const n=t[r];if("string"!=typeof n&&!Array.isArray(n))for(const t in n)if("default"!==t&&!(t in e)){const r=Object.getOwnPropertyDescriptor(n,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>n[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}e({a:getDefaultExportFromCjs,g:function getAugmentedNamespace(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}});var Html5QrcodeSupportedFormats,t=e("c","undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{});function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}e("H",Html5QrcodeSupportedFormats),function(Html5QrcodeSupportedFormats){Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.QR_CODE=0]="QR_CODE",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.AZTEC=1]="AZTEC",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.CODABAR=2]="CODABAR",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.CODE_39=3]="CODE_39",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.CODE_93=4]="CODE_93",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.CODE_128=5]="CODE_128",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.DATA_MATRIX=6]="DATA_MATRIX",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.MAXICODE=7]="MAXICODE",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.ITF=8]="ITF",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.EAN_13=9]="EAN_13",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.EAN_8=10]="EAN_8",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.PDF_417=11]="PDF_417",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.RSS_14=12]="RSS_14",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.RSS_EXPANDED=13]="RSS_EXPANDED",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.UPC_A=14]="UPC_A",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.UPC_E=15]="UPC_E",Html5QrcodeSupportedFormats[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(Html5QrcodeSupportedFormats||e("H",Html5QrcodeSupportedFormats={}));var r,Html5QrcodeScanType,n=new Map([[Html5QrcodeSupportedFormats.QR_CODE,"QR_CODE"],[Html5QrcodeSupportedFormats.AZTEC,"AZTEC"],[Html5QrcodeSupportedFormats.CODABAR,"CODABAR"],[Html5QrcodeSupportedFormats.CODE_39,"CODE_39"],[Html5QrcodeSupportedFormats.CODE_93,"CODE_93"],[Html5QrcodeSupportedFormats.CODE_128,"CODE_128"],[Html5QrcodeSupportedFormats.DATA_MATRIX,"DATA_MATRIX"],[Html5QrcodeSupportedFormats.MAXICODE,"MAXICODE"],[Html5QrcodeSupportedFormats.ITF,"ITF"],[Html5QrcodeSupportedFormats.EAN_13,"EAN_13"],[Html5QrcodeSupportedFormats.EAN_8,"EAN_8"],[Html5QrcodeSupportedFormats.PDF_417,"PDF_417"],[Html5QrcodeSupportedFormats.RSS_14,"RSS_14"],[Html5QrcodeSupportedFormats.RSS_EXPANDED,"RSS_EXPANDED"],[Html5QrcodeSupportedFormats.UPC_A,"UPC_A"],[Html5QrcodeSupportedFormats.UPC_E,"UPC_E"],[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]);function isValidHtml5QrcodeSupportedFormats(e){return Object.values(Html5QrcodeSupportedFormats).includes(e)}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"}(r||(r={})),function(Html5QrcodeScanType){Html5QrcodeScanType[Html5QrcodeScanType.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",Html5QrcodeScanType[Html5QrcodeScanType.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"}(Html5QrcodeScanType||(Html5QrcodeScanType={}));var o,i=function(){function Html5QrcodeConstants(){}return Html5QrcodeConstants.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",Html5QrcodeConstants.SCAN_DEFAULT_FPS=2,Html5QrcodeConstants.DEFAULT_DISABLE_FLIP=!1,Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE=[Html5QrcodeScanType.SCAN_TYPE_CAMERA,Html5QrcodeScanType.SCAN_TYPE_FILE],Html5QrcodeConstants}(),s=function(){function QrcodeResultFormat(e,t){this.format=e,this.formatName=t}return QrcodeResultFormat.prototype.toString=function(){return this.formatName},QrcodeResultFormat.create=function(e){if(!n.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new QrcodeResultFormat(e,n.get(e))},QrcodeResultFormat}(),c=function(){function Html5QrcodeResultFactory(){}return Html5QrcodeResultFactory.createFromText=function(e){return{decodedText:e,result:{text:e}}},Html5QrcodeResultFactory.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},Html5QrcodeResultFactory}();!function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"}(o||(o={}));var Html5QrcodeErrorFactory=function(){function Html5QrcodeErrorFactory(){}return Html5QrcodeErrorFactory.createFrom=function(e){return{errorMessage:e,type:o.UNKWOWN_ERROR}},Html5QrcodeErrorFactory}(),d=function(){function BaseLoggger(e){this.verbose=e}return BaseLoggger.prototype.log=function(e){this.verbose&&console.log(e)},BaseLoggger.prototype.warn=function(e){this.verbose&&console.warn(e)},BaseLoggger.prototype.logError=function(e,t){(this.verbose||!0===t)&&console.error(e)},BaseLoggger.prototype.logErrors=function(e){if(0===e.length)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},BaseLoggger}();function isNullOrUndefined(e){return null==e}var l=function(){function Html5QrcodeStrings(){}return Html5QrcodeStrings.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},Html5QrcodeStrings.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},Html5QrcodeStrings.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},Html5QrcodeStrings.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},Html5QrcodeStrings.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},Html5QrcodeStrings.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},Html5QrcodeStrings.scannerPaused=function(){return"Scanner paused"},Html5QrcodeStrings}(),u=function(){function VideoConstraintsUtil(){}return VideoConstraintsUtil.isMediaStreamConstraintsValid=function(e,t){if("object"!=typeof e){var r=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var n=new Set(["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"]),o=0,i=Object.keys(e);o<i.length;o++){var s=i[o];if(n.has(s))return t.logError("".concat(s," is not supported videoConstaints."),!0),!1}return!0},VideoConstraintsUtil}(),h={exports:{}};!function(e){function isNullOrUndefined(e){return null==e}var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function __extends(e,t){function __(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}function fixProto(e,t){var r=Object.setPrototypeOf;r?r(e,t):e.__proto__=t}function fixStack(e,t){void 0===t&&(t=e.constructor);var r=Error.captureStackTrace;r&&r(e,t)}var DecodeHintType,n=function(e){function CustomError(t){var r=this.constructor,n=e.call(this,t)||this;return Object.defineProperty(n,"name",{value:r.name,enumerable:!1}),fixProto(n,r.prototype),fixStack(n),n}return __extends(CustomError,e),CustomError}(Error);class Exception extends n{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}Exception.kind="Exception";class ArgumentException extends Exception{}ArgumentException.kind="ArgumentException";class IllegalArgumentException extends Exception{}IllegalArgumentException.kind="IllegalArgumentException";class BinaryBitmap{constructor(e){if(this.binarizer=e,null===e)throw new IllegalArgumentException("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,r,n){const o=this.binarizer.getLuminanceSource().crop(e,t,r,n);return new BinaryBitmap(this.binarizer.createBinarizer(o))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new BinaryBitmap(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new BinaryBitmap(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch(e){return""}}}class ChecksumException extends Exception{static getChecksumInstance(){return new ChecksumException}}ChecksumException.kind="ChecksumException";class Binarizer{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class System{static arraycopy(e,t,r,n,o){for(;o--;)r[n++]=e[t++]}static currentTimeMillis(){return Date.now()}}class IndexOutOfBoundsException extends Exception{}IndexOutOfBoundsException.kind="IndexOutOfBoundsException";class ArrayIndexOutOfBoundsException extends IndexOutOfBoundsException{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}ArrayIndexOutOfBoundsException.kind="ArrayIndexOutOfBoundsException";class Arrays{static fill(e,t){for(let r=0,n=e.length;r<n;r++)e[r]=t}static fillWithin(e,t,r,n){Arrays.rangeCheck(e.length,t,r);for(let o=t;o<r;o++)e[o]=n}static rangeCheck(e,t,r){if(t>r)throw new IllegalArgumentException("fromIndex("+t+") > toIndex("+r+")");if(t<0)throw new ArrayIndexOutOfBoundsException(t);if(r>e)throw new ArrayIndexOutOfBoundsException(r)}static asList(...e){return e}static create(e,t,r){return Array.from({length:e}).map(e=>Array.from({length:t}).fill(r))}static createInt32Array(e,t,r){return Array.from({length:e}).map(e=>Int32Array.from({length:t}).fill(r))}static equals(e,t){if(!e)return!1;if(!t)return!1;if(!e.length)return!1;if(!t.length)return!1;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}static hashCode(e){if(null===e)return 0;let t=1;for(const r of e)t=31*t+r;return t}static fillUint8Array(e,t){for(let r=0;r!==e.length;r++)e[r]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const r=new Uint8Array(t);return r.set(e),r}return e.slice(0,t)}static copyOfRange(e,t,r){const n=r-t,o=new Int32Array(n);return System.arraycopy(e,t,o,0,n),o}static binarySearch(e,t,r){void 0===r&&(r=Arrays.numberComparator);let n=0,o=e.length-1;for(;n<=o;){const i=o+n>>1,s=r(t,e[i]);if(s>0)n=i+1;else{if(!(s<0))return i;o=i-1}}return-n-1}static numberComparator(e,t){return e-t}}class Integer{static numberOfTrailingZeros(e){let t;if(0===e)return 32;let r=31;return t=e<<16,0!==t&&(r-=16,e=t),t=e<<8,0!==t&&(r-=8,e=t),t=e<<4,0!==t&&(r-=4,e=t),t=e<<2,0!==t&&(r-=2,e=t),r-(e<<1>>>31)}static numberOfLeadingZeros(e){if(0===e)return 32;let t=1;return e>>>16==0&&(t+=16,e<<=16),e>>>24==0&&(t+=8,e<<=8),e>>>28==0&&(t+=4,e<<=4),e>>>30==0&&(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135,e+=e>>>8,63&(e+=e>>>16)}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}Integer.MIN_VALUE_32_BITS=-2147483648,Integer.MAX_VALUE=Number.MAX_SAFE_INTEGER;class BitArray{constructor(e,t){void 0===e?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=null==t?BitArray.makeArray(e):t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>32*this.bits.length){const t=BitArray.makeArray(e);System.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return!!(this.bits[Math.floor(e/32)]&1<<(31&e))}set(e){this.bits[Math.floor(e/32)]|=1<<(31&e)}flip(e){this.bits[Math.floor(e/32)]^=1<<(31&e)}getNextSet(e){const t=this.size;if(e>=t)return t;const r=this.bits;let n=Math.floor(e/32),o=r[n];o&=~((1<<(31&e))-1);const i=r.length;for(;0===o;){if(++n===i)return t;o=r[n]}const s=32*n+Integer.numberOfTrailingZeros(o);return s>t?t:s}getNextUnset(e){const t=this.size;if(e>=t)return t;const r=this.bits;let n=Math.floor(e/32),o=~r[n];o&=~((1<<(31&e))-1);const i=r.length;for(;0===o;){if(++n===i)return t;o=~r[n]}const s=32*n+Integer.numberOfTrailingZeros(o);return s>t?t:s}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(start,e){if(e<start||start<0||e>this.size)throw new IllegalArgumentException;if(e===start)return;e--;const t=Math.floor(start/32),r=Math.floor(e/32),n=this.bits;for(let o=t;o<=r;o++){const i=(2<<(o<r?31:31&e))-(1<<(o>t?0:31&start));n[o]|=i}}clear(){const e=this.bits.length,t=this.bits;for(let r=0;r<e;r++)t[r]=0}isRange(start,e,t){if(e<start||start<0||e>this.size)throw new IllegalArgumentException;if(e===start)return!0;e--;const r=Math.floor(start/32),n=Math.floor(e/32),o=this.bits;for(let i=r;i<=n;i++){const s=(2<<(i<n?31:31&e))-(1<<(i>r?0:31&start))&4294967295;if((o[i]&s)!==(t?s:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(e,t){if(t<0||t>32)throw new IllegalArgumentException("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let r=t;r>0;r--)this.appendBit(1==(e>>r-1&1))}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let r=0;r<t;r++)this.appendBit(e.get(r))}xor(e){if(this.size!==e.size)throw new IllegalArgumentException("Sizes don't match");const t=this.bits;for(let r=0,n=t.length;r<n;r++)t[r]^=e.bits[r]}toBytes(e,t,r,n){for(let o=0;o<n;o++){let n=0;for(let t=0;t<8;t++)this.get(e)&&(n|=1<<7-t),e++;t[r+o]=n}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),r=t+1,n=this.bits;for(let o=0;o<r;o++){let r=n[o];r=r>>1&1431655765|(1431655765&r)<<1,r=r>>2&858993459|(858993459&r)<<2,r=r>>4&252645135|(252645135&r)<<4,r=r>>8&16711935|(16711935&r)<<8,r=r>>16&65535|(65535&r)<<16,e[t-o]=r}if(this.size!==32*r){const t=32*r-this.size;let n=e[0]>>>t;for(let o=1;o<r;o++){const r=e[o];n|=r<<32-t,e[o-1]=n,n=r>>>t}e[r-1]=n}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof BitArray))return!1;const t=e;return this.size===t.size&&Arrays.equals(this.bits,t.bits)}hashCode(){return 31*this.size+Arrays.hashCode(this.bits)}toString(){let e="";for(let t=0,r=this.size;t<r;t++)7&t||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new BitArray(this.size,this.bits.slice())}}!function(DecodeHintType){DecodeHintType[DecodeHintType.OTHER=0]="OTHER",DecodeHintType[DecodeHintType.PURE_BARCODE=1]="PURE_BARCODE",DecodeHintType[DecodeHintType.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",DecodeHintType[DecodeHintType.TRY_HARDER=3]="TRY_HARDER",DecodeHintType[DecodeHintType.CHARACTER_SET=4]="CHARACTER_SET",DecodeHintType[DecodeHintType.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",DecodeHintType[DecodeHintType.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",DecodeHintType[DecodeHintType.ASSUME_GS1=7]="ASSUME_GS1",DecodeHintType[DecodeHintType.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",DecodeHintType[DecodeHintType.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",DecodeHintType[DecodeHintType.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"}(DecodeHintType||(DecodeHintType={}));var o,i=DecodeHintType;class FormatException extends Exception{static getFormatInstance(){return new FormatException}}FormatException.kind="FormatException",function(e){e[e.Cp437=0]="Cp437",e[e.ISO8859_1=1]="ISO8859_1",e[e.ISO8859_2=2]="ISO8859_2",e[e.ISO8859_3=3]="ISO8859_3",e[e.ISO8859_4=4]="ISO8859_4",e[e.ISO8859_5=5]="ISO8859_5",e[e.ISO8859_6=6]="ISO8859_6",e[e.ISO8859_7=7]="ISO8859_7",e[e.ISO8859_8=8]="ISO8859_8",e[e.ISO8859_9=9]="ISO8859_9",e[e.ISO8859_10=10]="ISO8859_10",e[e.ISO8859_11=11]="ISO8859_11",e[e.ISO8859_13=12]="ISO8859_13",e[e.ISO8859_14=13]="ISO8859_14",e[e.ISO8859_15=14]="ISO8859_15",e[e.ISO8859_16=15]="ISO8859_16",e[e.SJIS=16]="SJIS",e[e.Cp1250=17]="Cp1250",e[e.Cp1251=18]="Cp1251",e[e.Cp1252=19]="Cp1252",e[e.Cp1256=20]="Cp1256",e[e.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",e[e.UTF8=22]="UTF8",e[e.ASCII=23]="ASCII",e[e.Big5=24]="Big5",e[e.GB18030=25]="GB18030",e[e.EUC_KR=26]="EUC_KR"}(o||(o={}));class CharacterSetECI{constructor(e,t,r,...n){this.valueIdentifier=e,this.name=r,this.values="number"==typeof t?Int32Array.from([t]):t,this.otherEncodingNames=n,CharacterSetECI.VALUE_IDENTIFIER_TO_ECI.set(e,this),CharacterSetECI.NAME_TO_ECI.set(r,this);const o=this.values;for(let i=0,s=o.length;i!==s;i++){const e=o[i];CharacterSetECI.VALUES_TO_ECI.set(e,this)}for(const i of n)CharacterSetECI.NAME_TO_ECI.set(i,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new FormatException("incorect value");const t=CharacterSetECI.VALUES_TO_ECI.get(e);if(void 0===t)throw new FormatException("incorect value");return t}static getCharacterSetECIByName(e){const t=CharacterSetECI.NAME_TO_ECI.get(e);if(void 0===t)throw new FormatException("incorect value");return t}equals(e){if(!(e instanceof CharacterSetECI))return!1;const t=e;return this.getName()===t.getName()}}CharacterSetECI.VALUE_IDENTIFIER_TO_ECI=new Map,CharacterSetECI.VALUES_TO_ECI=new Map,CharacterSetECI.NAME_TO_ECI=new Map,CharacterSetECI.Cp437=new CharacterSetECI(o.Cp437,Int32Array.from([0,2]),"Cp437"),CharacterSetECI.ISO8859_1=new CharacterSetECI(o.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),CharacterSetECI.ISO8859_2=new CharacterSetECI(o.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),CharacterSetECI.ISO8859_3=new CharacterSetECI(o.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),CharacterSetECI.ISO8859_4=new CharacterSetECI(o.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),CharacterSetECI.ISO8859_5=new CharacterSetECI(o.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),CharacterSetECI.ISO8859_6=new CharacterSetECI(o.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),CharacterSetECI.ISO8859_7=new CharacterSetECI(o.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),CharacterSetECI.ISO8859_8=new CharacterSetECI(o.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),CharacterSetECI.ISO8859_9=new CharacterSetECI(o.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),CharacterSetECI.ISO8859_10=new CharacterSetECI(o.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),CharacterSetECI.ISO8859_11=new CharacterSetECI(o.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),CharacterSetECI.ISO8859_13=new CharacterSetECI(o.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),CharacterSetECI.ISO8859_14=new CharacterSetECI(o.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),CharacterSetECI.ISO8859_15=new CharacterSetECI(o.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),CharacterSetECI.ISO8859_16=new CharacterSetECI(o.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),CharacterSetECI.SJIS=new CharacterSetECI(o.SJIS,20,"SJIS","Shift_JIS"),CharacterSetECI.Cp1250=new CharacterSetECI(o.Cp1250,21,"Cp1250","windows-1250"),CharacterSetECI.Cp1251=new CharacterSetECI(o.Cp1251,22,"Cp1251","windows-1251"),CharacterSetECI.Cp1252=new CharacterSetECI(o.Cp1252,23,"Cp1252","windows-1252"),CharacterSetECI.Cp1256=new CharacterSetECI(o.Cp1256,24,"Cp1256","windows-1256"),CharacterSetECI.UnicodeBigUnmarked=new CharacterSetECI(o.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),CharacterSetECI.UTF8=new CharacterSetECI(o.UTF8,26,"UTF8","UTF-8"),CharacterSetECI.ASCII=new CharacterSetECI(o.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),CharacterSetECI.Big5=new CharacterSetECI(o.Big5,28,"Big5"),CharacterSetECI.GB18030=new CharacterSetECI(o.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),CharacterSetECI.EUC_KR=new CharacterSetECI(o.EUC_KR,30,"EUC_KR","EUC-KR");class UnsupportedOperationException extends Exception{}UnsupportedOperationException.kind="UnsupportedOperationException";class StringEncoding{static decode(e,t){const r=this.encodingName(t);return this.customDecoder?this.customDecoder(e,r):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(r)?this.decodeFallback(e,r):new TextDecoder(r).decode(e)}static shouldDecodeOnFallback(e){return!StringEncoding.isBrowser()&&"ISO-8859-1"===e}static encode(e,t){const r=this.encodingName(t);return this.customEncoder?this.customEncoder(e,r):"undefined"==typeof TextEncoder?this.encodeFallback(e):(new TextEncoder).encode(e)}static isBrowser(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(e){return"string"==typeof e?e:e.getName()}static encodingCharacterSet(e){return e instanceof CharacterSetECI?e:CharacterSetECI.getCharacterSetECIByName(e)}static decodeFallback(e,t){const r=this.encodingCharacterSet(t);if(StringEncoding.isDecodeFallbackSupported(r)){let t="";for(let r=0,n=e.length;r<n;r++){let n=e[r].toString(16);n.length<2&&(n="0"+n),t+="%"+n}return decodeURIComponent(t)}if(r.equals(CharacterSetECI.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new UnsupportedOperationException(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(CharacterSetECI.UTF8)||e.equals(CharacterSetECI.ISO8859_1)||e.equals(CharacterSetECI.ASCII)}static encodeFallback(e){const t=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let n=0;n<t.length;n++)r.push(t[n].charCodeAt(0));return new Uint8Array(r)}}class StringUtils{static castAsNonUtf8Char(e,t=null){const r=t?t.getName():this.ISO88591;return StringEncoding.decode(new Uint8Array([e]),r)}static guessEncoding(e,t){if(null!=t&&void 0!==t.get(i.CHARACTER_SET))return t.get(i.CHARACTER_SET).toString();const r=e.length;let n=!0,o=!0,s=!0,c=0,d=0,l=0,u=0,h=0,g=0,E=0,f=0,C=0,m=0,p=0;const A=e.length>3&&239===e[0]&&187===e[1]&&191===e[2];for(let i=0;i<r&&(n||o||s);i++){const t=255&e[i];s&&(c>0?128&t?c--:s=!1:128&t&&(64&t?(c++,32&t?(c++,16&t?(c++,8&t?s=!1:u++):l++):d++):s=!1)),n&&(t>127&&t<160?n=!1:t>159&&(t<192||215===t||247===t)&&p++),o&&(h>0?t<64||127===t||t>252?o=!1:h--:128===t||160===t||t>239?o=!1:t>160&&t<224?(g++,f=0,E++,E>C&&(C=E)):t>127?(h++,E=0,f++,f>m&&(m=f)):(E=0,f=0))}return s&&c>0&&(s=!1),o&&h>0&&(o=!1),s&&(A||d+l+u>0)?StringUtils.UTF8:o&&(StringUtils.ASSUME_SHIFT_JIS||C>=3||m>=3)?StringUtils.SHIFT_JIS:n&&o?2===C&&2===g||10*p>=r?StringUtils.SHIFT_JIS:StringUtils.ISO88591:n?StringUtils.ISO88591:o?StringUtils.SHIFT_JIS:s?StringUtils.UTF8:StringUtils.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let r=-1;function callback(e,n,o,i,s,c){if("%%"===e)return"%";if(void 0===t[++r])return;e=i?parseInt(i.substr(1)):void 0;let d,l=s?parseInt(s.substr(1)):void 0;switch(c){case"s":d=t[r];break;case"c":d=t[r][0];break;case"f":d=parseFloat(t[r]).toFixed(e);break;case"p":d=parseFloat(t[r]).toPrecision(e);break;case"e":d=parseFloat(t[r]).toExponential(e);break;case"x":d=parseInt(t[r]).toString(l||16);break;case"d":d=parseFloat(parseInt(t[r],l||10).toPrecision(e)).toFixed(0)}d="object"==typeof d?JSON.stringify(d):(+d).toString(l);let u=parseInt(o),h=o&&o[0]+""=="0"?"0":" ";for(;d.length<u;)d=void 0!==n?d+h:h+d;return d}let n=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(n,callback)}static getBytes(e,t){return StringEncoding.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}StringUtils.SHIFT_JIS=CharacterSetECI.SJIS.getName(),StringUtils.GB2312="GB2312",StringUtils.ISO88591=CharacterSetECI.ISO8859_1.getName(),StringUtils.EUC_JP="EUC_JP",StringUtils.UTF8=CharacterSetECI.UTF8.getName(),StringUtils.PLATFORM_DEFAULT_ENCODING=StringUtils.UTF8,StringUtils.ASSUME_SHIFT_JIS=!1;class StringBuilder{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return"string"==typeof e?this.value+=e.toString():this.encoding?this.value+=StringUtils.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,r){for(let n=t;t<t+r;n++)this.append(e[n]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(start,e){return this.value.substring(start,e)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class BitMatrix{constructor(e,t,r,n){if(this.width=e,this.height=t,this.rowSize=r,this.bits=n,null==t&&(t=e),this.height=t,e<1||t<1)throw new IllegalArgumentException("Both dimensions must be greater than 0");null==r&&(r=Math.floor((e+31)/32)),this.rowSize=r,null==n&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,r=e[0].length,n=new BitMatrix(r,t);for(let o=0;o<t;o++){const t=e[o];for(let e=0;e<r;e++)t[e]&&n.set(e,o)}return n}static parseFromString(e,t,r){if(null===e)throw new IllegalArgumentException("stringRepresentation cannot be null");const n=new Array(e.length);let o=0,i=0,s=-1,c=0,d=0;for(;d<e.length;)if("\n"===e.charAt(d)||"\r"===e.charAt(d)){if(o>i){if(-1===s)s=o-i;else if(o-i!==s)throw new IllegalArgumentException("row lengths do not match");i=o,c++}d++}else if(e.substring(d,d+t.length)===t)d+=t.length,n[o]=!0,o++;else{if(e.substring(d,d+r.length)!==r)throw new IllegalArgumentException("illegal character encountered: "+e.substring(d));d+=r.length,n[o]=!1,o++}if(o>i){if(-1===s)s=o-i;else if(o-i!==s)throw new IllegalArgumentException("row lengths do not match");c++}const l=new BitMatrix(s,c);for(let u=0;u<o;u++)n[u]&&l.set(Math.floor(u%s),Math.floor(u/s));return l}get(e,t){const r=t*this.rowSize+Math.floor(e/32);return!!(this.bits[r]>>>(31&e)&1)}set(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]|=1<<(31&e)&4294967295}unset(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]&=~(1<<(31&e)&4294967295)}flip(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]^=1<<(31&e)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new IllegalArgumentException("input matrix dimensions do not match");const t=new BitArray(Math.floor(this.width/32)+1),r=this.rowSize,n=this.bits;for(let o=0,i=this.height;o<i;o++){const i=o*r,s=e.getRow(o,t).getBitArray();for(let e=0;e<r;e++)n[i+e]^=s[e]}}clear(){const e=this.bits,t=e.length;for(let r=0;r<t;r++)e[r]=0}setRegion(e,t,r,n){if(t<0||e<0)throw new IllegalArgumentException("Left and top must be nonnegative");if(n<1||r<1)throw new IllegalArgumentException("Height and width must be at least 1");const o=e+r,i=t+n;if(i>this.height||o>this.width)throw new IllegalArgumentException("The region must fit inside the matrix");const s=this.rowSize,c=this.bits;for(let d=t;d<i;d++){const t=d*s;for(let r=e;r<o;r++)c[t+Math.floor(r/32)]|=1<<(31&r)&4294967295}}getRow(e,t){null==t||t.getSize()<this.width?t=new BitArray(this.width):t.clear();const r=this.rowSize,n=this.bits,o=e*r;for(let i=0;i<r;i++)t.setBulk(32*i,n[o+i]);return t}setRow(e,t){System.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let r=new BitArray(e),n=new BitArray(e);for(let o=0,i=Math.floor((t+1)/2);o<i;o++)r=this.getRow(o,r),n=this.getRow(t-1-o,n),r.reverse(),n.reverse(),this.setRow(o,n),this.setRow(t-1-o,r)}getEnclosingRectangle(){const e=this.width,t=this.height,r=this.rowSize,n=this.bits;let o=e,i=t,s=-1,c=-1;for(let d=0;d<t;d++)for(let e=0;e<r;e++){const t=n[d*r+e];if(0!==t){if(d<i&&(i=d),d>c&&(c=d),32*e<o){let r=0;for(;!(t<<31-r&4294967295);)r++;32*e+r<o&&(o=32*e+r)}if(32*e+31>s){let r=31;for(;t>>>r===0;)r--;32*e+r>s&&(s=32*e+r)}}}return s<o||c<i?null:Int32Array.from([o,i,s-o+1,c-i+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let r=0;for(;r<t.length&&0===t[r];)r++;if(r===t.length)return null;const n=r/e;let o=r%e*32;const i=t[r];let s=0;for(;!(i<<31-s&4294967295);)s++;return o+=s,Int32Array.from([o,n])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let r=t.length-1;for(;r>=0&&0===t[r];)r--;if(r<0)return null;const n=Math.floor(r/e);let o=32*Math.floor(r%e);const i=t[r];let s=31;for(;i>>>s===0;)s--;return o+=s,Int32Array.from([o,n])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof BitMatrix))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&Arrays.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Arrays.hashCode(this.bits),e}toString(e="X ",t="  ",r="\n"){return this.buildToString(e,t,r)}buildToString(e,t,r){let n=new StringBuilder;for(let o=0,i=this.height;o<i;o++){for(let r=0,i=this.width;r<i;r++)n.append(this.get(r,o)?e:t);n.append(r)}return n.toString()}clone(){return new BitMatrix(this.width,this.height,this.rowSize,this.bits.slice())}}class NotFoundException extends Exception{static getNotFoundInstance(){return new NotFoundException}}NotFoundException.kind="NotFoundException";class GlobalHistogramBinarizer extends Binarizer{constructor(e){super(e),this.luminances=GlobalHistogramBinarizer.EMPTY,this.buckets=new Int32Array(GlobalHistogramBinarizer.LUMINANCE_BUCKETS)}getBlackRow(e,t){const r=this.getLuminanceSource(),n=r.getWidth();null==t||t.getSize()<n?t=new BitArray(n):t.clear(),this.initArrays(n);const o=r.getRow(e,this.luminances),i=this.buckets;for(let c=0;c<n;c++)i[(255&o[c])>>GlobalHistogramBinarizer.LUMINANCE_SHIFT]++;const s=GlobalHistogramBinarizer.estimateBlackPoint(i);if(n<3)for(let c=0;c<n;c++)(255&o[c])<s&&t.set(c);else{let e=255&o[0],r=255&o[1];for(let i=1;i<n-1;i++){const n=255&o[i+1];(4*r-e-n)/2<s&&t.set(i),e=r,r=n}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight(),n=new BitMatrix(t,r);this.initArrays(t);const o=this.buckets;for(let c=1;c<5;c++){const n=Math.floor(r*c/5),i=e.getRow(n,this.luminances),s=Math.floor(4*t/5);for(let e=Math.floor(t/5);e<s;e++)o[(255&i[e])>>GlobalHistogramBinarizer.LUMINANCE_SHIFT]++}const i=GlobalHistogramBinarizer.estimateBlackPoint(o),s=e.getMatrix();for(let c=0;c<r;c++){const e=c*t;for(let r=0;r<t;r++)(255&s[e+r])<i&&n.set(r,c)}return n}createBinarizer(e){return new GlobalHistogramBinarizer(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let r=0;r<GlobalHistogramBinarizer.LUMINANCE_BUCKETS;r++)t[r]=0}static estimateBlackPoint(e){const t=e.length;let r=0,n=0,o=0;for(let l=0;l<t;l++)e[l]>o&&(n=l,o=e[l]),e[l]>r&&(r=e[l]);let i=0,s=0;for(let l=0;l<t;l++){const t=l-n,r=e[l]*t*t;r>s&&(i=l,s=r)}if(n>i){const e=n;n=i,i=e}if(i-n<=t/16)throw new NotFoundException;let c=i-1,d=-1;for(let l=i-1;l>n;l--){const t=l-n,o=t*t*(i-l)*(r-e[l]);o>d&&(c=l,d=o)}return c<<GlobalHistogramBinarizer.LUMINANCE_SHIFT}}GlobalHistogramBinarizer.LUMINANCE_BITS=5,GlobalHistogramBinarizer.LUMINANCE_SHIFT=8-GlobalHistogramBinarizer.LUMINANCE_BITS,GlobalHistogramBinarizer.LUMINANCE_BUCKETS=1<<GlobalHistogramBinarizer.LUMINANCE_BITS,GlobalHistogramBinarizer.EMPTY=Uint8ClampedArray.from([0]);class HybridBinarizer extends GlobalHistogramBinarizer{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight();if(t>=HybridBinarizer.MINIMUM_DIMENSION&&r>=HybridBinarizer.MINIMUM_DIMENSION){const n=e.getMatrix();let o=t>>HybridBinarizer.BLOCK_SIZE_POWER;0!==(t&HybridBinarizer.BLOCK_SIZE_MASK)&&o++;let i=r>>HybridBinarizer.BLOCK_SIZE_POWER;0!==(r&HybridBinarizer.BLOCK_SIZE_MASK)&&i++;const s=HybridBinarizer.calculateBlackPoints(n,o,i,t,r),c=new BitMatrix(t,r);HybridBinarizer.calculateThresholdForBlock(n,o,i,t,r,s,c),this.matrix=c}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new HybridBinarizer(e)}static calculateThresholdForBlock(e,t,r,n,o,i,s){const c=o-HybridBinarizer.BLOCK_SIZE,d=n-HybridBinarizer.BLOCK_SIZE;for(let l=0;l<r;l++){let o=l<<HybridBinarizer.BLOCK_SIZE_POWER;o>c&&(o=c);const u=HybridBinarizer.cap(l,2,r-3);for(let r=0;r<t;r++){let c=r<<HybridBinarizer.BLOCK_SIZE_POWER;c>d&&(c=d);const l=HybridBinarizer.cap(r,2,t-3);let h=0;for(let e=-2;e<=2;e++){const t=i[u+e];h+=t[l-2]+t[l-1]+t[l]+t[l+1]+t[l+2]}const g=h/25;HybridBinarizer.thresholdBlock(e,c,o,g,n,s)}}}static cap(e,t,r){return e<t?t:e>r?r:e}static thresholdBlock(e,t,r,n,o,i){for(let s=0,c=r*o+t;s<HybridBinarizer.BLOCK_SIZE;s++,c+=o)for(let o=0;o<HybridBinarizer.BLOCK_SIZE;o++)(255&e[c+o])<=n&&i.set(t+o,r+s)}static calculateBlackPoints(e,t,r,n,o){const i=o-HybridBinarizer.BLOCK_SIZE,s=n-HybridBinarizer.BLOCK_SIZE,c=new Array(r);for(let d=0;d<r;d++){c[d]=new Int32Array(t);let r=d<<HybridBinarizer.BLOCK_SIZE_POWER;r>i&&(r=i);for(let o=0;o<t;o++){let t=o<<HybridBinarizer.BLOCK_SIZE_POWER;t>s&&(t=s);let i=0,l=255,u=0;for(let o=0,s=r*n+t;o<HybridBinarizer.BLOCK_SIZE;o++,s+=n){for(let t=0;t<HybridBinarizer.BLOCK_SIZE;t++){const r=255&e[s+t];i+=r,r<l&&(l=r),r>u&&(u=r)}if(u-l>HybridBinarizer.MIN_DYNAMIC_RANGE)for(o++,s+=n;o<HybridBinarizer.BLOCK_SIZE;o++,s+=n)for(let t=0;t<HybridBinarizer.BLOCK_SIZE;t++)i+=255&e[s+t]}let h=i>>2*HybridBinarizer.BLOCK_SIZE_POWER;if(u-l<=HybridBinarizer.MIN_DYNAMIC_RANGE&&(h=l/2,d>0&&o>0)){const e=(c[d-1][o]+2*c[d][o-1]+c[d-1][o-1])/4;l<e&&(h=e)}c[d][o]=h}}return c}}HybridBinarizer.BLOCK_SIZE_POWER=3,HybridBinarizer.BLOCK_SIZE=1<<HybridBinarizer.BLOCK_SIZE_POWER,HybridBinarizer.BLOCK_SIZE_MASK=HybridBinarizer.BLOCK_SIZE-1,HybridBinarizer.MINIMUM_DIMENSION=5*HybridBinarizer.BLOCK_SIZE,HybridBinarizer.MIN_DYNAMIC_RANGE=24;class LuminanceSource{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,r,n){throw new UnsupportedOperationException("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new UnsupportedOperationException("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new UnsupportedOperationException("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new StringBuilder;for(let r=0;r<this.height;r++){const n=this.getRow(r,e);for(let e=0;e<this.width;e++){const r=255&n[e];let o;o=r<64?"#":r<128?"+":r<192?".":" ",t.append(o)}t.append("\n")}return t.toString()}}class InvertedLuminanceSource extends LuminanceSource{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const r=this.delegate.getRow(e,t),n=this.getWidth();for(let o=0;o<n;o++)r[o]=255-(255&r[o]);return r}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(t);for(let n=0;n<t;n++)r[n]=255-(255&e[n]);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,r,n){return new InvertedLuminanceSource(this.delegate.crop(e,t,r,n))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new InvertedLuminanceSource(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new InvertedLuminanceSource(this.delegate.rotateCounterClockwise45())}}class HTMLCanvasElementLuminanceSource extends LuminanceSource{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return HTMLCanvasElementLuminanceSource.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,r){const n=new Uint8ClampedArray(t*r);for(let o=0,i=0,s=e.length;o<s;o+=4,i++){let t;t=0===e[o+3]?255:306*e[o]+601*e[o+1]+117*e[o+2]+512>>10,n[i]=t}return n}getRow(e,t){if(e<0||e>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+e);const r=this.getWidth(),start=e*r;return null===t?t=this.buffer.slice(start,start+r):(t.length<r&&(t=new Uint8ClampedArray(r)),t.set(this.buffer.slice(start,start+r))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,r,n){return super.crop(e,t,r,n),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),r=t.getContext("2d"),n=e*HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS,o=this.canvas.width,i=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(n))*o+Math.abs(Math.sin(n))*i),c=Math.ceil(Math.abs(Math.sin(n))*o+Math.abs(Math.cos(n))*i);return t.width=s,t.height=c,r.translate(s/2,c/2),r.rotate(n),r.drawImage(this.canvas,o/-2,i/-2),this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(t),this}invert(){return new InvertedLuminanceSource(this)}}HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS=Math.PI/180;class VideoInputDevice{constructor(e,t,r){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var BarcodeFormat,s=(globalThis||t||self||window?(globalThis||t||self||window||void 0).__awaiter:void 0)||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,o){function fulfilled(e){try{step(n.next(e))}catch(t){o(t)}}function rejected(e){try{step(n.throw(e))}catch(t){o(t)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};class BrowserCodeReader{constructor(e,t=500,r){this.reader=e,this.timeBetweenScansMillis=t,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!=typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return s(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const r of e){const e="video"===r.kind?"videoinput":r.kind;if("videoinput"!==e)continue;const n={deviceId:r.deviceId||r.id,label:r.label||`Video device ${t.length+1}`,kind:e,groupId:r.groupId};t.push(n)}return t})}getVideoInputDevices(){return s(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(e=>new VideoInputDevice(e.deviceId,e.label))})}findDeviceById(e){return s(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(t=>t.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return s(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return s(this,void 0,void 0,function*(){let r;this.reset(),r=e?{deviceId:{exact:e}}:{facingMode:"environment"};const n={video:r};return yield this.decodeOnceFromConstraints(n,t)})}decodeOnceFromConstraints(e,t){return s(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(r,t)})}decodeOnceFromStream(e,t){return s(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(r)})}decodeFromInputVideoDeviceContinuously(e,t,r){return s(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,r)})}decodeFromVideoDevice(e,t,r){return s(this,void 0,void 0,function*(){let n;n=e?{deviceId:{exact:e}}:{facingMode:"environment"};const o={video:n};return yield this.decodeFromConstraints(o,t,r)})}decodeFromConstraints(e,t,r){return s(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(n,t,r)})}decodeFromStream(e,t,r){return s(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(n,r)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return s(this,void 0,void 0,function*(){const r=this.prepareVideoElement(t);return this.addVideoSource(r,e),this.videoElement=r,this.stream=e,yield this.playVideoOnLoadAsync(r),r})}playVideoOnLoadAsync(e){return new Promise((t,r)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return s(this,void 0,void 0,function*(){if(this.isVideoPlaying(e))console.warn("Trying to play video that is already playing.");else try{yield e.play()}catch(t){console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const r=document.getElementById(e);if(!r)throw new ArgumentException(`element with id '${e}' not found`);if(r.nodeName.toLowerCase()!==t.toLowerCase())throw new ArgumentException(`element with id '${e}' must be an ${t} element`);return r}decodeFromImage(e,t){if(!e&&!t)throw new ArgumentException("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new ArgumentException("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,r){if(void 0===e&&void 0===t)throw new ArgumentException("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,r):this.decodeFromVideoElementContinuously(e,r)}decodeFromImageElement(e){if(!e)throw new ArgumentException("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);let r;return this.imageElement=t,r=this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t),r}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(r,t)}_decodeFromVideoElementSetup(e){if(!e)throw new ArgumentException("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new ArgumentException("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const r=this._decodeOnLoadImage(t);return t.src=e,r}decodeFromVideoUrl(e){if(!e)throw new ArgumentException("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),r=this.decodeFromVideoElement(t);return t.src=e,r}decodeFromVideoUrlContinuously(e,t){if(!e)throw new ArgumentException("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),n=this.decodeFromVideoElementContinuously(r,t);return r.src=e,n}_decodeOnLoadImage(e){return new Promise((t,r)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,r),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return s(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return s(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!!e.complete&&0!==e.naturalWidth}prepareImageElement(e){let t;return void 0===e&&(t=document.createElement("img"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return e||"undefined"==typeof document||(t=document.createElement("video"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,r=!0){this._stopAsyncDecode=!1;const loop=(n,o)=>{if(this._stopAsyncDecode)return o(new NotFoundException("Video stream has ended before any code could be detected.")),void(this._stopAsyncDecode=void 0);try{n(this.decode(e))}catch(i){if(t&&i instanceof NotFoundException||(i instanceof ChecksumException||i instanceof FormatException)&&r)return setTimeout(loop,this._timeBetweenDecodingAttempts,n,o);o(i)}};return new Promise((e,t)=>loop(e,t))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const loop=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{const r=this.decode(e);t(r,null),setTimeout(loop,this.timeBetweenScansMillis)}catch(r){t(null,r),(r instanceof ChecksumException||r instanceof FormatException||r instanceof NotFoundException)&&setTimeout(loop,this._timeBetweenDecodingAttempts)}};loop()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return 0!==e.videoWidth}drawFrameOnCanvas(e,t,r){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),r||(r=this.captureCanvasContext),r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,r=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),r||(r=this.captureCanvasContext),r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),r=new HTMLCanvasElementLuminanceSource(t),n=new HybridBinarizer(r);return new BinaryBitmap(n)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const t=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=t}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if("undefined"==typeof document)return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let r,n;return void 0!==e&&(e instanceof HTMLVideoElement?(r=e.videoWidth,n=e.videoHeight):e instanceof HTMLImageElement&&(r=e.naturalWidth||e.width,n=e.naturalHeight||e.height)),t.style.width=r+"px",t.style.height=n+"px",t.width=r,t.height=n,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch(r){e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch(t){e.src=""}this.videoElement.removeAttribute("src")}}class Result{constructor(e,t,r=(null==t?0:8*t.length),n,o,i=System.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=r,this.resultPoints=n,this.format=o,this.timestamp=i,this.text=e,this.rawBytes=t,this.numBits=null==r?null==t?0:8*t.length:r,this.resultPoints=n,this.format=o,this.resultMetadata=null,this.timestamp=null==i?System.currentTimeMillis():i}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){null!==e&&(null===this.resultMetadata?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(null===t)this.resultPoints=e;else if(null!==e&&e.length>0){const r=new Array(t.length+e.length);System.arraycopy(t,0,r,0,t.length),System.arraycopy(e,0,r,t.length,e.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}!function(BarcodeFormat){BarcodeFormat[BarcodeFormat.AZTEC=0]="AZTEC",BarcodeFormat[BarcodeFormat.CODABAR=1]="CODABAR",BarcodeFormat[BarcodeFormat.CODE_39=2]="CODE_39",BarcodeFormat[BarcodeFormat.CODE_93=3]="CODE_93",BarcodeFormat[BarcodeFormat.CODE_128=4]="CODE_128",BarcodeFormat[BarcodeFormat.DATA_MATRIX=5]="DATA_MATRIX",BarcodeFormat[BarcodeFormat.EAN_8=6]="EAN_8",BarcodeFormat[BarcodeFormat.EAN_13=7]="EAN_13",BarcodeFormat[BarcodeFormat.ITF=8]="ITF",BarcodeFormat[BarcodeFormat.MAXICODE=9]="MAXICODE",BarcodeFormat[BarcodeFormat.PDF_417=10]="PDF_417",BarcodeFormat[BarcodeFormat.QR_CODE=11]="QR_CODE",BarcodeFormat[BarcodeFormat.RSS_14=12]="RSS_14",BarcodeFormat[BarcodeFormat.RSS_EXPANDED=13]="RSS_EXPANDED",BarcodeFormat[BarcodeFormat.UPC_A=14]="UPC_A",BarcodeFormat[BarcodeFormat.UPC_E=15]="UPC_E",BarcodeFormat[BarcodeFormat.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(BarcodeFormat||(BarcodeFormat={}));var c,d=BarcodeFormat;!function(e){e[e.OTHER=0]="OTHER",e[e.ORIENTATION=1]="ORIENTATION",e[e.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",e[e.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",e[e.ISSUE_NUMBER=4]="ISSUE_NUMBER",e[e.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",e[e.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",e[e.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",e[e.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",e[e.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",e[e.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"}(c||(c={}));var l,u,h,g,E,f,C=c;class DecoderResult{constructor(e,t,r,n,o=-1,i=-1){this.rawBytes=e,this.text=t,this.byteSegments=r,this.ecLevel=n,this.structuredAppendSequenceNumber=o,this.structuredAppendParity=i,this.numBits=null==e?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class AbstractGenericGF{exp(e){return this.expTable[e]}log(e){if(0===e)throw new IllegalArgumentException;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class GenericGFPoly{constructor(e,t){if(0===t.length)throw new IllegalArgumentException;this.field=e;const r=t.length;if(r>1&&0===t[0]){let e=1;for(;e<r&&0===t[e];)e++;e===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-e),System.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);const t=this.coefficients;let r;if(1===e){r=0;for(let e=0,n=t.length;e!==n;e++){const n=t[e];r=AbstractGenericGF.addOrSubtract(r,n)}return r}r=t[0];const n=t.length,o=this.field;for(let i=1;i<n;i++)r=AbstractGenericGF.addOrSubtract(o.multiply(e,r),t[i]);return r}addOrSubtract(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){const e=t;t=r,r=e}let n=new Int32Array(r.length);const o=r.length-t.length;System.arraycopy(r,0,n,0,o);for(let i=o;i<r.length;i++)n[i]=AbstractGenericGF.addOrSubtract(t[i-o],r[i]);return new GenericGFPoly(this.field,n)}multiply(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,r=t.length,n=e.coefficients,o=n.length,i=new Int32Array(r+o-1),s=this.field;for(let c=0;c<r;c++){const e=t[c];for(let t=0;t<o;t++)i[c+t]=AbstractGenericGF.addOrSubtract(i[c+t],s.multiply(e,n[t]))}return new GenericGFPoly(s,i)}multiplyScalar(e){if(0===e)return this.field.getZero();if(1===e)return this;const t=this.coefficients.length,r=this.field,n=new Int32Array(t),o=this.coefficients;for(let i=0;i<t;i++)n[i]=r.multiply(o[i],e);return new GenericGFPoly(r,n)}multiplyByMonomial(e,t){if(e<0)throw new IllegalArgumentException;if(0===t)return this.field.getZero();const r=this.coefficients,n=r.length,o=new Int32Array(n+e),i=this.field;for(let s=0;s<n;s++)o[s]=i.multiply(r[s],t);return new GenericGFPoly(i,o)}divide(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new IllegalArgumentException("Divide by 0");const t=this.field;let r=t.getZero(),n=this;const o=e.getCoefficient(e.getDegree()),i=t.inverse(o);for(;n.getDegree()>=e.getDegree()&&!n.isZero();){const o=n.getDegree()-e.getDegree(),s=t.multiply(n.getCoefficient(n.getDegree()),i),c=e.multiplyByMonomial(o,s),d=t.buildMonomial(o,s);r=r.addOrSubtract(d),n=n.addOrSubtract(c)}return[r,n]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);if(0!==r){if(r<0?(e+=" - ",r=-r):e.length>0&&(e+=" + "),0===t||1!==r){const t=this.field.log(r);0===t?e+="1":1===t?e+="a":(e+="a^",e+=t)}0!==t&&(1===t?e+="x":(e+="x^",e+=t))}}return e}}class ArithmeticException extends Exception{}ArithmeticException.kind="ArithmeticException";class GenericGF extends AbstractGenericGF{constructor(e,t,r){super(),this.primitive=e,this.size=t,this.generatorBase=r;const n=new Int32Array(t);let o=1;for(let s=0;s<t;s++)n[s]=o,o*=2,o>=t&&(o^=e,o&=t-1);this.expTable=n;const i=new Int32Array(t);for(let s=0;s<t-1;s++)i[n[s]]=s;this.logTable=i,this.zero=new GenericGFPoly(this,Int32Array.from([0])),this.one=new GenericGFPoly(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new IllegalArgumentException;if(0===t)return this.zero;const r=new Int32Array(e+1);return r[0]=t,new GenericGFPoly(this,r)}inverse(e){if(0===e)throw new ArithmeticException;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+Integer.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}GenericGF.AZTEC_DATA_12=new GenericGF(4201,4096,1),GenericGF.AZTEC_DATA_10=new GenericGF(1033,1024,1),GenericGF.AZTEC_DATA_6=new GenericGF(67,64,1),GenericGF.AZTEC_PARAM=new GenericGF(19,16,1),GenericGF.QR_CODE_FIELD_256=new GenericGF(285,256,0),GenericGF.DATA_MATRIX_FIELD_256=new GenericGF(301,256,1),GenericGF.AZTEC_DATA_8=GenericGF.DATA_MATRIX_FIELD_256,GenericGF.MAXICODE_FIELD_64=GenericGF.AZTEC_DATA_6;class ReedSolomonException extends Exception{}ReedSolomonException.kind="ReedSolomonException";class IllegalStateException extends Exception{}IllegalStateException.kind="IllegalStateException";class ReedSolomonDecoder{constructor(e){this.field=e}decode(e,t){const r=this.field,n=new GenericGFPoly(r,e),o=new Int32Array(t);let i=!0;for(let g=0;g<t;g++){const e=n.evaluateAt(r.exp(g+r.getGeneratorBase()));o[o.length-1-g]=e,0!==e&&(i=!1)}if(i)return;const s=new GenericGFPoly(r,o),c=this.runEuclideanAlgorithm(r.buildMonomial(t,1),s,t),d=c[0],l=c[1],u=this.findErrorLocations(d),h=this.findErrorMagnitudes(l,u);for(let g=0;g<u.length;g++){const t=e.length-1-r.log(u[g]);if(t<0)throw new ReedSolomonException("Bad error location");e[t]=GenericGF.addOrSubtract(e[t],h[g])}}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){const r=e;e=t,t=r}const n=this.field;let o=e,i=t,s=n.getZero(),c=n.getOne();for(;i.getDegree()>=(r/2|0);){let e=o,t=s;if(o=i,s=c,o.isZero())throw new ReedSolomonException("r_{i-1} was zero");i=e;let r=n.getZero();const d=o.getCoefficient(o.getDegree()),l=n.inverse(d);for(;i.getDegree()>=o.getDegree()&&!i.isZero();){const e=i.getDegree()-o.getDegree(),t=n.multiply(i.getCoefficient(i.getDegree()),l);r=r.addOrSubtract(n.buildMonomial(e,t)),i=i.addOrSubtract(o.multiplyByMonomial(e,t))}if(c=r.multiply(s).addOrSubtract(t),i.getDegree()>=o.getDegree())throw new IllegalStateException("Division algorithm failed to reduce polynomial?")}const d=c.getCoefficient(0);if(0===d)throw new ReedSolomonException("sigmaTilde(0) was zero");const l=n.inverse(d);return[c.multiplyScalar(l),i.multiplyScalar(l)]}findErrorLocations(e){const t=e.getDegree();if(1===t)return Int32Array.from([e.getCoefficient(1)]);const r=new Int32Array(t);let n=0;const o=this.field;for(let i=1;i<o.getSize()&&n<t;i++)0===e.evaluateAt(i)&&(r[n]=o.inverse(i),n++);if(n!==t)throw new ReedSolomonException("Error locator degree does not match number of roots");return r}findErrorMagnitudes(e,t){const r=t.length,n=new Int32Array(r),o=this.field;for(let i=0;i<r;i++){const s=o.inverse(t[i]);let c=1;for(let e=0;e<r;e++)if(i!==e){const r=o.multiply(t[e],s),n=1&r?-2&r:1|r;c=o.multiply(c,n)}n[i]=o.multiply(e.evaluateAt(s),o.inverse(c)),0!==o.getGeneratorBase()&&(n[i]=o.multiply(n[i],s))}return n}}!function(e){e[e.UPPER=0]="UPPER",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.DIGIT=3]="DIGIT",e[e.PUNCT=4]="PUNCT",e[e.BINARY=5]="BINARY"}(l||(l={}));class Decoder{decode(e){this.ddata=e;let t=e.getBits(),r=this.extractBits(t),n=this.correctBits(r),o=Decoder.convertBoolArrayToByteArray(n),i=Decoder.getEncodedData(n),s=new DecoderResult(o,i,null,null);return s.setNumBits(n.length),s}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,r=l.UPPER,n=l.UPPER,o="",i=0;for(;i<t;)if(n===l.BINARY){if(t-i<5)break;let s=Decoder.readCode(e,i,5);if(i+=5,0===s){if(t-i<11)break;s=Decoder.readCode(e,i,11)+31,i+=11}for(let r=0;r<s;r++){if(t-i<8){i=t;break}const r=Decoder.readCode(e,i,8);o+=StringUtils.castAsNonUtf8Char(r),i+=8}n=r}else{let s=n===l.DIGIT?4:5;if(t-i<s)break;let c=Decoder.readCode(e,i,s);i+=s;let d=Decoder.getCharacter(n,c);d.startsWith("CTRL_")?(r=n,n=Decoder.getTable(d.charAt(5)),"L"===d.charAt(6)&&(r=n)):(o+=d,n=r)}return o}static getTable(e){switch(e){case"L":return l.LOWER;case"P":return l.PUNCT;case"M":return l.MIXED;case"D":return l.DIGIT;case"B":return l.BINARY;default:return l.UPPER}}static getCharacter(e,t){switch(e){case l.UPPER:return Decoder.UPPER_TABLE[t];case l.LOWER:return Decoder.LOWER_TABLE[t];case l.MIXED:return Decoder.MIXED_TABLE[t];case l.PUNCT:return Decoder.PUNCT_TABLE[t];case l.DIGIT:return Decoder.DIGIT_TABLE[t];default:throw new IllegalStateException("Bad table")}}correctBits(e){let t,r;this.ddata.getNbLayers()<=2?(r=6,t=GenericGF.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,t=GenericGF.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,t=GenericGF.AZTEC_DATA_10):(r=12,t=GenericGF.AZTEC_DATA_12);let n=this.ddata.getNbDatablocks(),o=e.length/r;if(o<n)throw new FormatException;let i=e.length%r,s=new Int32Array(o);for(let g=0;g<o;g++,i+=r)s[g]=Decoder.readCode(e,i,r);try{new ReedSolomonDecoder(t).decode(s,o-n)}catch(h){throw new FormatException(h)}let c=(1<<r)-1,d=0;for(let g=0;g<n;g++){let e=s[g];if(0===e||e===c)throw new FormatException;1!==e&&e!==c-1||d++}let l=new Array(n*r-d),u=0;for(let g=0;g<n;g++){let e=s[g];if(1===e||e===c-1)l.fill(e>1,u,u+r-1),u+=r-1;else for(let t=r-1;t>=0;--t)l[u++]=!!(e&1<<t)}return l}extractBits(e){let t=this.ddata.isCompact(),r=this.ddata.getNbLayers(),n=(t?11:14)+4*r,o=new Int32Array(n),i=new Array(this.totalBitsInLayer(r,t));if(t)for(let s=0;s<o.length;s++)o[s]=s;else{let e=n+1+2*Integer.truncDivision(Integer.truncDivision(n,2)-1,15),t=n/2,r=Integer.truncDivision(e,2);for(let n=0;n<t;n++){let e=n+Integer.truncDivision(n,15);o[t-n-1]=r-e-1,o[t+n]=r+e+1}}for(let s=0,c=0;s<r;s++){let d=4*(r-s)+(t?9:12),l=2*s,u=n-1-l;for(let t=0;t<d;t++){let r=2*t;for(let n=0;n<2;n++)i[c+r+n]=e.get(o[l+n],o[l+t]),i[c+2*d+r+n]=e.get(o[l+t],o[u-n]),i[c+4*d+r+n]=e.get(o[u-n],o[u-t]),i[c+6*d+r+n]=e.get(o[u-t],o[l+n])}c+=8*d}return i}static readCode(e,t,r){let n=0;for(let o=t;o<t+r;o++)n<<=1,e[o]&&(n|=1);return n}static readByte(e,t){let r=e.length-t;return r>=8?Decoder.readCode(e,t,8):Decoder.readCode(e,t,r)<<8-r}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let r=0;r<t.length;r++)t[r]=Decoder.readByte(e,8*r);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Decoder.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Decoder.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Decoder.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","\t","\n","\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Decoder.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Decoder.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class MathUtils{constructor(){}static round(e){return NaN===e?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,r,n){const o=e-r,i=t-n;return Math.sqrt(o*o+i*i)}static sum(e){let t=0;for(let r=0,n=e.length;r!==n;r++)t+=e[r];return t}}class Float{static floatToIntBits(e){return e}}Float.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ResultPoint{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof ResultPoint){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*Float.floatToIntBits(this.x)+Float.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),r=this.distance(e[1],e[2]),n=this.distance(e[0],e[2]);let o,i,s;if(r>=t&&r>=n?(i=e[0],o=e[1],s=e[2]):n>=r&&n>=t?(i=e[1],o=e[0],s=e[2]):(i=e[2],o=e[0],s=e[1]),this.crossProductZ(o,i,s)<0){const e=o;o=s,s=e}e[0]=o,e[1]=i,e[2]=s}static distance(e,t){return MathUtils.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,r){const n=t.x,o=t.y;return(r.x-n)*(e.y-o)-(r.y-o)*(e.x-n)}}class DetectorResult{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class AztecDetectorResult extends DetectorResult{constructor(e,t,r,n,o){super(e,t),this.compact=r,this.nbDatablocks=n,this.nbLayers=o}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class WhiteRectangleDetector{constructor(e,t,r,n){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),null==t&&(t=WhiteRectangleDetector.INIT_SIZE),null==r&&(r=e.getWidth()/2|0),null==n&&(n=e.getHeight()/2|0);const o=t/2|0;if(this.leftInit=r-o,this.rightInit=r+o,this.upInit=n-o,this.downInit=n+o,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new NotFoundException}detect(){let e=this.leftInit,t=this.rightInit,r=this.upInit,n=this.downInit,o=!1,i=!0,s=!1,c=!1,d=!1,l=!1,u=!1;const h=this.width,g=this.height;for(;i;){i=!1;let E=!0;for(;(E||!c)&&t<h;)E=this.containsBlackPoint(r,n,t,!1),E?(t++,i=!0,c=!0):c||t++;if(t>=h){o=!0;break}let f=!0;for(;(f||!d)&&n<g;)f=this.containsBlackPoint(e,t,n,!0),f?(n++,i=!0,d=!0):d||n++;if(n>=g){o=!0;break}let C=!0;for(;(C||!l)&&e>=0;)C=this.containsBlackPoint(r,n,e,!1),C?(e--,i=!0,l=!0):l||e--;if(e<0){o=!0;break}let m=!0;for(;(m||!u)&&r>=0;)m=this.containsBlackPoint(e,t,r,!0),m?(r--,i=!0,u=!0):u||r--;if(r<0){o=!0;break}i&&(s=!0)}if(!o&&s){const o=t-e;let i=null;for(let t=1;null===i&&t<o;t++)i=this.getBlackPointOnSegment(e,n-t,e+t,n);if(null==i)throw new NotFoundException;let s=null;for(let t=1;null===s&&t<o;t++)s=this.getBlackPointOnSegment(e,r+t,e+t,r);if(null==s)throw new NotFoundException;let c=null;for(let e=1;null===c&&e<o;e++)c=this.getBlackPointOnSegment(t,r+e,t-e,r);if(null==c)throw new NotFoundException;let d=null;for(let e=1;null===d&&e<o;e++)d=this.getBlackPointOnSegment(t,n-e,t-e,n);if(null==d)throw new NotFoundException;return this.centerEdges(d,i,c,s)}throw new NotFoundException}getBlackPointOnSegment(e,t,r,n){const o=MathUtils.round(MathUtils.distance(e,t,r,n)),i=(r-e)/o,s=(n-t)/o,c=this.image;for(let d=0;d<o;d++){const r=MathUtils.round(e+d*i),n=MathUtils.round(t+d*s);if(c.get(r,n))return new ResultPoint(r,n)}return null}centerEdges(e,t,r,n){const o=e.getX(),i=e.getY(),s=t.getX(),c=t.getY(),d=r.getX(),l=r.getY(),u=n.getX(),h=n.getY(),g=WhiteRectangleDetector.CORR;return o<this.width/2?[new ResultPoint(u-g,h+g),new ResultPoint(s+g,c+g),new ResultPoint(d-g,l-g),new ResultPoint(o+g,i-g)]:[new ResultPoint(u+g,h+g),new ResultPoint(s+g,c-g),new ResultPoint(d-g,l+g),new ResultPoint(o-g,i-g)]}containsBlackPoint(e,t,r,n){const o=this.image;if(n){for(let i=e;i<=t;i++)if(o.get(i,r))return!0}else for(let i=e;i<=t;i++)if(o.get(r,i))return!0;return!1}}WhiteRectangleDetector.INIT_SIZE=10,WhiteRectangleDetector.CORR=1;class GridSampler{static checkAndNudgePoints(e,t){const r=e.getWidth(),n=e.getHeight();let o=!0;for(let i=0;i<t.length&&o;i+=2){const e=Math.floor(t[i]),s=Math.floor(t[i+1]);if(e<-1||e>r||s<-1||s>n)throw new NotFoundException;o=!1,-1===e?(t[i]=0,o=!0):e===r&&(t[i]=r-1,o=!0),-1===s?(t[i+1]=0,o=!0):s===n&&(t[i+1]=n-1,o=!0)}o=!0;for(let i=t.length-2;i>=0&&o;i-=2){const e=Math.floor(t[i]),s=Math.floor(t[i+1]);if(e<-1||e>r||s<-1||s>n)throw new NotFoundException;o=!1,-1===e?(t[i]=0,o=!0):e===r&&(t[i]=r-1,o=!0),-1===s?(t[i+1]=0,o=!0):s===n&&(t[i+1]=n-1,o=!0)}}}class PerspectiveTransform{constructor(e,t,r,n,o,i,s,c,d){this.a11=e,this.a21=t,this.a31=r,this.a12=n,this.a22=o,this.a32=i,this.a13=s,this.a23=c,this.a33=d}static quadrilateralToQuadrilateral(e,t,r,n,o,i,s,c,d,l,u,h,g,E,f,C){const m=PerspectiveTransform.quadrilateralToSquare(e,t,r,n,o,i,s,c);return PerspectiveTransform.squareToQuadrilateral(d,l,u,h,g,E,f,C).times(m)}transformPoints(e){const t=e.length,r=this.a11,n=this.a12,o=this.a13,i=this.a21,s=this.a22,c=this.a23,d=this.a31,l=this.a32,u=this.a33;for(let h=0;h<t;h+=2){const t=e[h],g=e[h+1],E=o*t+c*g+u;e[h]=(r*t+i*g+d)/E,e[h+1]=(n*t+s*g+l)/E}}transformPointsWithValues(e,t){const r=this.a11,n=this.a12,o=this.a13,i=this.a21,s=this.a22,c=this.a23,d=this.a31,l=this.a32,u=this.a33,h=e.length;for(let g=0;g<h;g++){const h=e[g],E=t[g],f=o*h+c*E+u;e[g]=(r*h+i*E+d)/f,t[g]=(n*h+s*E+l)/f}}static squareToQuadrilateral(e,t,r,n,o,i,s,c){const d=e-r+o-s,l=t-n+i-c;if(0===d&&0===l)return new PerspectiveTransform(r-e,o-r,e,n-t,i-n,t,0,0,1);{const u=r-o,h=s-o,g=n-i,E=c-i,f=u*E-h*g,C=(d*E-h*l)/f,m=(u*l-d*g)/f;return new PerspectiveTransform(r-e+C*r,s-e+m*s,e,n-t+C*n,c-t+m*c,t,C,m,1)}}static quadrilateralToSquare(e,t,r,n,o,i,s,c){return PerspectiveTransform.squareToQuadrilateral(e,t,r,n,o,i,s,c).buildAdjoint()}buildAdjoint(){return new PerspectiveTransform(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new PerspectiveTransform(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class DefaultGridSampler extends GridSampler{sampleGrid(e,t,r,n,o,i,s,c,d,l,u,h,g,E,f,C,m,p,A){const S=PerspectiveTransform.quadrilateralToQuadrilateral(n,o,i,s,c,d,l,u,h,g,E,f,C,m,p,A);return this.sampleGridWithTransform(e,t,r,S)}sampleGridWithTransform(e,t,r,n){if(t<=0||r<=0)throw new NotFoundException;const o=new BitMatrix(t,r),i=new Float32Array(2*t);for(let c=0;c<r;c++){const t=i.length,r=c+.5;for(let e=0;e<t;e+=2)i[e]=e/2+.5,i[e+1]=r;n.transformPoints(i),GridSampler.checkAndNudgePoints(e,i);try{for(let r=0;r<t;r+=2)e.get(Math.floor(i[r]),Math.floor(i[r+1]))&&o.set(r/2,c)}catch(s){throw new NotFoundException}}return o}}class GridSamplerInstance{static setGridSampler(e){GridSamplerInstance.gridSampler=e}static getInstance(){return GridSamplerInstance.gridSampler}}GridSamplerInstance.gridSampler=new DefaultGridSampler;class Point{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new ResultPoint(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Detector{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),r=this.getBullsEyeCorners(t);if(e){let e=r[0];r[0]=r[2],r[2]=e}this.extractParameters(r);let n=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),o=this.getMatrixCornerPoints(r);return new AztecDetectorResult(n,o,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!(this.isValidPoint(e[0])&&this.isValidPoint(e[1])&&this.isValidPoint(e[2])&&this.isValidPoint(e[3])))throw new NotFoundException;let t=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(r,t);let n=0;for(let i=0;i<4;i++){let e=r[(this.shift+i)%4];this.compact?(n<<=7,n+=e>>1&127):(n<<=10,n+=(e>>2&992)+(e>>1&31))}let o=this.getCorrectedParameterData(n,this.compact);this.compact?(this.nbLayers=1+(o>>6),this.nbDataBlocks=1+(63&o)):(this.nbLayers=1+(o>>11),this.nbDataBlocks=1+(2047&o))}getRotation(e,t){let r=0;e.forEach((e,n,o)=>{r=(e>>t-2<<1)+(1&e)+(r<<3)}),r=((1&r)<<11)+(r>>1);for(let n=0;n<4;n++)if(Integer.bitCount(r^this.EXPECTED_CORNER_BITS[n])<=2)return n;throw new NotFoundException}getCorrectedParameterData(e,t){let r,n;t?(r=7,n=2):(r=10,n=4);let o=r-n,i=new Int32Array(r);for(let d=r-1;d>=0;--d)i[d]=15&e,e>>=4;try{new ReedSolomonDecoder(GenericGF.AZTEC_PARAM).decode(i,o)}catch(c){throw new NotFoundException}let s=0;for(let d=0;d<n;d++)s=(s<<4)+i[d];return s}getBullsEyeCorners(e){let t=e,r=e,n=e,o=e,i=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let e=this.getFirstDifferent(t,i,1,-1),s=this.getFirstDifferent(r,i,1,1),c=this.getFirstDifferent(n,i,-1,1),d=this.getFirstDifferent(o,i,-1,-1);if(this.nbCenterLayers>2){let r=this.distancePoint(d,e)*this.nbCenterLayers/(this.distancePoint(o,t)*(this.nbCenterLayers+2));if(r<.75||r>1.25||!this.isWhiteOrBlackRectangle(e,s,c,d))break}t=e,r=s,n=c,o=d,i=!i}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new NotFoundException;this.compact=5===this.nbCenterLayers;let s=new ResultPoint(t.getX()+.5,t.getY()-.5),c=new ResultPoint(r.getX()+.5,r.getY()+.5),d=new ResultPoint(n.getX()-.5,n.getY()+.5),l=new ResultPoint(o.getX()-.5,o.getY()-.5);return this.expandSquare([s,c,d,l],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,r,n;try{let o=new WhiteRectangleDetector(this.image).detect();e=o[0],t=o[1],r=o[2],n=o[3]}catch(s){let o=this.image.getWidth()/2,i=this.image.getHeight()/2;e=this.getFirstDifferent(new Point(o+7,i-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Point(o+7,i+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new Point(o-7,i+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new Point(o-7,i-7),!1,-1,-1).toResultPoint()}let o=MathUtils.round((e.getX()+n.getX()+t.getX()+r.getX())/4),i=MathUtils.round((e.getY()+n.getY()+t.getY()+r.getY())/4);try{let s=new WhiteRectangleDetector(this.image,15,o,i).detect();e=s[0],t=s[1],r=s[2],n=s[3]}catch(s){e=this.getFirstDifferent(new Point(o+7,i-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Point(o+7,i+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new Point(o-7,i+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new Point(o-7,i-7),!1,-1,-1).toResultPoint()}return o=MathUtils.round((e.getX()+n.getX()+t.getX()+r.getX())/4),i=MathUtils.round((e.getY()+n.getY()+t.getY()+r.getY())/4),new Point(o,i)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,r,n,o){let i=GridSamplerInstance.getInstance(),s=this.getDimension(),c=s/2-this.nbCenterLayers,d=s/2+this.nbCenterLayers;return i.sampleGrid(e,s,s,c,c,d,c,d,d,c,d,t.getX(),t.getY(),r.getX(),r.getY(),n.getX(),n.getY(),o.getX(),o.getY())}sampleLine(e,t,r){let n=0,o=this.distanceResultPoint(e,t),i=o/r,s=e.getX(),c=e.getY(),d=i*(t.getX()-e.getX())/o,l=i*(t.getY()-e.getY())/o;for(let u=0;u<r;u++)this.image.get(MathUtils.round(s+u*d),MathUtils.round(c+u*l))&&(n|=1<<r-u-1);return n}isWhiteOrBlackRectangle(e,t,r,n){let o=3;e=new Point(e.getX()-o,e.getY()+o),t=new Point(t.getX()-o,t.getY()-o),r=new Point(r.getX()+o,r.getY()-o),n=new Point(n.getX()+o,n.getY()+o);let i=this.getColor(n,e);if(0===i)return!1;let s=this.getColor(e,t);return s===i&&(s=this.getColor(t,r),s===i&&(s=this.getColor(r,n),s===i))}getColor(e,t){let r=this.distancePoint(e,t),n=(t.getX()-e.getX())/r,o=(t.getY()-e.getY())/r,i=0,s=e.getX(),c=e.getY(),d=this.image.get(e.getX(),e.getY()),l=Math.ceil(r);for(let h=0;h<l;h++)s+=n,c+=o,this.image.get(MathUtils.round(s),MathUtils.round(c))!==d&&i++;let u=i/r;return u>.1&&u<.9?0:u<=.1===d?1:-1}getFirstDifferent(e,t,r,n){let o=e.getX()+r,i=e.getY()+n;for(;this.isValid(o,i)&&this.image.get(o,i)===t;)o+=r,i+=n;for(o-=r,i-=n;this.isValid(o,i)&&this.image.get(o,i)===t;)o+=r;for(o-=r;this.isValid(o,i)&&this.image.get(o,i)===t;)i+=n;return i-=n,new Point(o,i)}expandSquare(e,t,r){let n=r/(2*t),o=e[0].getX()-e[2].getX(),i=e[0].getY()-e[2].getY(),s=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,d=new ResultPoint(s+n*o,c+n*i),l=new ResultPoint(s-n*o,c-n*i);return o=e[1].getX()-e[3].getX(),i=e[1].getY()-e[3].getY(),s=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2,[d,new ResultPoint(s+n*o,c+n*i),l,new ResultPoint(s-n*o,c-n*i)]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=MathUtils.round(e.getX()),r=MathUtils.round(e.getY());return this.isValid(t,r)}distancePoint(e,t){return MathUtils.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return MathUtils.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Integer.truncDivision(this.nbLayers-4,8)+1)+15}}class AztecReader{decode(e,t=null){let r=null,n=new Detector(e.getBlackMatrix()),o=null,i=null;try{let e=n.detectMirror(!1);o=e.getPoints(),this.reportFoundResultPoints(t,o),i=(new Decoder).decode(e)}catch(u){r=u}if(null==i)try{let e=n.detectMirror(!0);o=e.getPoints(),this.reportFoundResultPoints(t,o),i=(new Decoder).decode(e)}catch(u){if(null!=r)throw r;throw u}let s=new Result(i.getText(),i.getRawBytes(),i.getNumBits(),o,d.AZTEC,System.currentTimeMillis()),c=i.getByteSegments();null!=c&&s.putMetadata(C.BYTE_SEGMENTS,c);let l=i.getECLevel();return null!=l&&s.putMetadata(C.ERROR_CORRECTION_LEVEL,l),s}reportFoundResultPoints(e,t){if(null!=e){let r=e.get(i.NEED_RESULT_POINT_CALLBACK);null!=r&&t.forEach((e,t,n)=>{r.foundPossibleResultPoint(e)})}}reset(){}}class BrowserAztecCodeReader extends BrowserCodeReader{constructor(e=500){super(new AztecReader,e)}}class OneDReader{decode(e,t){try{return this.doDecode(e,t)}catch(r){if(t&&!0===t.get(i.TRY_HARDER)&&e.isRotateSupported()){const r=e.rotateCounterClockwise(),n=this.doDecode(r,t),o=n.getResultMetadata();let i=270;null!==o&&!0===o.get(C.ORIENTATION)&&(i+=o.get(C.ORIENTATION)%360),n.putMetadata(C.ORIENTATION,i);const s=n.getResultPoints();if(null!==s){const e=r.getHeight();for(let t=0;t<s.length;t++)s[t]=new ResultPoint(e-s[t].getY()-1,s[t].getX())}return n}throw new NotFoundException}}reset(){}doDecode(e,t){const r=e.getWidth(),n=e.getHeight();let o=new BitArray(r);const s=t&&!0===t.get(i.TRY_HARDER),c=Math.max(1,n>>(s?8:5));let d;d=s?n:15;const l=Math.trunc(n/2);for(let g=0;g<d;g++){const s=Math.trunc((g+1)/2),d=l+c*(1&g?-s:s);if(d<0||d>=n)break;try{o=e.getBlackRow(d,o)}catch(u){continue}for(let e=0;e<2;e++){if(1===e&&(o.reverse(),t&&!0===t.get(i.NEED_RESULT_POINT_CALLBACK))){const e=new Map;t.forEach((t,r)=>e.set(r,t)),e.delete(i.NEED_RESULT_POINT_CALLBACK),t=e}try{const n=this.decodeRow(d,o,t);if(1===e){n.putMetadata(C.ORIENTATION,180);const e=n.getResultPoints();null!==e&&(e[0]=new ResultPoint(r-e[0].getX()-1,e[0].getY()),e[1]=new ResultPoint(r-e[1].getX()-1,e[1].getY()))}return n}catch(h){}}}throw new NotFoundException}static recordPattern(e,start,t){const r=t.length;for(let c=0;c<r;c++)t[c]=0;const n=e.getSize();if(start>=n)throw new NotFoundException;let o=!e.get(start),i=0,s=start;for(;s<n;){if(e.get(s)!==o)t[i]++;else{if(++i===r)break;t[i]=1,o=!o}s++}if(i!==r&&(i!==r-1||s!==n))throw new NotFoundException}static recordPatternInReverse(e,start,t){let r=t.length,n=e.get(start);for(;start>0&&r>=0;)e.get(--start)!==n&&(r--,n=!n);if(r>=0)throw new NotFoundException;OneDReader.recordPattern(e,start+1,t)}static patternMatchVariance(e,t,r){const n=e.length;let o=0,i=0;for(let d=0;d<n;d++)o+=e[d],i+=t[d];if(o<i)return Number.POSITIVE_INFINITY;const s=o/i;r*=s;let c=0;for(let d=0;d<n;d++){const n=e[d],o=t[d]*s,i=n>o?n-o:o-n;if(i>r)return Number.POSITIVE_INFINITY;c+=i}return c/o}}class Code128Reader extends OneDReader{static findStartPattern(e){const t=e.getSize(),r=e.getNextSet(0);let n=0,o=Int32Array.from([0,0,0,0,0,0]),i=r,s=!1;const c=6;for(let d=r;d<t;d++)if(e.get(d)!==s)o[n]++;else{if(n===c-1){let t=Code128Reader.MAX_AVG_VARIANCE,r=-1;for(let e=Code128Reader.CODE_START_A;e<=Code128Reader.CODE_START_C;e++){const n=OneDReader.patternMatchVariance(o,Code128Reader.CODE_PATTERNS[e],Code128Reader.MAX_INDIVIDUAL_VARIANCE);n<t&&(t=n,r=e)}if(r>=0&&e.isRange(Math.max(0,i-(d-i)/2),i,!1))return Int32Array.from([i,d,r]);i+=o[0]+o[1],o=o.slice(2,o.length-1),o[n-1]=0,o[n]=0,n--}else n++;o[n]=1,s=!s}throw new NotFoundException}static decodeCode(e,t,r){OneDReader.recordPattern(e,r,t);let n=Code128Reader.MAX_AVG_VARIANCE,o=-1;for(let i=0;i<Code128Reader.CODE_PATTERNS.length;i++){const e=Code128Reader.CODE_PATTERNS[i],r=this.patternMatchVariance(t,e,Code128Reader.MAX_INDIVIDUAL_VARIANCE);r<n&&(n=r,o=i)}if(o>=0)return o;throw new NotFoundException}decodeRow(e,t,r){const n=r&&!0===r.get(i.ASSUME_GS1),o=Code128Reader.findStartPattern(t),s=o[2];let c=0;const l=new Uint8Array(20);let u;switch(l[c++]=s,s){case Code128Reader.CODE_START_A:u=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_START_B:u=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_START_C:u=Code128Reader.CODE_CODE_C;break;default:throw new FormatException}let h=!1,g=!1,E="",f=o[0],C=o[1];const m=Int32Array.from([0,0,0,0,0,0]);let p=0,A=0,S=s,w=0,I=!0,R=!1,_=!1;for(;!h;){const e=g;switch(g=!1,p=A,A=Code128Reader.decodeCode(t,m,C),l[c++]=A,A!==Code128Reader.CODE_STOP&&(I=!0),A!==Code128Reader.CODE_STOP&&(w++,S+=w*A),f=C,C+=m.reduce((e,t)=>e+t,0),A){case Code128Reader.CODE_START_A:case Code128Reader.CODE_START_B:case Code128Reader.CODE_START_C:throw new FormatException}switch(u){case Code128Reader.CODE_CODE_A:if(A<64)E+=_===R?String.fromCharCode(" ".charCodeAt(0)+A):String.fromCharCode(" ".charCodeAt(0)+A+128),_=!1;else if(A<96)E+=_===R?String.fromCharCode(A-64):String.fromCharCode(A+64),_=!1;else switch(A!==Code128Reader.CODE_STOP&&(I=!1),A){case Code128Reader.CODE_FNC_1:n&&(0===E.length?E+="]C1":E+=String.fromCharCode(29));break;case Code128Reader.CODE_FNC_2:case Code128Reader.CODE_FNC_3:break;case Code128Reader.CODE_FNC_4_A:!R&&_?(R=!0,_=!1):R&&_?(R=!1,_=!1):_=!0;break;case Code128Reader.CODE_SHIFT:g=!0,u=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_CODE_B:u=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_CODE_C:u=Code128Reader.CODE_CODE_C;break;case Code128Reader.CODE_STOP:h=!0}break;case Code128Reader.CODE_CODE_B:if(A<96)E+=_===R?String.fromCharCode(" ".charCodeAt(0)+A):String.fromCharCode(" ".charCodeAt(0)+A+128),_=!1;else switch(A!==Code128Reader.CODE_STOP&&(I=!1),A){case Code128Reader.CODE_FNC_1:n&&(0===E.length?E+="]C1":E+=String.fromCharCode(29));break;case Code128Reader.CODE_FNC_2:case Code128Reader.CODE_FNC_3:break;case Code128Reader.CODE_FNC_4_B:!R&&_?(R=!0,_=!1):R&&_?(R=!1,_=!1):_=!0;break;case Code128Reader.CODE_SHIFT:g=!0,u=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_A:u=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_C:u=Code128Reader.CODE_CODE_C;break;case Code128Reader.CODE_STOP:h=!0}break;case Code128Reader.CODE_CODE_C:if(A<100)A<10&&(E+="0"),E+=A;else switch(A!==Code128Reader.CODE_STOP&&(I=!1),A){case Code128Reader.CODE_FNC_1:n&&(0===E.length?E+="]C1":E+=String.fromCharCode(29));break;case Code128Reader.CODE_CODE_A:u=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_B:u=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_STOP:h=!0}}e&&(u=u===Code128Reader.CODE_CODE_A?Code128Reader.CODE_CODE_B:Code128Reader.CODE_CODE_A)}const D=C-f;if(C=t.getNextUnset(C),!t.isRange(C,Math.min(t.getSize(),C+(C-f)/2),!1))throw new NotFoundException;if(S-=w*p,S%103!==p)throw new ChecksumException;const B=E.length;if(0===B)throw new NotFoundException;B>0&&I&&(E=u===Code128Reader.CODE_CODE_C?E.substring(0,B-2):E.substring(0,B-1));const y=(o[1]+o[0])/2,T=f+D/2,N=l.length,P=new Uint8Array(N);for(let i=0;i<N;i++)P[i]=l[i];const M=[new ResultPoint(y,e),new ResultPoint(T,e)];return new Result(E,P,0,M,d.CODE_128,(new Date).getTime())}}Code128Reader.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Code128Reader.MAX_AVG_VARIANCE=.25,Code128Reader.MAX_INDIVIDUAL_VARIANCE=.7,Code128Reader.CODE_SHIFT=98,Code128Reader.CODE_CODE_C=99,Code128Reader.CODE_CODE_B=100,Code128Reader.CODE_CODE_A=101,Code128Reader.CODE_FNC_1=102,Code128Reader.CODE_FNC_2=97,Code128Reader.CODE_FNC_3=96,Code128Reader.CODE_FNC_4_A=101,Code128Reader.CODE_FNC_4_B=100,Code128Reader.CODE_START_A=103,Code128Reader.CODE_START_B=104,Code128Reader.CODE_START_C=105,Code128Reader.CODE_STOP=106;class Code39Reader extends OneDReader{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,r){let n=this.counters;n.fill(0),this.decodeRowResult="";let o,i,start=Code39Reader.findAsteriskPattern(t,n),s=t.getNextSet(start[1]),c=t.getSize();do{Code39Reader.recordPattern(t,s,n);let e=Code39Reader.toNarrowWidePattern(n);if(e<0)throw new NotFoundException;o=Code39Reader.patternToChar(e),this.decodeRowResult+=o,i=s;for(let t of n)s+=t;s=t.getNextSet(s)}while("*"!==o);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let l,u=0;for(let d of n)u+=d;if(s!==c&&2*(s-i-u)<u)throw new NotFoundException;if(this.usingCheckDigit){let e=this.decodeRowResult.length-1,t=0;for(let r=0;r<e;r++)t+=Code39Reader.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(r));if(this.decodeRowResult.charAt(e)!==Code39Reader.ALPHABET_STRING.charAt(t%43))throw new ChecksumException;this.decodeRowResult=this.decodeRowResult.substring(0,e)}if(0===this.decodeRowResult.length)throw new NotFoundException;l=this.extendedMode?Code39Reader.decodeExtended(this.decodeRowResult):this.decodeRowResult;let h=(start[1]+start[0])/2,g=i+u/2;return new Result(l,null,0,[new ResultPoint(h,e),new ResultPoint(g,e)],d.CODE_39,(new Date).getTime())}static findAsteriskPattern(e,t){let r=e.getSize(),n=e.getNextSet(0),o=0,i=n,s=!1,c=t.length;for(let d=n;d<r;d++)if(e.get(d)!==s)t[o]++;else{if(o===c-1){if(this.toNarrowWidePattern(t)===Code39Reader.ASTERISK_ENCODING&&e.isRange(Math.max(0,i-Math.floor((d-i)/2)),i,!1))return[i,d];i+=t[0]+t[1],t.copyWithin(0,2,2+o-1),t[o-1]=0,t[o]=0,o--}else o++;t[o]=1,s=!s}throw new NotFoundException}static toNarrowWidePattern(e){let t,r=e.length,n=0;do{let o=2147483647;for(let t of e)t<o&&t>n&&(o=t);n=o,t=0;let i=0,s=0;for(let c=0;c<r;c++){let o=e[c];o>n&&(s|=1<<r-1-c,t++,i+=o)}if(3===t){for(let o=0;o<r&&t>0;o++){let r=e[o];if(r>n&&(t--,2*r>=i))return-1}return s}}while(t>3);return-1}static patternToChar(e){for(let t=0;t<Code39Reader.CHARACTER_ENCODINGS.length;t++)if(Code39Reader.CHARACTER_ENCODINGS[t]===e)return Code39Reader.ALPHABET_STRING.charAt(t);if(e===Code39Reader.ASTERISK_ENCODING)return"*";throw new NotFoundException}static decodeExtended(e){let t=e.length,r="";for(let n=0;n<t;n++){let t=e.charAt(n);if("+"===t||"$"===t||"%"===t||"/"===t){let o=e.charAt(n+1),i="\0";switch(t){case"+":if(!(o>="A"&&o<="Z"))throw new FormatException;i=String.fromCharCode(o.charCodeAt(0)+32);break;case"$":if(!(o>="A"&&o<="Z"))throw new FormatException;i=String.fromCharCode(o.charCodeAt(0)-64);break;case"%":if(o>="A"&&o<="E")i=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")i=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")i=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")i=String.fromCharCode(o.charCodeAt(0)+43);else if("U"===o)i="\0";else if("V"===o)i="@";else if("W"===o)i="`";else{if("X"!==o&&"Y"!==o&&"Z"!==o)throw new FormatException;i=""}break;case"/":if(o>="A"&&o<="O")i=String.fromCharCode(o.charCodeAt(0)-32);else{if("Z"!==o)throw new FormatException;i=":"}}r+=i,n++}else r+=t}return r}}Code39Reader.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Code39Reader.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Code39Reader.ASTERISK_ENCODING=148;class ITFReader extends OneDReader{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,r){let n=this.decodeStart(t),o=this.decodeEnd(t),s=new StringBuilder;ITFReader.decodeMiddle(t,n[1],o[0],s);let c=s.toString(),l=null;null!=r&&(l=r.get(i.ALLOWED_LENGTHS)),null==l&&(l=ITFReader.DEFAULT_ALLOWED_LENGTHS);let u=c.length,h=!1,g=0;for(let i of l){if(u===i){h=!0;break}i>g&&(g=i)}if(!h&&u>g&&(h=!0),!h)throw new FormatException;const E=[new ResultPoint(n[1],e),new ResultPoint(o[0],e)];return new Result(c,null,0,E,d.ITF,(new Date).getTime())}static decodeMiddle(e,t,r,n){let o=new Int32Array(10),i=new Int32Array(5),s=new Int32Array(5);for(o.fill(0),i.fill(0),s.fill(0);t<r;){OneDReader.recordPattern(e,t,o);for(let e=0;e<5;e++){let t=2*e;i[e]=o[t],s[e]=o[t+1]}let r=ITFReader.decodeDigit(i);n.append(r.toString()),r=this.decodeDigit(s),n.append(r.toString()),o.forEach(function(e){t+=e})}}decodeStart(e){let t=ITFReader.skipWhiteSpace(e),r=ITFReader.findGuardPattern(e,t,ITFReader.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(e,r[0]),r}validateQuietZone(e,t){let r=10*this.narrowLineWidth;r=r<t?r:t;for(let n=t-1;r>0&&n>=0&&!e.get(n);n--)r--;if(0!==r)throw new NotFoundException}static skipWhiteSpace(e){const t=e.getSize(),r=e.getNextSet(0);if(r===t)throw new NotFoundException;return r}decodeEnd(e){e.reverse();try{let r,n=ITFReader.skipWhiteSpace(e);try{r=ITFReader.findGuardPattern(e,n,ITFReader.END_PATTERN_REVERSED[0])}catch(t){t instanceof NotFoundException&&(r=ITFReader.findGuardPattern(e,n,ITFReader.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,r[0]);let o=r[0];return r[0]=e.getSize()-r[1],r[1]=e.getSize()-o,r}finally{e.reverse()}}static findGuardPattern(e,t,r){let n=r.length,o=new Int32Array(n),i=e.getSize(),s=!1,c=0,d=t;o.fill(0);for(let l=t;l<i;l++)if(e.get(l)!==s)o[c]++;else{if(c===n-1){if(OneDReader.patternMatchVariance(o,r,ITFReader.MAX_INDIVIDUAL_VARIANCE)<ITFReader.MAX_AVG_VARIANCE)return[d,l];d+=o[0]+o[1],System.arraycopy(o,2,o,0,c-1),o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,s=!s}throw new NotFoundException}static decodeDigit(e){let t=ITFReader.MAX_AVG_VARIANCE,r=-1,n=ITFReader.PATTERNS.length;for(let o=0;o<n;o++){let n=ITFReader.PATTERNS[o],i=OneDReader.patternMatchVariance(e,n,ITFReader.MAX_INDIVIDUAL_VARIANCE);i<t?(t=i,r=o):i===t&&(r=-1)}if(r>=0)return r%10;throw new NotFoundException}}ITFReader.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ITFReader.MAX_AVG_VARIANCE=.38,ITFReader.MAX_INDIVIDUAL_VARIANCE=.5,ITFReader.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ITFReader.START_PATTERN=Int32Array.from([1,1,1,1]),ITFReader.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class AbstractUPCEANReader extends OneDReader{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t,r=!1,n=0,o=Int32Array.from([0,0,0]);for(;!r;){o=Int32Array.from([0,0,0]),t=AbstractUPCEANReader.findGuardPattern(e,n,!1,this.START_END_PATTERN,o);let start=t[0];n=t[1];let i=start-(n-start);i>=0&&(r=e.isRange(i,start,!1))}return t}static checkChecksum(e){return AbstractUPCEANReader.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let r=parseInt(e.charAt(t-1),10);return AbstractUPCEANReader.getStandardUPCEANChecksum(e.substring(0,t-1))===r}static getStandardUPCEANChecksum(e){let t=e.length,r=0;for(let n=t-1;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new FormatException;r+=t}r*=3;for(let n=t-2;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new FormatException;r+=t}return(1e3-r)%10}static decodeEnd(e,t){return AbstractUPCEANReader.findGuardPattern(e,t,!1,AbstractUPCEANReader.START_END_PATTERN,new Int32Array(AbstractUPCEANReader.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,r,n){return this.findGuardPattern(e,t,r,n,new Int32Array(n.length))}static findGuardPattern(e,t,r,n,o){let i=e.getSize(),s=0,c=t=r?e.getNextUnset(t):e.getNextSet(t),d=n.length,l=r;for(let u=t;u<i;u++)if(e.get(u)!==l)o[s]++;else{if(s===d-1){if(OneDReader.patternMatchVariance(o,n,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE)<AbstractUPCEANReader.MAX_AVG_VARIANCE)return Int32Array.from([c,u]);c+=o[0]+o[1];let e=o.slice(2,o.length-1);for(let t=0;t<s-1;t++)o[t]=e[t];o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,l=!l}throw new NotFoundException}static decodeDigit(e,t,r,n){this.recordPattern(e,r,t);let o=this.MAX_AVG_VARIANCE,i=-1,s=n.length;for(let c=0;c<s;c++){let e=n[c],r=OneDReader.patternMatchVariance(t,e,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE);r<o&&(o=r,i=c)}if(i>=0)return i;throw new NotFoundException}}AbstractUPCEANReader.MAX_AVG_VARIANCE=.48,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE=.7,AbstractUPCEANReader.START_END_PATTERN=Int32Array.from([1,1,1]),AbstractUPCEANReader.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),AbstractUPCEANReader.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),AbstractUPCEANReader.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class UPCEANExtension5Support{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,r){let n=this.decodeRowStringBuffer,o=this.decodeMiddle(t,r,n),i=n.toString(),s=UPCEANExtension5Support.parseExtensionString(i),c=[new ResultPoint((r[0]+r[1])/2,e),new ResultPoint(o,e)],l=new Result(i,null,0,c,d.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&l.putAllMetadata(s),l}decodeMiddle(e,t,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let o=e.getSize(),i=t[1],s=0;for(let d=0;d<5&&i<o;d++){let t=AbstractUPCEANReader.decodeDigit(e,n,i,AbstractUPCEANReader.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)i+=e;t>=10&&(s|=1<<4-d),4!==d&&(i=e.getNextSet(i),i=e.getNextUnset(i))}if(5!==r.length)throw new NotFoundException;let c=this.determineCheckDigit(s);if(UPCEANExtension5Support.extensionChecksum(r.toString())!==c)throw new NotFoundException;return i}static extensionChecksum(e){let t=e.length,r=0;for(let n=t-2;n>=0;n-=2)r+=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);r*=3;for(let n=t-1;n>=0;n-=2)r+=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);return r*=3,r%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new NotFoundException}static parseExtensionString(e){if(5!==e.length)return null;let t=UPCEANExtension5Support.parseExtension5String(e);return null==t?null:new Map([[C.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t=""}let r=parseInt(e.substring(1)),n=r%100;return t+(r/100).toString()+"."+(n<10?"0"+n:n.toString())}}class UPCEANExtension2Support{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,r){let n=this.decodeRowStringBuffer,o=this.decodeMiddle(t,r,n),i=n.toString(),s=UPCEANExtension2Support.parseExtensionString(i),c=[new ResultPoint((r[0]+r[1])/2,e),new ResultPoint(o,e)],l=new Result(i,null,0,c,d.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&l.putAllMetadata(s),l}decodeMiddle(e,t,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let o=e.getSize(),i=t[1],s=0;for(let c=0;c<2&&i<o;c++){let t=AbstractUPCEANReader.decodeDigit(e,n,i,AbstractUPCEANReader.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)i+=e;t>=10&&(s|=1<<1-c),1!==c&&(i=e.getNextSet(i),i=e.getNextUnset(i))}if(2!==r.length)throw new NotFoundException;if(parseInt(r.toString())%4!==s)throw new NotFoundException;return i}static parseExtensionString(e){return 2!==e.length?null:new Map([[C.ISSUE_NUMBER,parseInt(e)]])}}class UPCEANExtensionSupport{static decodeRow(e,t,r){let n=AbstractUPCEANReader.findGuardPattern(t,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new UPCEANExtension5Support).decodeRow(e,t,n)}catch(o){return(new UPCEANExtension2Support).decodeRow(e,t,n)}}}UPCEANExtensionSupport.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class UPCEANReader extends AbstractUPCEANReader{constructor(){super(),this.decodeRowStringBuffer="",UPCEANReader.L_AND_G_PATTERNS=UPCEANReader.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=UPCEANReader.L_PATTERNS[e-10],r=new Int32Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[t.length-e-1];UPCEANReader.L_AND_G_PATTERNS[e]=r}}decodeRow(e,t,r){let n=UPCEANReader.findStartGuardPattern(t),o=null==r?null:r.get(i.NEED_RESULT_POINT_CALLBACK);if(null!=o){const t=new ResultPoint((n[0]+n[1])/2,e);o.foundPossibleResultPoint(t)}let s=this.decodeMiddle(t,n,this.decodeRowStringBuffer),c=s.rowOffset,d=s.resultString;if(null!=o){const t=new ResultPoint(c,e);o.foundPossibleResultPoint(t)}let l=this.decodeEnd(t,c);if(null!=o){const t=new ResultPoint((l[0]+l[1])/2,e);o.foundPossibleResultPoint(t)}let u=l[1],h=u+(u-l[0]);if(h>=t.getSize()||!t.isRange(u,h,!1))throw new NotFoundException;let g=d.toString();if(g.length<8)throw new FormatException;if(!UPCEANReader.checkChecksum(g))throw new ChecksumException;let E=(n[1]+n[0])/2,f=(l[1]+l[0])/2,m=this.getBarcodeFormat(),p=[new ResultPoint(E,e),new ResultPoint(f,e)],A=new Result(g,null,0,p,m,(new Date).getTime()),S=0;try{let r=UPCEANExtensionSupport.decodeRow(e,t,l[1]);A.putMetadata(C.UPC_EAN_EXTENSION,r.getText()),A.putAllMetadata(r.getResultMetadata()),A.addResultPoints(r.getResultPoints()),S=r.getText().length}catch(I){}let w=null==r?null:r.get(i.ALLOWED_EAN_EXTENSIONS);if(null!=w){let e=!1;for(let t in w)if(S.toString()===t){e=!0;break}if(!e)throw new NotFoundException}return A}decodeEnd(e,t){return UPCEANReader.findGuardPattern(e,t,!1,UPCEANReader.START_END_PATTERN,new Int32Array(UPCEANReader.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return UPCEANReader.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let r=parseInt(e.charAt(t-1),10);return UPCEANReader.getStandardUPCEANChecksum(e.substring(0,t-1))===r}static getStandardUPCEANChecksum(e){let t=e.length,r=0;for(let n=t-1;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new FormatException;r+=t}r*=3;for(let n=t-2;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new FormatException;r+=t}return(1e3-r)%10}}class EAN13Reader extends UPCEANReader{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let o=e.getSize(),i=t[1],s=0;for(let c=0;c<6&&i<o;c++){let t=UPCEANReader.decodeDigit(e,n,i,UPCEANReader.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)i+=e;t>=10&&(s|=1<<5-c)}r=EAN13Reader.determineFirstDigit(r,s),i=UPCEANReader.findGuardPattern(e,i,!0,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0))[1];for(let c=0;c<6&&i<o;c++){let t=UPCEANReader.decodeDigit(e,n,i,UPCEANReader.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of n)i+=e}return{rowOffset:i,resultString:r}}getBarcodeFormat(){return d.EAN_13}static determineFirstDigit(e,t){for(let r=0;r<10;r++)if(t===this.FIRST_DIGIT_ENCODINGS[r])return e=String.fromCharCode("0".charCodeAt(0)+r)+e;throw new NotFoundException}}EAN13Reader.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class EAN8Reader extends UPCEANReader{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,r){const n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let o=e.getSize(),i=t[1];for(let s=0;s<4&&i<o;s++){let t=UPCEANReader.decodeDigit(e,n,i,UPCEANReader.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of n)i+=e}i=UPCEANReader.findGuardPattern(e,i,!0,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0))[1];for(let s=0;s<4&&i<o;s++){let t=UPCEANReader.decodeDigit(e,n,i,UPCEANReader.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of n)i+=e}return{rowOffset:i,resultString:r}}getBarcodeFormat(){return d.EAN_8}}class UPCAReader extends UPCEANReader{constructor(){super(...arguments),this.ean13Reader=new EAN13Reader}getBarcodeFormat(){return d.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,r){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,r))}decodeMiddle(e,t,r){return this.ean13Reader.decodeMiddle(e,t,r)}maybeReturnResult(e){let t=e.getText();if("0"===t.charAt(0)){let r=new Result(t.substring(1),null,null,e.getResultPoints(),d.UPC_A);return null!=e.getResultMetadata()&&r.putAllMetadata(e.getResultMetadata()),r}throw new NotFoundException}reset(){this.ean13Reader.reset()}}class UPCEReader extends UPCEANReader{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,r){const n=this.decodeMiddleCounters.map(e=>e);n[0]=0,n[1]=0,n[2]=0,n[3]=0;const o=e.getSize();let i=t[1],s=0;for(let c=0;c<6&&i<o;c++){const t=UPCEReader.decodeDigit(e,n,i,UPCEReader.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)i+=e;t>=10&&(s|=1<<5-c)}return{rowOffset:i,resultString:UPCEReader.determineNumSysAndCheckDigit(r,s)}}decodeEnd(e,t){return UPCEReader.findGuardPatternWithoutCounters(e,t,!0,UPCEReader.MIDDLE_END_PATTERN)}checkChecksum(e){return UPCEANReader.checkChecksum(UPCEReader.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let r=0;r<=1;r++)for(let n=0;n<10;n++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[r][n])return String.fromCharCode("0".charCodeAt(0)+r)+e+String.fromCharCode("0".charCodeAt(0)+n);throw NotFoundException.getNotFoundInstance()}getBarcodeFormat(){return d.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(e=>e.charCodeAt(0)),r=new StringBuilder;r.append(e.charAt(0));let n=t[5];switch(n){case 0:case 1:case 2:r.appendChars(t,0,2),r.append(n),r.append("0000"),r.appendChars(t,2,3);break;case 3:r.appendChars(t,0,3),r.append("00000"),r.appendChars(t,3,2);break;case 4:r.appendChars(t,0,4),r.append("00000"),r.append(t[4]);break;default:r.appendChars(t,0,5),r.append("0000"),r.append(n)}return e.length>=8&&r.append(e.charAt(7)),r.toString()}}UPCEReader.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),UPCEReader.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class MultiFormatUPCEANReader extends OneDReader{constructor(e){super();let t=null==e?null:e.get(i.POSSIBLE_FORMATS),r=[];isNullOrUndefined(t)?(r.push(new EAN13Reader),r.push(new UPCAReader),r.push(new EAN8Reader),r.push(new UPCEReader)):(t.indexOf(d.EAN_13)>-1&&r.push(new EAN13Reader),t.indexOf(d.UPC_A)>-1&&r.push(new UPCAReader),t.indexOf(d.EAN_8)>-1&&r.push(new EAN8Reader),t.indexOf(d.UPC_E)>-1&&r.push(new UPCEReader)),this.readers=r}decodeRow(e,t,r){for(let o of this.readers)try{const n=o.decodeRow(e,t,r),s=n.getBarcodeFormat()===d.EAN_13&&"0"===n.getText().charAt(0),c=null==r?null:r.get(i.POSSIBLE_FORMATS),l=null==c||c.includes(d.UPC_A);if(s&&l){const e=n.getRawBytes(),t=new Result(n.getText().substring(1),e,e?e.length:null,n.getResultPoints(),d.UPC_A);return t.putAllMetadata(n.getResultMetadata()),t}return n}catch(n){}throw new NotFoundException}reset(){for(let e of this.readers)e.reset()}}class AbstractRSSReader extends OneDReader{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let r=0;r<t.length;r++)if(OneDReader.patternMatchVariance(e,t[r],AbstractRSSReader.MAX_INDIVIDUAL_VARIANCE)<AbstractRSSReader.MAX_AVG_VARIANCE)return r;throw new NotFoundException}static count(e){return MathUtils.sum(new Int32Array(e))}static increment(e,t){let r=0,n=t[0];for(let o=1;o<e.length;o++)t[o]>n&&(n=t[o],r=o);e[r]++}static decrement(e,t){let r=0,n=t[0];for(let o=1;o<e.length;o++)t[o]<n&&(n=t[o],r=o);e[r]--}static isFinderPattern(e){let t=e[0]+e[1],r=t/(t+e[2]+e[3]);if(r>=AbstractRSSReader.MIN_FINDER_PATTERN_RATIO&&r<=AbstractRSSReader.MAX_FINDER_PATTERN_RATIO){let t=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(let n of e)n>r&&(r=n),n<t&&(t=n);return r<10*t}return!1}}AbstractRSSReader.MAX_AVG_VARIANCE=.2,AbstractRSSReader.MAX_INDIVIDUAL_VARIANCE=.45,AbstractRSSReader.MIN_FINDER_PATTERN_RATIO=9.5/12,AbstractRSSReader.MAX_FINDER_PATTERN_RATIO=12.5/14;class DataCharacter{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof DataCharacter))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class FinderPattern{constructor(e,t,start,r,n){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new ResultPoint(start,n)),this.resultPoints.push(new ResultPoint(r,n))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof FinderPattern))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class RSSUtils{constructor(){}static getRSSvalue(e,t,r){let n=0;for(let c of e)n+=c;let o=0,i=0,s=e.length;for(let c=0;c<s-1;c++){let d;for(d=1,i|=1<<c;d<e[c];d++,i&=~(1<<c)){let e=RSSUtils.combins(n-d-1,s-c-2);if(r&&0===i&&n-d-(s-c-1)>=s-c-1&&(e-=RSSUtils.combins(n-d-(s-c),s-c-2)),s-c-1>1){let r=0;for(let e=n-d-(s-c-2);e>t;e--)r+=RSSUtils.combins(n-d-e-1,s-c-3);e-=r*(s-1-c)}else n-d>t&&e--;o+=e}n-=d}return o}static combins(e,t){let r,n;e-t>t?(n=t,r=e-t):(n=e-t,r=t);let o=1,i=1;for(let s=e;s>r;s--)o*=s,i<=n&&(o/=i,i++);for(;i<=n;)o/=i,i++;return o}}class BitArrayBuilder{static buildBitArray(e){let t=2*e.length-1;null==e[e.length-1].getRightChar()&&(t-=1);let r=new BitArray(12*t),n=0,o=e[0].getRightChar().getValue();for(let i=11;i>=0;--i)o&1<<i&&r.set(n),n++;for(let i=1;i<e.length;++i){let t=e[i],o=t.getLeftChar().getValue();for(let e=11;e>=0;--e)o&1<<e&&r.set(n),n++;if(null!=t.getRightChar()){let e=t.getRightChar().getValue();for(let t=11;t>=0;--t)e&1<<t&&r.set(n),n++}}return r}}class BlockParsedResult{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class DecodedObject{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class DecodedChar extends DecodedObject{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===DecodedChar.FNC1}}DecodedChar.FNC1="$";class DecodedInformation extends DecodedObject{constructor(e,t,r){super(e),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class DecodedNumeric extends DecodedObject{constructor(e,t,r){if(super(e),t<0||t>10||r<0||r>10)throw new FormatException;this.firstDigit=t,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return 10*this.firstDigit+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===DecodedNumeric.FNC1}isSecondDigitFNC1(){return this.secondDigit===DecodedNumeric.FNC1}isAnyFNC1(){return this.firstDigit===DecodedNumeric.FNC1||this.secondDigit===DecodedNumeric.FNC1}}DecodedNumeric.FNC1=10;class FieldParser{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new NotFoundException;let t=e.substring(0,2);for(let o of FieldParser.TWO_DIGIT_DATA_LENGTH)if(o[0]===t)return o[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(2,o[2],e):FieldParser.processFixedAI(2,o[1],e);if(e.length<3)throw new NotFoundException;let r=e.substring(0,3);for(let o of FieldParser.THREE_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(3,o[2],e):FieldParser.processFixedAI(3,o[1],e);for(let o of FieldParser.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(4,o[2],e):FieldParser.processFixedAI(4,o[1],e);if(e.length<4)throw new NotFoundException;let n=e.substring(0,4);for(let o of FieldParser.FOUR_DIGIT_DATA_LENGTH)if(o[0]===n)return o[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(4,o[2],e):FieldParser.processFixedAI(4,o[1],e);throw new NotFoundException}static processFixedAI(e,t,r){if(r.length<e)throw new NotFoundException;let n=r.substring(0,e);if(r.length<e+t)throw new NotFoundException;let o=r.substring(e,e+t),i=r.substring(e+t),s="("+n+")"+o,c=FieldParser.parseFieldsInGeneralPurpose(i);return null==c?s:s+c}static processVariableAI(e,t,r){let n,o=r.substring(0,e);n=r.length<e+t?r.length:e+t;let i=r.substring(e,n),s=r.substring(n),c="("+o+")"+i,d=FieldParser.parseFieldsInGeneralPurpose(s);return null==d?c:c+d}}FieldParser.VARIABLE_LENGTH=[],FieldParser.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",FieldParser.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",FieldParser.VARIABLE_LENGTH,20],["22",FieldParser.VARIABLE_LENGTH,29],["30",FieldParser.VARIABLE_LENGTH,8],["37",FieldParser.VARIABLE_LENGTH,8],["90",FieldParser.VARIABLE_LENGTH,30],["91",FieldParser.VARIABLE_LENGTH,30],["92",FieldParser.VARIABLE_LENGTH,30],["93",FieldParser.VARIABLE_LENGTH,30],["94",FieldParser.VARIABLE_LENGTH,30],["95",FieldParser.VARIABLE_LENGTH,30],["96",FieldParser.VARIABLE_LENGTH,30],["97",FieldParser.VARIABLE_LENGTH,3],["98",FieldParser.VARIABLE_LENGTH,30],["99",FieldParser.VARIABLE_LENGTH,30]],FieldParser.THREE_DIGIT_DATA_LENGTH=[["240",FieldParser.VARIABLE_LENGTH,30],["241",FieldParser.VARIABLE_LENGTH,30],["242",FieldParser.VARIABLE_LENGTH,6],["250",FieldParser.VARIABLE_LENGTH,30],["251",FieldParser.VARIABLE_LENGTH,30],["253",FieldParser.VARIABLE_LENGTH,17],["254",FieldParser.VARIABLE_LENGTH,20],["400",FieldParser.VARIABLE_LENGTH,30],["401",FieldParser.VARIABLE_LENGTH,30],["402",17],["403",FieldParser.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",FieldParser.VARIABLE_LENGTH,20],["421",FieldParser.VARIABLE_LENGTH,15],["422",3],["423",FieldParser.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],FieldParser.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",FieldParser.VARIABLE_LENGTH,15],["391",FieldParser.VARIABLE_LENGTH,18],["392",FieldParser.VARIABLE_LENGTH,15],["393",FieldParser.VARIABLE_LENGTH,18],["703",FieldParser.VARIABLE_LENGTH,30]],FieldParser.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",FieldParser.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",FieldParser.VARIABLE_LENGTH,20],["8003",FieldParser.VARIABLE_LENGTH,30],["8004",FieldParser.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",FieldParser.VARIABLE_LENGTH,30],["8008",FieldParser.VARIABLE_LENGTH,12],["8018",18],["8020",FieldParser.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",FieldParser.VARIABLE_LENGTH,70],["8200",FieldParser.VARIABLE_LENGTH,70]];class GeneralAppIdDecoder{constructor(e){this.buffer=new StringBuilder,this.information=e}decodeAllCodes(e,t){let r=t,n=null;for(;;){let t=this.decodeGeneralPurposeField(r,n),o=FieldParser.parseFieldsInGeneralPurpose(t.getNewString());if(null!=o&&e.append(o),n=t.isRemaining()?""+t.getRemainingValue():null,r===t.getNewPosition())break;r=t.getNewPosition()}return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let t=this.extractNumericValueFromBitArray(e,4);return new DecodedNumeric(this.information.getSize(),0===t?DecodedNumeric.FNC1:t-1,DecodedNumeric.FNC1)}let t=this.extractNumericValueFromBitArray(e,7);return new DecodedNumeric(e+7,(t-8)/11,(t-8)%11)}extractNumericValueFromBitArray(e,t){return GeneralAppIdDecoder.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,r){let n=0;for(let o=0;o<r;++o)e.get(t+o)&&(n|=1<<r-o-1);return n}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),null!=t&&this.buffer.append(t),this.current.setPosition(e);let r=this.parseBlocks();return null!=r&&r.isRemaining()?new DecodedInformation(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new DecodedInformation(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let r=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),r===this.current.getPosition()&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return t=e.isSecondDigitFNC1()?new DecodedInformation(this.current.getPosition(),this.buffer.toString()):new DecodedInformation(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new BlockParsedResult(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let e=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,e)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new BlockParsedResult(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new BlockParsedResult(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new BlockParsedResult(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<116)return!0;if(e+8>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,8);return n>=232&&n<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new DecodedChar(e+5,DecodedChar.FNC1);if(t>=5&&t<15)return new DecodedChar(e+5,"0"+(t-5));let r,n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new DecodedChar(e+7,""+(n+1));if(n>=90&&n<116)return new DecodedChar(e+7,""+(n+7));switch(this.extractNumericValueFromBitArray(e,8)){case 232:r="!";break;case 233:r='"';break;case 234:r="%";break;case 235:r="&";break;case 236:r="'";break;case 237:r="(";break;case 238:r=")";break;case 239:r="*";break;case 240:r="+";break;case 241:r=",";break;case 242:r="-";break;case 243:r=".";break;case 244:r="/";break;case 245:r=":";break;case 246:r=";";break;case 247:r="<";break;case 248:r="=";break;case 249:r=">";break;case 250:r="?";break;case 251:r="_";break;case 252:r=" ";break;default:throw new FormatException}return new DecodedChar(e+8,r)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,6);return r>=16&&r<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new DecodedChar(e+5,DecodedChar.FNC1);if(t>=5&&t<15)return new DecodedChar(e+5,"0"+(t-5));let r,n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new DecodedChar(e+6,""+(n+33));switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new IllegalStateException("Decoding invalid alphanumeric value: "+n)}return new DecodedChar(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(2===t){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class AbstractExpandedDecoder{constructor(e){this.information=e,this.generalDecoder=new GeneralAppIdDecoder(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class AI01decoder extends AbstractExpandedDecoder{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let r=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,r)}encodeCompressedGtinWithoutAI(e,t,r){for(let n=0;n<4;++n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*n,10);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r)}AI01decoder.appendCheckDigit(e,r)}static appendCheckDigit(e,t){let r=0;for(let n=0;n<13;n++){let o=e.charAt(n+t).charCodeAt(0)-"0".charCodeAt(0);r+=1&n?o:3*o}r=10-r%10,10===r&&(r=0),e.append(r)}}AI01decoder.GTIN_SIZE=40;class AI01AndOtherAIs extends AI01decoder{constructor(e){super(e)}parseInformation(){let e=new StringBuilder;e.append("(01)");let t=e.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01AndOtherAIs.HEADER_SIZE,4);return e.append(r),this.encodeCompressedGtinWithoutAI(e,AI01AndOtherAIs.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,AI01AndOtherAIs.HEADER_SIZE+44)}}AI01AndOtherAIs.HEADER_SIZE=4;class AnyAIDecoder extends AbstractExpandedDecoder{constructor(e){super(e)}parseInformation(){let e=new StringBuilder;return this.getGeneralDecoder().decodeAllCodes(e,AnyAIDecoder.HEADER_SIZE)}}AnyAIDecoder.HEADER_SIZE=5;class AI01weightDecoder extends AI01decoder{constructor(e){super(e)}encodeCompressedWeight(e,t,r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,r);this.addWeightCode(e,n);let o=this.checkWeight(n),i=1e5;for(let s=0;s<5;++s)o/i===0&&e.append("0"),i/=10;e.append(o)}}class AI013x0xDecoder extends AI01weightDecoder{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=AI013x0xDecoder.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE+AI013x0xDecoder.WEIGHT_SIZE)throw new NotFoundException;let e=new StringBuilder;return this.encodeCompressedGtin(e,AI013x0xDecoder.HEADER_SIZE),this.encodeCompressedWeight(e,AI013x0xDecoder.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE,AI013x0xDecoder.WEIGHT_SIZE),e.toString()}}AI013x0xDecoder.HEADER_SIZE=5,AI013x0xDecoder.WEIGHT_SIZE=15;class AI013103decoder extends AI013x0xDecoder{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class AI01320xDecoder extends AI013x0xDecoder{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class AI01392xDecoder extends AI01decoder{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE)throw new NotFoundException;let e=new StringBuilder;this.encodeCompressedGtin(e,AI01392xDecoder.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE,AI01392xDecoder.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01392xDecoder.LAST_DIGIT_SIZE,null);return e.append(r.getNewString()),e.toString()}}AI01392xDecoder.HEADER_SIZE=8,AI01392xDecoder.LAST_DIGIT_SIZE=2;class AI01393xDecoder extends AI01decoder{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE)throw new NotFoundException;let e=new StringBuilder;this.encodeCompressedGtin(e,AI01393xDecoder.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE,AI01393xDecoder.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01393xDecoder.LAST_DIGIT_SIZE,AI01393xDecoder.FIRST_THREE_DIGITS_SIZE);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r);let n=this.getGeneralDecoder().decodeGeneralPurposeField(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01393xDecoder.LAST_DIGIT_SIZE+AI01393xDecoder.FIRST_THREE_DIGITS_SIZE,null);return e.append(n.getNewString()),e.toString()}}AI01393xDecoder.HEADER_SIZE=8,AI01393xDecoder.LAST_DIGIT_SIZE=2,AI01393xDecoder.FIRST_THREE_DIGITS_SIZE=10;class AI013x0x1xDecoder extends AI01weightDecoder{constructor(e,t,r){super(e),this.dateCode=r,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE+AI013x0x1xDecoder.WEIGHT_SIZE+AI013x0x1xDecoder.DATE_SIZE)throw new NotFoundException;let e=new StringBuilder;return this.encodeCompressedGtin(e,AI013x0x1xDecoder.HEADER_SIZE),this.encodeCompressedWeight(e,AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE,AI013x0x1xDecoder.WEIGHT_SIZE),this.encodeCompressedDate(e,AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE+AI013x0x1xDecoder.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,AI013x0x1xDecoder.DATE_SIZE);if(38400==r)return;e.append("("),e.append(this.dateCode),e.append(")");let n=r%32;r/=32;let o=r%12+1;r/=12;let i=r;i/10==0&&e.append("0"),e.append(i),o/10==0&&e.append("0"),e.append(o),n/10==0&&e.append("0"),e.append(n)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}function createDecoder(e){try{if(e.get(1))return new AI01AndOtherAIs(e);if(!e.get(2))return new AnyAIDecoder(e);switch(GeneralAppIdDecoder.extractNumericValueFromBitArray(e,1,4)){case 4:return new AI013103decoder(e);case 5:return new AI01320xDecoder(e)}switch(GeneralAppIdDecoder.extractNumericValueFromBitArray(e,1,5)){case 12:return new AI01392xDecoder(e);case 13:return new AI01393xDecoder(e)}switch(GeneralAppIdDecoder.extractNumericValueFromBitArray(e,1,7)){case 56:return new AI013x0x1xDecoder(e,"310","11");case 57:return new AI013x0x1xDecoder(e,"320","11");case 58:return new AI013x0x1xDecoder(e,"310","13");case 59:return new AI013x0x1xDecoder(e,"320","13");case 60:return new AI013x0x1xDecoder(e,"310","15");case 61:return new AI013x0x1xDecoder(e,"320","15");case 62:return new AI013x0x1xDecoder(e,"310","17");case 63:return new AI013x0x1xDecoder(e,"320","17")}}catch(t){throw console.log(t),new IllegalStateException("unknown decoder: "+e)}}AI013x0x1xDecoder.HEADER_SIZE=8,AI013x0x1xDecoder.WEIGHT_SIZE=20,AI013x0x1xDecoder.DATE_SIZE=16;class ExpandedPair{constructor(e,t,r,n){this.leftchar=e,this.rightchar=t,this.finderpattern=r,this.maybeLast=n}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return null==this.rightchar}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof ExpandedPair&&ExpandedPair.equalsOrNull(e.leftchar,t.leftchar)&&ExpandedPair.equalsOrNull(e.rightchar,t.rightchar)&&ExpandedPair.equalsOrNull(e.finderpattern,t.finderpattern)}static equalsOrNull(e,t){return null===e?null===t:ExpandedPair.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ExpandedRow{constructor(e,t,r){this.pairs=e,this.rowNumber=t,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof ExpandedRow&&this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed}checkEqualitity(e,t){if(!e||!t)return;let r;return e.forEach((e,n)=>{t.forEach(t=>{e.getLeftChar().getValue()===t.getLeftChar().getValue()&&e.getRightChar().getValue()===t.getRightChar().getValue()&&e.getFinderPatter().getValue()===t.getFinderPatter().getValue()&&(r=!0)})}),r}}class RSSExpandedReader extends AbstractRSSReader{constructor(e){super(...arguments),this.pairs=new Array(RSSExpandedReader.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=!0===e}decodeRow(e,t,r){this.pairs.length=0,this.startFromEven=!1;try{return RSSExpandedReader.constructResult(this.decodeRow2pairs(e,t))}catch(n){this.verbose&&console.log(n)}return this.pairs.length=0,this.startFromEven=!0,RSSExpandedReader.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let r,n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(o){if(o instanceof NotFoundException){if(!this.pairs.length)throw new NotFoundException;n=!0}}if(this.checkChecksum())return this.pairs;if(r=!!this.rows.length,this.storeRow(e,!1),r){let e=this.checkRowsBoolean(!1);if(null!=e)return e;if(e=this.checkRowsBoolean(!0),null!=e)return e}throw new NotFoundException}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(r){this.verbose&&console.log(r)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let t=this.rows[n];this.pairs.length=0;for(let r of e)this.pairs.push(r.getPairs());if(this.pairs.push(t.getPairs()),!RSSExpandedReader.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let o=new Array(e);o.push(t);try{return this.checkRows(o,n+1)}catch(r){this.verbose&&console.log(r)}}throw new NotFoundException}static isValidSequence(e){for(let t of RSSExpandedReader.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let stop=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){stop=!1;break}if(stop)return!0}return!1}storeRow(e,t){let r=0,n=!1,o=!1;for(;r<this.rows.length;){let t=this.rows[r];if(t.getRowNumber()>e){o=t.isEquivalent(this.pairs);break}n=t.isEquivalent(this.pairs),r++}o||n||RSSExpandedReader.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new ExpandedRow(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let r of t)if(r.getPairs().length!==e.length)for(let t of r.getPairs())for(let r of e)if(ExpandedPair.equals(t,r))break}static isPartialRow(e,t){for(let r of t){let t=!0;for(let n of e){let e=!1;for(let t of r.getPairs())if(n.equals(t)){e=!0;break}if(!e){t=!1;break}}if(t)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=createDecoder(BitArrayBuilder.buildBitArray(e)).parseInformation(),r=e[0].getFinderPattern().getResultPoints(),n=e[e.length-1].getFinderPattern().getResultPoints(),o=[r[0],r[1],n[0],n[1]];return new Result(t,null,null,o,d.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),r=e.getRightChar();if(null==r)return!1;let n=r.getChecksumPortion(),o=2;for(let i=1;i<this.pairs.size();++i){let e=this.pairs.get(i);n+=e.getLeftChar().getChecksumPortion(),o++;let t=e.getRightChar();null!=t&&(n+=t.getChecksumPortion(),o++)}return n%=211,211*(o-4)+n==t.getValue()}static getNextSecondBar(e,t){let r;return e.get(t)?(r=e.getNextUnset(t),r=e.getNextSet(r)):(r=e.getNextSet(t),r=e.getNextUnset(r)),r}retrieveNextPair(e,t,r){let n,o=t.length%2==0;this.startFromEven&&(o=!o);let i=!0,s=-1;do{this.findNextPair(e,t,s),n=this.parseFoundFinderPattern(e,r,o),null==n?s=RSSExpandedReader.getNextSecondBar(e,this.startEnd[0]):i=!1}while(i);let c,d=this.decodeDataCharacter(e,n,o,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new NotFoundException;try{c=this.decodeDataCharacter(e,n,o,!1)}catch(l){c=null,this.verbose&&console.log(l)}return new ExpandedPair(d,c,n,!0)}isEmptyPair(e){return 0===e.length}findNextPair(e,t,r){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let o,i=e.getSize();o=r>=0?r:this.isEmptyPair(t)?0:t[t.length-1].getFinderPattern().getStartEnd()[1];let s=t.length%2!=0;this.startFromEven&&(s=!s);let c=!1;for(;o<i&&(c=!e.get(o),c);)o++;let d=0,l=o;for(let u=o;u<i;u++)if(e.get(u)!=c)n[d]++;else{if(3==d){if(s&&RSSExpandedReader.reverseCounters(n),RSSExpandedReader.isFinderPattern(n))return this.startEnd[0]=l,void(this.startEnd[1]=u);s&&RSSExpandedReader.reverseCounters(n),l+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,d--}else d++;n[d]=1,c=!c}throw new NotFoundException}static reverseCounters(e){let t=e.length;for(let r=0;r<t/2;++r){let n=e[r];e[r]=e[t-r-1],e[t-r-1]=n}}parseFoundFinderPattern(e,t,r){let n,start,o;if(r){let t=this.startEnd[0]-1;for(;t>=0&&!e.get(t);)t--;t++,n=this.startEnd[0]-t,start=t,o=this.startEnd[1]}else start=this.startEnd[0],o=e.getNextUnset(this.startEnd[1]+1),n=o-this.startEnd[1];let i,s=this.getDecodeFinderCounters();System.arraycopy(s,0,s,1,s.length-1),s[0]=n;try{i=this.parseFinderValue(s,RSSExpandedReader.FINDER_PATTERNS)}catch(c){return null}return new FinderPattern(i,[start,o],start,o,t)}decodeDataCharacter(e,t,r,n){let o=this.getDataCharacterCounters();for(let D=0;D<o.length;D++)o[D]=0;if(n)RSSExpandedReader.recordPatternInReverse(e,t.getStartEnd()[0],o);else{RSSExpandedReader.recordPattern(e,t.getStartEnd()[1],o);for(let e=0,t=o.length-1;e<t;e++,t--){let r=o[e];o[e]=o[t],o[t]=r}}let i=17,s=MathUtils.sum(new Int32Array(o))/i,c=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(s-c)/c>.3)throw new NotFoundException;let d=this.getOddCounts(),l=this.getEvenCounts(),u=this.getOddRoundingErrors(),h=this.getEvenRoundingErrors();for(let D=0;D<o.length;D++){let e=1*o[D]/s,t=e+.5;if(t<1){if(e<.3)throw new NotFoundException;t=1}else if(t>8){if(e>8.7)throw new NotFoundException;t=8}let r=D/2;1&D?(l[r]=t,h[r]=e-t):(d[r]=t,u[r]=e-t)}this.adjustOddEvenCounts(i);let g=4*t.getValue()+(r?0:2)+(n?0:1)-1,E=0,f=0;for(let D=d.length-1;D>=0;D--){if(RSSExpandedReader.isNotA1left(t,r,n)){let e=RSSExpandedReader.WEIGHTS[g][2*D];f+=d[D]*e}E+=d[D]}let C=0;for(let D=l.length-1;D>=0;D--)if(RSSExpandedReader.isNotA1left(t,r,n)){let e=RSSExpandedReader.WEIGHTS[g][2*D+1];C+=l[D]*e}let m=f+C;if(1&E||E>13||E<4)throw new NotFoundException;let p=(13-E)/2,A=RSSExpandedReader.SYMBOL_WIDEST[p],S=9-A,w=RSSUtils.getRSSvalue(d,A,!0),I=RSSUtils.getRSSvalue(l,S,!1),R=RSSExpandedReader.EVEN_TOTAL_SUBSET[p],_=RSSExpandedReader.GSUM[p];return new DataCharacter(w*R+I+_,m)}static isNotA1left(e,t,r){return!(0==e.getValue()&&t&&r)}adjustOddEvenCounts(e){let t=MathUtils.sum(new Int32Array(this.getOddCounts())),r=MathUtils.sum(new Int32Array(this.getEvenCounts())),n=!1,o=!1;t>13?o=!0:t<4&&(n=!0);let i=!1,s=!1;r>13?s=!0:r<4&&(i=!0);let c=t+r-e,d=!(1&~t),l=!(1&r);if(1==c)if(d){if(l)throw new NotFoundException;o=!0}else{if(!l)throw new NotFoundException;s=!0}else if(-1==c)if(d){if(l)throw new NotFoundException;n=!0}else{if(!l)throw new NotFoundException;i=!0}else{if(0!=c)throw new NotFoundException;if(d){if(!l)throw new NotFoundException;t<r?(n=!0,s=!0):(o=!0,i=!0)}else if(l)throw new NotFoundException}if(n){if(o)throw new NotFoundException;RSSExpandedReader.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&RSSExpandedReader.decrement(this.getOddCounts(),this.getOddRoundingErrors()),i){if(s)throw new NotFoundException;RSSExpandedReader.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&RSSExpandedReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}RSSExpandedReader.SYMBOL_WIDEST=[7,5,4,3,1],RSSExpandedReader.EVEN_TOTAL_SUBSET=[4,20,52,104,204],RSSExpandedReader.GSUM=[0,348,1388,2948,3988],RSSExpandedReader.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],RSSExpandedReader.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],RSSExpandedReader.FINDER_PAT_A=0,RSSExpandedReader.FINDER_PAT_B=1,RSSExpandedReader.FINDER_PAT_C=2,RSSExpandedReader.FINDER_PAT_D=3,RSSExpandedReader.FINDER_PAT_E=4,RSSExpandedReader.FINDER_PAT_F=5,RSSExpandedReader.FINDER_PATTERN_SEQUENCES=[[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_C],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_E],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F]],RSSExpandedReader.MAX_PAIRS=11;class Pair extends DataCharacter{constructor(e,t,r){super(e,t),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class RSS14Reader extends AbstractRSSReader{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,r){const n=this.decodePair(t,!1,e,r);RSS14Reader.addOrTally(this.possibleLeftPairs,n),t.reverse();let o=this.decodePair(t,!0,e,r);RSS14Reader.addOrTally(this.possibleRightPairs,o),t.reverse();for(let i of this.possibleLeftPairs)if(i.getCount()>1)for(let e of this.possibleRightPairs)if(e.getCount()>1&&RSS14Reader.checkChecksum(i,e))return RSS14Reader.constructResult(i,e);throw new NotFoundException}static addOrTally(e,t){if(null==t)return;let r=!1;for(let n of e)if(n.getValue()===t.getValue()){n.incrementCount(),r=!0;break}r||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let r=4537077*e.getValue()+t.getValue(),n=new String(r).toString(),o=new StringBuilder;for(let d=13-n.length;d>0;d--)o.append("0");o.append(n);let i=0;for(let d=0;d<13;d++){let e=o.charAt(d).charCodeAt(0)-"0".charCodeAt(0);i+=1&d?e:3*e}i=10-i%10,10===i&&(i=0),o.append(i.toString());let s=e.getFinderPattern().getResultPoints(),c=t.getFinderPattern().getResultPoints();return new Result(o.toString(),null,0,[s[0],s[1],c[0],c[1]],d.RSS_14,(new Date).getTime())}static checkChecksum(e,t){let r=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,n=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return n>72&&n--,n>8&&n--,r===n}decodePair(e,t,r,n){try{let o=this.findFinderPattern(e,t),s=this.parseFoundFinderPattern(e,r,t,o),c=null==n?null:n.get(i.NEED_RESULT_POINT_CALLBACK);if(null!=c){let n=(o[0]+o[1])/2;t&&(n=e.getSize()-1-n),c.foundPossibleResultPoint(new ResultPoint(n,r))}let d=this.decodeDataCharacter(e,s,!0),l=this.decodeDataCharacter(e,s,!1);return new Pair(1597*d.getValue()+l.getValue(),d.getChecksumPortion()+4*l.getChecksumPortion(),s)}catch(o){return null}}decodeDataCharacter(e,t,r){let n=this.getDataCharacterCounters();for(let C=0;C<n.length;C++)n[C]=0;if(r)OneDReader.recordPatternInReverse(e,t.getStartEnd()[0],n);else{OneDReader.recordPattern(e,t.getStartEnd()[1]+1,n);for(let e=0,t=n.length-1;e<t;e++,t--){let r=n[e];n[e]=n[t],n[t]=r}}let o=r?16:15,i=MathUtils.sum(new Int32Array(n))/o,s=this.getOddCounts(),c=this.getEvenCounts(),d=this.getOddRoundingErrors(),l=this.getEvenRoundingErrors();for(let C=0;C<n.length;C++){let e=n[C]/i,t=Math.floor(e+.5);t<1?t=1:t>8&&(t=8);let r=Math.floor(C/2);1&C?(c[r]=t,l[r]=e-t):(s[r]=t,d[r]=e-t)}this.adjustOddEvenCounts(r,o);let u=0,h=0;for(let C=s.length-1;C>=0;C--)h*=9,h+=s[C],u+=s[C];let g=0,E=0;for(let C=c.length-1;C>=0;C--)g*=9,g+=c[C],E+=c[C];let f=h+3*g;if(r){if(1&u||u>12||u<4)throw new NotFoundException;let e=(12-u)/2,t=RSS14Reader.OUTSIDE_ODD_WIDEST[e],r=9-t,n=RSSUtils.getRSSvalue(s,t,!1),o=RSSUtils.getRSSvalue(c,r,!0),i=RSS14Reader.OUTSIDE_EVEN_TOTAL_SUBSET[e],d=RSS14Reader.OUTSIDE_GSUM[e];return new DataCharacter(n*i+o+d,f)}{if(1&E||E>10||E<4)throw new NotFoundException;let e=(10-E)/2,t=RSS14Reader.INSIDE_ODD_WIDEST[e],r=9-t,n=RSSUtils.getRSSvalue(s,t,!0),o=RSSUtils.getRSSvalue(c,r,!1),i=RSS14Reader.INSIDE_ODD_TOTAL_SUBSET[e],d=RSS14Reader.INSIDE_GSUM[e];return new DataCharacter(o*i+n+d,f)}}findFinderPattern(e,t){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let n=e.getSize(),o=!1,i=0;for(;i<n&&(o=!e.get(i),t!==o);)i++;let s=0,c=i;for(let d=i;d<n;d++)if(e.get(d)!==o)r[s]++;else{if(3===s){if(AbstractRSSReader.isFinderPattern(r))return[c,d];c+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,s--}else s++;r[s]=1,o=!o}throw new NotFoundException}parseFoundFinderPattern(e,t,r,n){let o=e.get(n[0]),i=n[0]-1;for(;i>=0&&o!==e.get(i);)i--;i++;const s=n[0]-i,c=this.getDecodeFinderCounters(),d=new Int32Array(c.length);System.arraycopy(c,0,d,1,c.length-1),d[0]=s;const l=this.parseFinderValue(d,RSS14Reader.FINDER_PATTERNS);let start=i,u=n[1];return r&&(start=e.getSize()-1-start,u=e.getSize()-1-u),new FinderPattern(l,[i,n[1]],start,u,t)}adjustOddEvenCounts(e,t){let r=MathUtils.sum(new Int32Array(this.getOddCounts())),n=MathUtils.sum(new Int32Array(this.getEvenCounts())),o=!1,i=!1,s=!1,c=!1;e?(r>12?i=!0:r<4&&(o=!0),n>12?c=!0:n<4&&(s=!0)):(r>11?i=!0:r<5&&(o=!0),n>10?c=!0:n<4&&(s=!0));let d=r+n-t,l=(1&r)==(e?1:0),u=!(1&~n);if(1===d)if(l){if(u)throw new NotFoundException;i=!0}else{if(!u)throw new NotFoundException;c=!0}else if(-1===d)if(l){if(u)throw new NotFoundException;o=!0}else{if(!u)throw new NotFoundException;s=!0}else{if(0!==d)throw new NotFoundException;if(l){if(!u)throw new NotFoundException;r<n?(o=!0,c=!0):(i=!0,s=!0)}else if(u)throw new NotFoundException}if(o){if(i)throw new NotFoundException;AbstractRSSReader.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&AbstractRSSReader.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(c)throw new NotFoundException;AbstractRSSReader.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&AbstractRSSReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}RSS14Reader.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],RSS14Reader.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],RSS14Reader.OUTSIDE_GSUM=[0,161,961,2015,2715],RSS14Reader.INSIDE_GSUM=[0,336,1036,1516],RSS14Reader.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],RSS14Reader.INSIDE_ODD_WIDEST=[2,4,6,8],RSS14Reader.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class MultiFormatOneDReader extends OneDReader{constructor(e,t){super(),this.readers=[],this.verbose=!0===t;const r=e?e.get(i.POSSIBLE_FORMATS):null,n=e&&void 0!==e.get(i.ASSUME_CODE_39_CHECK_DIGIT);r?((r.includes(d.EAN_13)||r.includes(d.UPC_A)||r.includes(d.EAN_8)||r.includes(d.UPC_E))&&this.readers.push(new MultiFormatUPCEANReader(e)),r.includes(d.CODE_39)&&this.readers.push(new Code39Reader(n)),r.includes(d.CODE_128)&&this.readers.push(new Code128Reader),r.includes(d.ITF)&&this.readers.push(new ITFReader),r.includes(d.RSS_14)&&this.readers.push(new RSS14Reader),r.includes(d.RSS_EXPANDED)&&this.readers.push(new RSSExpandedReader(this.verbose))):(this.readers.push(new MultiFormatUPCEANReader(e)),this.readers.push(new Code39Reader),this.readers.push(new MultiFormatUPCEANReader(e)),this.readers.push(new Code128Reader),this.readers.push(new ITFReader),this.readers.push(new RSS14Reader),this.readers.push(new RSSExpandedReader(this.verbose)))}decodeRow(e,t,r){for(let o=0;o<this.readers.length;o++)try{return this.readers[o].decodeRow(e,t,r)}catch(n){}throw new NotFoundException}reset(){this.readers.forEach(e=>e.reset())}}class BrowserBarcodeReader extends BrowserCodeReader{constructor(e=500,t){super(new MultiFormatOneDReader(t),e,t)}}class ECBlocks{constructor(e,t,r){this.ecCodewords=e,this.ecBlocks=[t],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ECB{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Version{constructor(e,t,r,n,o,i){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=r,this.dataRegionSizeRows=n,this.dataRegionSizeColumns=o,this.ecBlocks=i;let s=0;const c=i.getECCodewords(),d=i.getECBlocks();for(let l of d)s+=l.getCount()*(l.getDataCodewords()+c);this.totalCodewords=s}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(1&e||1&t)throw new FormatException;for(let r of Version.VERSIONS)if(r.symbolSizeRows===e&&r.symbolSizeColumns===t)return r;throw new FormatException}toString(){return""+this.versionNumber}static buildVersions(){return[new Version(1,10,10,8,8,new ECBlocks(5,new ECB(1,3))),new Version(2,12,12,10,10,new ECBlocks(7,new ECB(1,5))),new Version(3,14,14,12,12,new ECBlocks(10,new ECB(1,8))),new Version(4,16,16,14,14,new ECBlocks(12,new ECB(1,12))),new Version(5,18,18,16,16,new ECBlocks(14,new ECB(1,18))),new Version(6,20,20,18,18,new ECBlocks(18,new ECB(1,22))),new Version(7,22,22,20,20,new ECBlocks(20,new ECB(1,30))),new Version(8,24,24,22,22,new ECBlocks(24,new ECB(1,36))),new Version(9,26,26,24,24,new ECBlocks(28,new ECB(1,44))),new Version(10,32,32,14,14,new ECBlocks(36,new ECB(1,62))),new Version(11,36,36,16,16,new ECBlocks(42,new ECB(1,86))),new Version(12,40,40,18,18,new ECBlocks(48,new ECB(1,114))),new Version(13,44,44,20,20,new ECBlocks(56,new ECB(1,144))),new Version(14,48,48,22,22,new ECBlocks(68,new ECB(1,174))),new Version(15,52,52,24,24,new ECBlocks(42,new ECB(2,102))),new Version(16,64,64,14,14,new ECBlocks(56,new ECB(2,140))),new Version(17,72,72,16,16,new ECBlocks(36,new ECB(4,92))),new Version(18,80,80,18,18,new ECBlocks(48,new ECB(4,114))),new Version(19,88,88,20,20,new ECBlocks(56,new ECB(4,144))),new Version(20,96,96,22,22,new ECBlocks(68,new ECB(4,174))),new Version(21,104,104,24,24,new ECBlocks(56,new ECB(6,136))),new Version(22,120,120,18,18,new ECBlocks(68,new ECB(6,175))),new Version(23,132,132,20,20,new ECBlocks(62,new ECB(8,163))),new Version(24,144,144,22,22,new ECBlocks(62,new ECB(8,156),new ECB(2,155))),new Version(25,8,18,6,16,new ECBlocks(7,new ECB(1,5))),new Version(26,8,32,6,14,new ECBlocks(11,new ECB(1,10))),new Version(27,12,26,10,24,new ECBlocks(14,new ECB(1,16))),new Version(28,12,36,10,16,new ECBlocks(18,new ECB(1,22))),new Version(29,16,36,14,16,new ECBlocks(24,new ECB(1,32))),new Version(30,16,48,14,22,new ECBlocks(28,new ECB(1,49)))]}}Version.VERSIONS=Version.buildVersions();class BitMatrixParser{constructor(e){const t=e.getHeight();if(t<8||t>144||1&t)throw new FormatException;this.version=BitMatrixParser.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new BitMatrix(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),r=e.getWidth();return Version.getVersionForDimensions(t,r)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,r=4,n=0;const o=this.mappingBitMatrix.getHeight(),i=this.mappingBitMatrix.getWidth();let s=!1,c=!1,d=!1,l=!1;do{if(r!==o||0!==n||s)if(r===o-2&&0===n&&3&i&&!c)e[t++]=255&this.readCorner2(o,i),r-=2,n+=2,c=!0;else if(r!==o+4||2!==n||7&i||d)if(r!==o-2||0!==n||4!=(7&i)||l){do{r<o&&n>=0&&!this.readMappingMatrix.get(n,r)&&(e[t++]=255&this.readUtah(r,n,o,i)),r-=2,n+=2}while(r>=0&&n<i);r+=1,n+=3;do{r>=0&&n<i&&!this.readMappingMatrix.get(n,r)&&(e[t++]=255&this.readUtah(r,n,o,i)),r+=2,n-=2}while(r<o&&n>=0);r+=3,n+=1}else e[t++]=255&this.readCorner4(o,i),r-=2,n+=2,l=!0;else e[t++]=255&this.readCorner3(o,i),r-=2,n+=2,d=!0;else e[t++]=255&this.readCorner1(o,i),r-=2,n+=2,s=!0}while(r<o||n<i);if(t!==this.version.getTotalCodewords())throw new FormatException;return e}readModule(e,t,r,n){return e<0&&(e+=r,t+=4-(r+4&7)),t<0&&(t+=n,e+=4-(n+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,r,n){let o=0;return this.readModule(e-2,t-2,r,n)&&(o|=1),o<<=1,this.readModule(e-2,t-1,r,n)&&(o|=1),o<<=1,this.readModule(e-1,t-2,r,n)&&(o|=1),o<<=1,this.readModule(e-1,t-1,r,n)&&(o|=1),o<<=1,this.readModule(e-1,t,r,n)&&(o|=1),o<<=1,this.readModule(e,t-2,r,n)&&(o|=1),o<<=1,this.readModule(e,t-1,r,n)&&(o|=1),o<<=1,this.readModule(e,t,r,n)&&(o|=1),o}readCorner1(e,t){let r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,1,e,t)&&(r|=1),r<<=1,this.readModule(e-1,2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r}readCorner2(e,t){let r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-4,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r}readCorner3(e,t){let r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-3,e,t)&&(r|=1),r<<=1,this.readModule(1,t-2,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r}readCorner4(e,t){let r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new IllegalArgumentException("Dimension of bitMatrix must match the version size");const n=this.version.getDataRegionSizeRows(),o=this.version.getDataRegionSizeColumns(),i=t/n|0,s=r/o|0,c=new BitMatrix(s*o,i*n);for(let d=0;d<i;++d){const t=d*n;for(let r=0;r<s;++r){const i=r*o;for(let s=0;s<n;++s){const l=d*(n+2)+1+s,u=t+s;for(let t=0;t<o;++t){const n=r*(o+2)+1+t;if(e.get(n,l)){const e=i+t;c.set(e,u)}}}}}return c}}class DataBlock{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const r=t.getECBlocks();let n=0;const o=r.getECBlocks();for(let E of o)n+=E.getCount();const i=new Array(n);let s=0;for(let E of o)for(let e=0;e<E.getCount();e++){const e=E.getDataCodewords(),t=r.getECCodewords()+e;i[s++]=new DataBlock(e,new Uint8Array(t))}const c=i[0].codewords.length-r.getECCodewords(),d=c-1;let l=0;for(let E=0;E<d;E++)for(let t=0;t<s;t++)i[t].codewords[E]=e[l++];const u=24===t.getVersionNumber(),h=u?8:s;for(let E=0;E<h;E++)i[E].codewords[c-1]=e[l++];const g=i[0].codewords.length;for(let E=c;E<g;E++)for(let t=0;t<s;t++){const r=u?(t+8)%s:t,n=u&&r>7?E-1:E;i[r].codewords[n]=e[l++]}if(l!==e.length)throw new IllegalArgumentException;return i}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class BitSource{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new IllegalArgumentException(""+e);let t=0,r=this.bitOffset,n=this.byteOffset;const o=this.bytes;if(r>0){const i=8-r,s=e<i?e:i,c=i-s,d=255>>8-s<<c;t=(o[n]&d)>>c,e-=s,r+=s,8===r&&(r=0,n++)}if(e>0){for(;e>=8;)t=t<<8|255&o[n],n++,e-=8;if(e>0){const i=8-e,s=255>>i<<i;t=t<<e|(o[n]&s)>>i,r+=e}}return this.bitOffset=r,this.byteOffset=n,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}!function(e){e[e.PAD_ENCODE=0]="PAD_ENCODE",e[e.ASCII_ENCODE=1]="ASCII_ENCODE",e[e.C40_ENCODE=2]="C40_ENCODE",e[e.TEXT_ENCODE=3]="TEXT_ENCODE",e[e.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",e[e.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",e[e.BASE256_ENCODE=6]="BASE256_ENCODE"}(u||(u={}));class DecodedBitStreamParser{static decode(e){const t=new BitSource(e),r=new StringBuilder,n=new StringBuilder,o=new Array;let i=u.ASCII_ENCODE;do{if(i===u.ASCII_ENCODE)i=this.decodeAsciiSegment(t,r,n);else{switch(i){case u.C40_ENCODE:this.decodeC40Segment(t,r);break;case u.TEXT_ENCODE:this.decodeTextSegment(t,r);break;case u.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,r);break;case u.EDIFACT_ENCODE:this.decodeEdifactSegment(t,r);break;case u.BASE256_ENCODE:this.decodeBase256Segment(t,r,o);break;default:throw new FormatException}i=u.ASCII_ENCODE}}while(i!==u.PAD_ENCODE&&t.available()>0);return n.length()>0&&r.append(n.toString()),new DecoderResult(e,r.toString(),0===o.length?null:o,null)}static decodeAsciiSegment(e,t,r){let n=!1;do{let o=e.readBits(8);if(0===o)throw new FormatException;if(o<=128)return n&&(o+=128),t.append(String.fromCharCode(o-1)),u.ASCII_ENCODE;if(129===o)return u.PAD_ENCODE;if(o<=229){const e=o-130;e<10&&t.append("0"),t.append(""+e)}else switch(o){case 230:return u.C40_ENCODE;case 231:return u.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:case 241:break;case 235:n=!0;break;case 236:t.append("[)>05"),r.insert(0,"");break;case 237:t.append("[)>06"),r.insert(0,"");break;case 238:return u.ANSIX12_ENCODE;case 239:return u.TEXT_ENCODE;case 240:return u.EDIFACT_ENCODE;default:if(254!==o||0!==e.available())throw new FormatException}}while(e.available()>0);return u.ASCII_ENCODE}static decodeC40Segment(e,t){let r=!1;const n=[];let o=0;do{if(8===e.available())return;const i=e.readBits(8);if(254===i)return;this.parseTwoBytes(i,e.readBits(8),n);for(let e=0;e<3;e++){const i=n[e];switch(o){case 0:if(i<3)o=i+1;else{if(!(i<this.C40_BASIC_SET_CHARS.length))throw new FormatException;{const e=this.C40_BASIC_SET_CHARS[i];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}}break;case 1:r?(t.append(String.fromCharCode(i+128)),r=!1):t.append(String.fromCharCode(i)),o=0;break;case 2:if(i<this.C40_SHIFT2_SET_CHARS.length){const e=this.C40_SHIFT2_SET_CHARS[i];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}else switch(i){case 27:t.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new FormatException}o=0;break;case 3:r?(t.append(String.fromCharCode(i+224)),r=!1):t.append(String.fromCharCode(i+96)),o=0;break;default:throw new FormatException}}}while(e.available()>0)}static decodeTextSegment(e,t){let r=!1,n=[],o=0;do{if(8===e.available())return;const i=e.readBits(8);if(254===i)return;this.parseTwoBytes(i,e.readBits(8),n);for(let e=0;e<3;e++){const i=n[e];switch(o){case 0:if(i<3)o=i+1;else{if(!(i<this.TEXT_BASIC_SET_CHARS.length))throw new FormatException;{const e=this.TEXT_BASIC_SET_CHARS[i];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}}break;case 1:r?(t.append(String.fromCharCode(i+128)),r=!1):t.append(String.fromCharCode(i)),o=0;break;case 2:if(i<this.TEXT_SHIFT2_SET_CHARS.length){const e=this.TEXT_SHIFT2_SET_CHARS[i];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}else switch(i){case 27:t.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new FormatException}o=0;break;case 3:if(!(i<this.TEXT_SHIFT3_SET_CHARS.length))throw new FormatException;{const e=this.TEXT_SHIFT3_SET_CHARS[i];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e),o=0}break;default:throw new FormatException}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const r=[];do{if(8===e.available())return;const n=e.readBits(8);if(254===n)return;this.parseTwoBytes(n,e.readBits(8),r);for(let e=0;e<3;e++){const n=r[e];switch(n){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(n<14)t.append(String.fromCharCode(n+44));else{if(!(n<40))throw new FormatException;t.append(String.fromCharCode(n+51))}}}}while(e.available()>0)}static parseTwoBytes(e,t,r){let n=(e<<8)+t-1,o=Math.floor(n/1600);r[0]=o,n-=1600*o,o=Math.floor(n/40),r[1]=o,r[2]=n-40*o}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let r=0;r<4;r++){let r=e.readBits(6);if(31===r){const t=8-e.getBitOffset();return void(8!==t&&e.readBits(t))}32&r||(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,r){let n=1+e.getByteOffset();const o=this.unrandomize255State(e.readBits(8),n++);let i;if(i=0===o?e.available()/8|0:o<250?o:250*(o-249)+this.unrandomize255State(e.readBits(8),n++),i<0)throw new FormatException;const s=new Uint8Array(i);for(let d=0;d<i;d++){if(e.available()<8)throw new FormatException;s[d]=this.unrandomize255State(e.readBits(8),n++)}r.push(s);try{t.append(StringEncoding.decode(s,StringUtils.ISO88591))}catch(c){throw new IllegalStateException("Platform does not support required encoding: "+c.message)}}static unrandomize255State(e,t){const r=e-(149*t%255+1);return r>=0?r:r+256}}DecodedBitStreamParser.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],DecodedBitStreamParser.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],DecodedBitStreamParser.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],DecodedBitStreamParser.TEXT_SHIFT2_SET_CHARS=DecodedBitStreamParser.C40_SHIFT2_SET_CHARS,DecodedBitStreamParser.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Decoder$1{constructor(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.DATA_MATRIX_FIELD_256)}decode(e){const t=new BitMatrixParser(e),r=t.getVersion(),n=t.readCodewords(),o=DataBlock.getDataBlocks(n,r);let i=0;for(let d of o)i+=d.getNumDataCodewords();const s=new Uint8Array(i),c=o.length;for(let d=0;d<c;d++){const e=o[d],t=e.getCodewords(),r=e.getNumDataCodewords();this.correctErrors(t,r);for(let n=0;n<r;n++)s[n*c+d]=t[n]}return DecodedBitStreamParser.decode(s)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch(n){throw new ChecksumException}for(let o=0;o<t;o++)e[o]=r[o]}}class Detector$1{constructor(e){this.image=e,this.rectangleDetector=new WhiteRectangleDetector(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new NotFoundException;t=this.shiftToModuleCenter(t);const r=t[0],n=t[1],o=t[2],i=t[3];let s=this.transitionsBetween(r,i)+1,c=this.transitionsBetween(o,i)+1;1&~s||(s+=1),1&~c||(c+=1),4*s<7*c&&4*c<7*s&&(s=c=Math.max(s,c));let d=Detector$1.sampleGrid(this.image,r,n,o,i,s,c);return new DetectorResult(d,[r,n,o,i])}static shiftPoint(e,t,r){let n=(t.getX()-e.getX())/(r+1),o=(t.getY()-e.getY())/(r+1);return new ResultPoint(e.getX()+n,e.getY()+o)}static moveAway(e,t,r){let n=e.getX(),o=e.getY();return n<t?n-=1:n+=1,o<r?o-=1:o+=1,new ResultPoint(n,o)}detectSolid1(e){let t=e[0],r=e[1],n=e[3],o=e[2],i=this.transitionsBetween(t,r),s=this.transitionsBetween(r,n),c=this.transitionsBetween(n,o),d=this.transitionsBetween(o,t),l=i,u=[o,t,r,n];return l>s&&(l=s,u[0]=t,u[1]=r,u[2]=n,u[3]=o),l>c&&(l=c,u[0]=r,u[1]=n,u[2]=o,u[3]=t),l>d&&(u[0]=n,u[1]=o,u[2]=t,u[3]=r),u}detectSolid2(e){let t=e[0],r=e[1],n=e[2],o=e[3],i=this.transitionsBetween(t,o),s=Detector$1.shiftPoint(r,n,4*(i+1)),c=Detector$1.shiftPoint(n,r,4*(i+1));return this.transitionsBetween(s,t)<this.transitionsBetween(c,o)?(e[0]=t,e[1]=r,e[2]=n,e[3]=o):(e[0]=r,e[1]=n,e[2]=o,e[3]=t),e}correctTopRight(e){let t=e[0],r=e[1],n=e[2],o=e[3],i=this.transitionsBetween(t,o),s=this.transitionsBetween(r,o),c=Detector$1.shiftPoint(t,r,4*(s+1)),d=Detector$1.shiftPoint(n,r,4*(i+1));i=this.transitionsBetween(c,o),s=this.transitionsBetween(d,o);let l=new ResultPoint(o.getX()+(n.getX()-r.getX())/(i+1),o.getY()+(n.getY()-r.getY())/(i+1)),u=new ResultPoint(o.getX()+(t.getX()-r.getX())/(s+1),o.getY()+(t.getY()-r.getY())/(s+1));return this.isValid(l)?this.isValid(u)?this.transitionsBetween(c,l)+this.transitionsBetween(d,l)>this.transitionsBetween(c,u)+this.transitionsBetween(d,u)?l:u:l:this.isValid(u)?u:null}shiftToModuleCenter(e){let t=e[0],r=e[1],n=e[2],o=e[3],i=this.transitionsBetween(t,o)+1,s=this.transitionsBetween(n,o)+1,c=Detector$1.shiftPoint(t,r,4*s),d=Detector$1.shiftPoint(n,r,4*i);i=this.transitionsBetween(c,o)+1,s=this.transitionsBetween(d,o)+1,1&~i||(i+=1),1&~s||(s+=1);let l,u,h=(t.getX()+r.getX()+n.getX()+o.getX())/4,g=(t.getY()+r.getY()+n.getY()+o.getY())/4;return t=Detector$1.moveAway(t,h,g),r=Detector$1.moveAway(r,h,g),n=Detector$1.moveAway(n,h,g),o=Detector$1.moveAway(o,h,g),c=Detector$1.shiftPoint(t,r,4*s),c=Detector$1.shiftPoint(c,o,4*i),l=Detector$1.shiftPoint(r,t,4*s),l=Detector$1.shiftPoint(l,n,4*i),d=Detector$1.shiftPoint(n,o,4*s),d=Detector$1.shiftPoint(d,r,4*i),u=Detector$1.shiftPoint(o,n,4*s),u=Detector$1.shiftPoint(u,t,4*i),[c,l,d,u]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,r,n,o,i,s){return GridSamplerInstance.getInstance().sampleGrid(e,i,s,.5,.5,i-.5,.5,i-.5,s-.5,.5,s-.5,t.getX(),t.getY(),o.getX(),o.getY(),n.getX(),n.getY(),r.getX(),r.getY())}transitionsBetween(e,t){let r=Math.trunc(e.getX()),n=Math.trunc(e.getY()),o=Math.trunc(t.getX()),i=Math.trunc(t.getY()),s=Math.abs(i-n)>Math.abs(o-r);if(s){let e=r;r=n,n=e,e=o,o=i,i=e}let c=Math.abs(o-r),d=Math.abs(i-n),l=-c/2,u=n<i?1:-1,h=r<o?1:-1,g=0,E=this.image.get(s?n:r,s?r:n);for(let f=r,C=n;f!==o;f+=h){let e=this.image.get(s?C:f,s?f:C);if(e!==E&&(g++,E=e),l+=d,l>0){if(C===i)break;C+=u,l-=c}}return g}}class DataMatrixReader{constructor(){this.decoder=new Decoder$1}decode(e,t=null){let r,n;if(null!=t&&t.has(i.PURE_BARCODE)){const t=DataMatrixReader.extractPureBits(e.getBlackMatrix());r=this.decoder.decode(t),n=DataMatrixReader.NO_POINTS}else{const t=new Detector$1(e.getBlackMatrix()).detect();r=this.decoder.decode(t.getBits()),n=t.getPoints()}const o=r.getRawBytes(),s=new Result(r.getText(),o,8*o.length,n,d.DATA_MATRIX,System.currentTimeMillis()),c=r.getByteSegments();null!=c&&s.putMetadata(C.BYTE_SEGMENTS,c);const l=r.getECLevel();return null!=l&&s.putMetadata(C.ERROR_CORRECTION_LEVEL,l),s}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(null==t||null==r)throw new NotFoundException;const n=this.moduleSize(t,e);let o=t[1];const i=r[1];let s=t[0];const c=(r[0]-s+1)/n,d=(i-o+1)/n;if(c<=0||d<=0)throw new NotFoundException;const l=n/2;o+=l,s+=l;const u=new BitMatrix(c,d);for(let h=0;h<d;h++){const t=o+h*n;for(let r=0;r<c;r++)e.get(s+r*n,t)&&u.set(r,h)}return u}static moduleSize(e,t){const r=t.getWidth();let n=e[0];const o=e[1];for(;n<r&&t.get(n,o);)n++;if(n===r)throw new NotFoundException;const i=n-e[0];if(0===i)throw new NotFoundException;return i}}DataMatrixReader.NO_POINTS=[];class BrowserDatamatrixCodeReader extends BrowserCodeReader{constructor(e=500){super(new DataMatrixReader,e)}}!function(e){e[e.L=0]="L",e[e.M=1]="M",e[e.Q=2]="Q",e[e.H=3]="H"}(h||(h={}));class ErrorCorrectionLevel{constructor(e,t,r){this.value=e,this.stringValue=t,this.bits=r,ErrorCorrectionLevel.FOR_BITS.set(r,this),ErrorCorrectionLevel.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return ErrorCorrectionLevel.L;case"M":return ErrorCorrectionLevel.M;case"Q":return ErrorCorrectionLevel.Q;case"H":return ErrorCorrectionLevel.H;default:throw new ArgumentException(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof ErrorCorrectionLevel))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=ErrorCorrectionLevel.FOR_BITS.size)throw new IllegalArgumentException;return ErrorCorrectionLevel.FOR_BITS.get(e)}}ErrorCorrectionLevel.FOR_BITS=new Map,ErrorCorrectionLevel.FOR_VALUE=new Map,ErrorCorrectionLevel.L=new ErrorCorrectionLevel(h.L,"L",1),ErrorCorrectionLevel.M=new ErrorCorrectionLevel(h.M,"M",0),ErrorCorrectionLevel.Q=new ErrorCorrectionLevel(h.Q,"Q",3),ErrorCorrectionLevel.H=new ErrorCorrectionLevel(h.H,"H",2);class FormatInformation{constructor(e){this.errorCorrectionLevel=ErrorCorrectionLevel.forBits(e>>3&3),this.dataMask=7&e}static numBitsDiffering(e,t){return Integer.bitCount(e^t)}static decodeFormatInformation(e,t){const r=FormatInformation.doDecodeFormatInformation(e,t);return null!==r?r:FormatInformation.doDecodeFormatInformation(e^FormatInformation.FORMAT_INFO_MASK_QR,t^FormatInformation.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let r=Number.MAX_SAFE_INTEGER,n=0;for(const o of FormatInformation.FORMAT_INFO_DECODE_LOOKUP){const i=o[0];if(i===e||i===t)return new FormatInformation(o[1]);let s=FormatInformation.numBitsDiffering(e,i);s<r&&(n=o[1],r=s),e!==t&&(s=FormatInformation.numBitsDiffering(t,i),s<r&&(n=o[1],r=s))}return r<=3?new FormatInformation(n):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof FormatInformation))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}FormatInformation.FORMAT_INFO_MASK_QR=21522,FormatInformation.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ECBlocks$1{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const r of t)e+=r.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class ECB$1{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Version$1{constructor(e,t,...r){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=r;let n=0;const o=r[0].getECCodewordsPerBlock(),i=r[0].getECBlocks();for(const s of i)n+=s.getCount()*(s.getDataCodewords()+o);this.totalCodewords=n}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!=1)throw new FormatException;try{return this.getVersionForNumber((e-17)/4)}catch(t){throw new FormatException}}static getVersionForNumber(e){if(e<1||e>40)throw new IllegalArgumentException;return Version$1.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,r=0;for(let n=0;n<Version$1.VERSION_DECODE_INFO.length;n++){const o=Version$1.VERSION_DECODE_INFO[n];if(o===e)return Version$1.getVersionForNumber(n+7);const i=FormatInformation.numBitsDiffering(e,o);i<t&&(r=n+7,t=i)}return t<=3?Version$1.getVersionForNumber(r):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new BitMatrix(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const r=this.alignmentPatternCenters.length;for(let n=0;n<r;n++){const e=this.alignmentPatternCenters[n]-2;for(let o=0;o<r;o++)0===n&&(0===o||o===r-1)||n===r-1&&0===o||t.setRegion(this.alignmentPatternCenters[o]-2,e,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}Version$1.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Version$1.VERSIONS=[new Version$1(1,new Int32Array(0),new ECBlocks$1(7,new ECB$1(1,19)),new ECBlocks$1(10,new ECB$1(1,16)),new ECBlocks$1(13,new ECB$1(1,13)),new ECBlocks$1(17,new ECB$1(1,9))),new Version$1(2,Int32Array.from([6,18]),new ECBlocks$1(10,new ECB$1(1,34)),new ECBlocks$1(16,new ECB$1(1,28)),new ECBlocks$1(22,new ECB$1(1,22)),new ECBlocks$1(28,new ECB$1(1,16))),new Version$1(3,Int32Array.from([6,22]),new ECBlocks$1(15,new ECB$1(1,55)),new ECBlocks$1(26,new ECB$1(1,44)),new ECBlocks$1(18,new ECB$1(2,17)),new ECBlocks$1(22,new ECB$1(2,13))),new Version$1(4,Int32Array.from([6,26]),new ECBlocks$1(20,new ECB$1(1,80)),new ECBlocks$1(18,new ECB$1(2,32)),new ECBlocks$1(26,new ECB$1(2,24)),new ECBlocks$1(16,new ECB$1(4,9))),new Version$1(5,Int32Array.from([6,30]),new ECBlocks$1(26,new ECB$1(1,108)),new ECBlocks$1(24,new ECB$1(2,43)),new ECBlocks$1(18,new ECB$1(2,15),new ECB$1(2,16)),new ECBlocks$1(22,new ECB$1(2,11),new ECB$1(2,12))),new Version$1(6,Int32Array.from([6,34]),new ECBlocks$1(18,new ECB$1(2,68)),new ECBlocks$1(16,new ECB$1(4,27)),new ECBlocks$1(24,new ECB$1(4,19)),new ECBlocks$1(28,new ECB$1(4,15))),new Version$1(7,Int32Array.from([6,22,38]),new ECBlocks$1(20,new ECB$1(2,78)),new ECBlocks$1(18,new ECB$1(4,31)),new ECBlocks$1(18,new ECB$1(2,14),new ECB$1(4,15)),new ECBlocks$1(26,new ECB$1(4,13),new ECB$1(1,14))),new Version$1(8,Int32Array.from([6,24,42]),new ECBlocks$1(24,new ECB$1(2,97)),new ECBlocks$1(22,new ECB$1(2,38),new ECB$1(2,39)),new ECBlocks$1(22,new ECB$1(4,18),new ECB$1(2,19)),new ECBlocks$1(26,new ECB$1(4,14),new ECB$1(2,15))),new Version$1(9,Int32Array.from([6,26,46]),new ECBlocks$1(30,new ECB$1(2,116)),new ECBlocks$1(22,new ECB$1(3,36),new ECB$1(2,37)),new ECBlocks$1(20,new ECB$1(4,16),new ECB$1(4,17)),new ECBlocks$1(24,new ECB$1(4,12),new ECB$1(4,13))),new Version$1(10,Int32Array.from([6,28,50]),new ECBlocks$1(18,new ECB$1(2,68),new ECB$1(2,69)),new ECBlocks$1(26,new ECB$1(4,43),new ECB$1(1,44)),new ECBlocks$1(24,new ECB$1(6,19),new ECB$1(2,20)),new ECBlocks$1(28,new ECB$1(6,15),new ECB$1(2,16))),new Version$1(11,Int32Array.from([6,30,54]),new ECBlocks$1(20,new ECB$1(4,81)),new ECBlocks$1(30,new ECB$1(1,50),new ECB$1(4,51)),new ECBlocks$1(28,new ECB$1(4,22),new ECB$1(4,23)),new ECBlocks$1(24,new ECB$1(3,12),new ECB$1(8,13))),new Version$1(12,Int32Array.from([6,32,58]),new ECBlocks$1(24,new ECB$1(2,92),new ECB$1(2,93)),new ECBlocks$1(22,new ECB$1(6,36),new ECB$1(2,37)),new ECBlocks$1(26,new ECB$1(4,20),new ECB$1(6,21)),new ECBlocks$1(28,new ECB$1(7,14),new ECB$1(4,15))),new Version$1(13,Int32Array.from([6,34,62]),new ECBlocks$1(26,new ECB$1(4,107)),new ECBlocks$1(22,new ECB$1(8,37),new ECB$1(1,38)),new ECBlocks$1(24,new ECB$1(8,20),new ECB$1(4,21)),new ECBlocks$1(22,new ECB$1(12,11),new ECB$1(4,12))),new Version$1(14,Int32Array.from([6,26,46,66]),new ECBlocks$1(30,new ECB$1(3,115),new ECB$1(1,116)),new ECBlocks$1(24,new ECB$1(4,40),new ECB$1(5,41)),new ECBlocks$1(20,new ECB$1(11,16),new ECB$1(5,17)),new ECBlocks$1(24,new ECB$1(11,12),new ECB$1(5,13))),new Version$1(15,Int32Array.from([6,26,48,70]),new ECBlocks$1(22,new ECB$1(5,87),new ECB$1(1,88)),new ECBlocks$1(24,new ECB$1(5,41),new ECB$1(5,42)),new ECBlocks$1(30,new ECB$1(5,24),new ECB$1(7,25)),new ECBlocks$1(24,new ECB$1(11,12),new ECB$1(7,13))),new Version$1(16,Int32Array.from([6,26,50,74]),new ECBlocks$1(24,new ECB$1(5,98),new ECB$1(1,99)),new ECBlocks$1(28,new ECB$1(7,45),new ECB$1(3,46)),new ECBlocks$1(24,new ECB$1(15,19),new ECB$1(2,20)),new ECBlocks$1(30,new ECB$1(3,15),new ECB$1(13,16))),new Version$1(17,Int32Array.from([6,30,54,78]),new ECBlocks$1(28,new ECB$1(1,107),new ECB$1(5,108)),new ECBlocks$1(28,new ECB$1(10,46),new ECB$1(1,47)),new ECBlocks$1(28,new ECB$1(1,22),new ECB$1(15,23)),new ECBlocks$1(28,new ECB$1(2,14),new ECB$1(17,15))),new Version$1(18,Int32Array.from([6,30,56,82]),new ECBlocks$1(30,new ECB$1(5,120),new ECB$1(1,121)),new ECBlocks$1(26,new ECB$1(9,43),new ECB$1(4,44)),new ECBlocks$1(28,new ECB$1(17,22),new ECB$1(1,23)),new ECBlocks$1(28,new ECB$1(2,14),new ECB$1(19,15))),new Version$1(19,Int32Array.from([6,30,58,86]),new ECBlocks$1(28,new ECB$1(3,113),new ECB$1(4,114)),new ECBlocks$1(26,new ECB$1(3,44),new ECB$1(11,45)),new ECBlocks$1(26,new ECB$1(17,21),new ECB$1(4,22)),new ECBlocks$1(26,new ECB$1(9,13),new ECB$1(16,14))),new Version$1(20,Int32Array.from([6,34,62,90]),new ECBlocks$1(28,new ECB$1(3,107),new ECB$1(5,108)),new ECBlocks$1(26,new ECB$1(3,41),new ECB$1(13,42)),new ECBlocks$1(30,new ECB$1(15,24),new ECB$1(5,25)),new ECBlocks$1(28,new ECB$1(15,15),new ECB$1(10,16))),new Version$1(21,Int32Array.from([6,28,50,72,94]),new ECBlocks$1(28,new ECB$1(4,116),new ECB$1(4,117)),new ECBlocks$1(26,new ECB$1(17,42)),new ECBlocks$1(28,new ECB$1(17,22),new ECB$1(6,23)),new ECBlocks$1(30,new ECB$1(19,16),new ECB$1(6,17))),new Version$1(22,Int32Array.from([6,26,50,74,98]),new ECBlocks$1(28,new ECB$1(2,111),new ECB$1(7,112)),new ECBlocks$1(28,new ECB$1(17,46)),new ECBlocks$1(30,new ECB$1(7,24),new ECB$1(16,25)),new ECBlocks$1(24,new ECB$1(34,13))),new Version$1(23,Int32Array.from([6,30,54,78,102]),new ECBlocks$1(30,new ECB$1(4,121),new ECB$1(5,122)),new ECBlocks$1(28,new ECB$1(4,47),new ECB$1(14,48)),new ECBlocks$1(30,new ECB$1(11,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(16,15),new ECB$1(14,16))),new Version$1(24,Int32Array.from([6,28,54,80,106]),new ECBlocks$1(30,new ECB$1(6,117),new ECB$1(4,118)),new ECBlocks$1(28,new ECB$1(6,45),new ECB$1(14,46)),new ECBlocks$1(30,new ECB$1(11,24),new ECB$1(16,25)),new ECBlocks$1(30,new ECB$1(30,16),new ECB$1(2,17))),new Version$1(25,Int32Array.from([6,32,58,84,110]),new ECBlocks$1(26,new ECB$1(8,106),new ECB$1(4,107)),new ECBlocks$1(28,new ECB$1(8,47),new ECB$1(13,48)),new ECBlocks$1(30,new ECB$1(7,24),new ECB$1(22,25)),new ECBlocks$1(30,new ECB$1(22,15),new ECB$1(13,16))),new Version$1(26,Int32Array.from([6,30,58,86,114]),new ECBlocks$1(28,new ECB$1(10,114),new ECB$1(2,115)),new ECBlocks$1(28,new ECB$1(19,46),new ECB$1(4,47)),new ECBlocks$1(28,new ECB$1(28,22),new ECB$1(6,23)),new ECBlocks$1(30,new ECB$1(33,16),new ECB$1(4,17))),new Version$1(27,Int32Array.from([6,34,62,90,118]),new ECBlocks$1(30,new ECB$1(8,122),new ECB$1(4,123)),new ECBlocks$1(28,new ECB$1(22,45),new ECB$1(3,46)),new ECBlocks$1(30,new ECB$1(8,23),new ECB$1(26,24)),new ECBlocks$1(30,new ECB$1(12,15),new ECB$1(28,16))),new Version$1(28,Int32Array.from([6,26,50,74,98,122]),new ECBlocks$1(30,new ECB$1(3,117),new ECB$1(10,118)),new ECBlocks$1(28,new ECB$1(3,45),new ECB$1(23,46)),new ECBlocks$1(30,new ECB$1(4,24),new ECB$1(31,25)),new ECBlocks$1(30,new ECB$1(11,15),new ECB$1(31,16))),new Version$1(29,Int32Array.from([6,30,54,78,102,126]),new ECBlocks$1(30,new ECB$1(7,116),new ECB$1(7,117)),new ECBlocks$1(28,new ECB$1(21,45),new ECB$1(7,46)),new ECBlocks$1(30,new ECB$1(1,23),new ECB$1(37,24)),new ECBlocks$1(30,new ECB$1(19,15),new ECB$1(26,16))),new Version$1(30,Int32Array.from([6,26,52,78,104,130]),new ECBlocks$1(30,new ECB$1(5,115),new ECB$1(10,116)),new ECBlocks$1(28,new ECB$1(19,47),new ECB$1(10,48)),new ECBlocks$1(30,new ECB$1(15,24),new ECB$1(25,25)),new ECBlocks$1(30,new ECB$1(23,15),new ECB$1(25,16))),new Version$1(31,Int32Array.from([6,30,56,82,108,134]),new ECBlocks$1(30,new ECB$1(13,115),new ECB$1(3,116)),new ECBlocks$1(28,new ECB$1(2,46),new ECB$1(29,47)),new ECBlocks$1(30,new ECB$1(42,24),new ECB$1(1,25)),new ECBlocks$1(30,new ECB$1(23,15),new ECB$1(28,16))),new Version$1(32,Int32Array.from([6,34,60,86,112,138]),new ECBlocks$1(30,new ECB$1(17,115)),new ECBlocks$1(28,new ECB$1(10,46),new ECB$1(23,47)),new ECBlocks$1(30,new ECB$1(10,24),new ECB$1(35,25)),new ECBlocks$1(30,new ECB$1(19,15),new ECB$1(35,16))),new Version$1(33,Int32Array.from([6,30,58,86,114,142]),new ECBlocks$1(30,new ECB$1(17,115),new ECB$1(1,116)),new ECBlocks$1(28,new ECB$1(14,46),new ECB$1(21,47)),new ECBlocks$1(30,new ECB$1(29,24),new ECB$1(19,25)),new ECBlocks$1(30,new ECB$1(11,15),new ECB$1(46,16))),new Version$1(34,Int32Array.from([6,34,62,90,118,146]),new ECBlocks$1(30,new ECB$1(13,115),new ECB$1(6,116)),new ECBlocks$1(28,new ECB$1(14,46),new ECB$1(23,47)),new ECBlocks$1(30,new ECB$1(44,24),new ECB$1(7,25)),new ECBlocks$1(30,new ECB$1(59,16),new ECB$1(1,17))),new Version$1(35,Int32Array.from([6,30,54,78,102,126,150]),new ECBlocks$1(30,new ECB$1(12,121),new ECB$1(7,122)),new ECBlocks$1(28,new ECB$1(12,47),new ECB$1(26,48)),new ECBlocks$1(30,new ECB$1(39,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(22,15),new ECB$1(41,16))),new Version$1(36,Int32Array.from([6,24,50,76,102,128,154]),new ECBlocks$1(30,new ECB$1(6,121),new ECB$1(14,122)),new ECBlocks$1(28,new ECB$1(6,47),new ECB$1(34,48)),new ECBlocks$1(30,new ECB$1(46,24),new ECB$1(10,25)),new ECBlocks$1(30,new ECB$1(2,15),new ECB$1(64,16))),new Version$1(37,Int32Array.from([6,28,54,80,106,132,158]),new ECBlocks$1(30,new ECB$1(17,122),new ECB$1(4,123)),new ECBlocks$1(28,new ECB$1(29,46),new ECB$1(14,47)),new ECBlocks$1(30,new ECB$1(49,24),new ECB$1(10,25)),new ECBlocks$1(30,new ECB$1(24,15),new ECB$1(46,16))),new Version$1(38,Int32Array.from([6,32,58,84,110,136,162]),new ECBlocks$1(30,new ECB$1(4,122),new ECB$1(18,123)),new ECBlocks$1(28,new ECB$1(13,46),new ECB$1(32,47)),new ECBlocks$1(30,new ECB$1(48,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(42,15),new ECB$1(32,16))),new Version$1(39,Int32Array.from([6,26,54,82,110,138,166]),new ECBlocks$1(30,new ECB$1(20,117),new ECB$1(4,118)),new ECBlocks$1(28,new ECB$1(40,47),new ECB$1(7,48)),new ECBlocks$1(30,new ECB$1(43,24),new ECB$1(22,25)),new ECBlocks$1(30,new ECB$1(10,15),new ECB$1(67,16))),new Version$1(40,Int32Array.from([6,30,58,86,114,142,170]),new ECBlocks$1(30,new ECB$1(19,118),new ECB$1(6,119)),new ECBlocks$1(28,new ECB$1(18,47),new ECB$1(31,48)),new ECBlocks$1(30,new ECB$1(34,24),new ECB$1(34,25)),new ECBlocks$1(30,new ECB$1(20,15),new ECB$1(61,16)))],function(e){e[e.DATA_MASK_000=0]="DATA_MASK_000",e[e.DATA_MASK_001=1]="DATA_MASK_001",e[e.DATA_MASK_010=2]="DATA_MASK_010",e[e.DATA_MASK_011=3]="DATA_MASK_011",e[e.DATA_MASK_100=4]="DATA_MASK_100",e[e.DATA_MASK_101=5]="DATA_MASK_101",e[e.DATA_MASK_110=6]="DATA_MASK_110",e[e.DATA_MASK_111=7]="DATA_MASK_111"}(g||(g={}));class DataMask{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let r=0;r<t;r++)for(let n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)}}DataMask.values=new Map([[g.DATA_MASK_000,new DataMask(g.DATA_MASK_000,(e,t)=>!(e+t&1))],[g.DATA_MASK_001,new DataMask(g.DATA_MASK_001,(e,t)=>!(1&e))],[g.DATA_MASK_010,new DataMask(g.DATA_MASK_010,(e,t)=>t%3==0)],[g.DATA_MASK_011,new DataMask(g.DATA_MASK_011,(e,t)=>(e+t)%3==0)],[g.DATA_MASK_100,new DataMask(g.DATA_MASK_100,(e,t)=>!(Math.floor(e/2)+Math.floor(t/3)&1))],[g.DATA_MASK_101,new DataMask(g.DATA_MASK_101,(e,t)=>e*t%6==0)],[g.DATA_MASK_110,new DataMask(g.DATA_MASK_110,(e,t)=>e*t%6<3)],[g.DATA_MASK_111,new DataMask(g.DATA_MASK_111,(e,t)=>!(e+t+e*t%3&1))]]);class BitMatrixParser$1{constructor(e){const t=e.getHeight();if(t<21||1!=(3&t))throw new FormatException;this.bitMatrix=e}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let e=0;for(let o=0;o<6;o++)e=this.copyBit(o,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let o=5;o>=0;o--)e=this.copyBit(8,o,e);const t=this.bitMatrix.getHeight();let r=0;const n=t-7;for(let o=t-1;o>=n;o--)r=this.copyBit(8,o,r);for(let o=t-8;o<t;o++)r=this.copyBit(o,8,r);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(e,r),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new FormatException}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Version$1.getVersionForNumber(t);let r=0;const n=e-11;for(let i=5;i>=0;i--)for(let t=e-9;t>=n;t--)r=this.copyBit(t,i,r);let o=Version$1.decodeVersionInformation(r);if(null!==o&&o.getDimensionForVersion()===e)return this.parsedVersion=o,o;r=0;for(let i=5;i>=0;i--)for(let t=e-9;t>=n;t--)r=this.copyBit(i,t,r);if(o=Version$1.decodeVersionInformation(r),null!==o&&o.getDimensionForVersion()===e)return this.parsedVersion=o,o;throw new FormatException}copyBit(e,t,r){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?r<<1|1:r<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),r=DataMask.values.get(e.getDataMask()),n=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,n);const o=t.buildFunctionPattern();let i=!0;const s=new Uint8Array(t.getTotalCodewords());let c=0,d=0,l=0;for(let u=n-1;u>0;u-=2){6===u&&u--;for(let e=0;e<n;e++){const t=i?n-1-e:e;for(let e=0;e<2;e++)o.get(u-e,t)||(l++,d<<=1,this.bitMatrix.get(u-e,t)&&(d|=1),8===l&&(s[c++]=d,l=0,d=0))}i=!i}if(c!==t.getTotalCodewords())throw new FormatException;return s}remask(){if(null===this.parsedFormatInfo)return;const e=DataMask.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,r=e.getWidth();t<r;t++)for(let n=t+1,o=e.getHeight();n<o;n++)e.get(t,n)!==e.get(n,t)&&(e.flip(n,t),e.flip(t,n))}}class DataBlock$1{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,r){if(e.length!==t.getTotalCodewords())throw new IllegalArgumentException;const n=t.getECBlocksForLevel(r);let o=0;const i=n.getECBlocks();for(const E of i)o+=E.getCount();const s=new Array(o);let c=0;for(const E of i)for(let e=0;e<E.getCount();e++){const e=E.getDataCodewords(),t=n.getECCodewordsPerBlock()+e;s[c++]=new DataBlock$1(e,new Uint8Array(t))}const d=s[0].codewords.length;let l=s.length-1;for(;l>=0&&s[l].codewords.length!==d;)l--;l++;const u=d-n.getECCodewordsPerBlock();let h=0;for(let E=0;E<u;E++)for(let t=0;t<c;t++)s[t].codewords[E]=e[h++];for(let E=l;E<c;E++)s[E].codewords[u]=e[h++];const g=s[0].codewords.length;for(let E=u;E<g;E++)for(let t=0;t<c;t++){const r=t<l?E:E+1;s[t].codewords[r]=e[h++]}return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}!function(e){e[e.TERMINATOR=0]="TERMINATOR",e[e.NUMERIC=1]="NUMERIC",e[e.ALPHANUMERIC=2]="ALPHANUMERIC",e[e.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",e[e.BYTE=4]="BYTE",e[e.ECI=5]="ECI",e[e.KANJI=6]="KANJI",e[e.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",e[e.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",e[e.HANZI=9]="HANZI"}(E||(E={}));class Mode$1{constructor(e,t,r,n){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=r,this.bits=n,Mode$1.FOR_BITS.set(n,this),Mode$1.FOR_VALUE.set(e,this)}static forBits(e){const t=Mode$1.FOR_BITS.get(e);if(void 0===t)throw new IllegalArgumentException;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let r;return r=t<=9?0:t<=26?1:2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof Mode$1))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}Mode$1.FOR_BITS=new Map,Mode$1.FOR_VALUE=new Map,Mode$1.TERMINATOR=new Mode$1(E.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Mode$1.NUMERIC=new Mode$1(E.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Mode$1.ALPHANUMERIC=new Mode$1(E.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Mode$1.STRUCTURED_APPEND=new Mode$1(E.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Mode$1.BYTE=new Mode$1(E.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Mode$1.ECI=new Mode$1(E.ECI,"ECI",Int32Array.from([0,0,0]),7),Mode$1.KANJI=new Mode$1(E.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Mode$1.FNC1_FIRST_POSITION=new Mode$1(E.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Mode$1.FNC1_SECOND_POSITION=new Mode$1(E.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Mode$1.HANZI=new Mode$1(E.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class DecodedBitStreamParser$1{static decode(e,t,r,n){const o=new BitSource(e);let i=new StringBuilder;const s=new Array;let c=-1,d=-1;try{let e,r=null,l=!1;do{if(o.available()<4)e=Mode$1.TERMINATOR;else{const t=o.readBits(4);e=Mode$1.forBits(t)}switch(e){case Mode$1.TERMINATOR:break;case Mode$1.FNC1_FIRST_POSITION:case Mode$1.FNC1_SECOND_POSITION:l=!0;break;case Mode$1.STRUCTURED_APPEND:if(o.available()<16)throw new FormatException;c=o.readBits(8),d=o.readBits(8);break;case Mode$1.ECI:const u=DecodedBitStreamParser$1.parseECIValue(o);if(r=CharacterSetECI.getCharacterSetECIByValue(u),null===r)throw new FormatException;break;case Mode$1.HANZI:const h=o.readBits(4),g=o.readBits(e.getCharacterCountBits(t));h===DecodedBitStreamParser$1.GB2312_SUBSET&&DecodedBitStreamParser$1.decodeHanziSegment(o,i,g);break;default:const E=o.readBits(e.getCharacterCountBits(t));switch(e){case Mode$1.NUMERIC:DecodedBitStreamParser$1.decodeNumericSegment(o,i,E);break;case Mode$1.ALPHANUMERIC:DecodedBitStreamParser$1.decodeAlphanumericSegment(o,i,E,l);break;case Mode$1.BYTE:DecodedBitStreamParser$1.decodeByteSegment(o,i,E,r,s,n);break;case Mode$1.KANJI:DecodedBitStreamParser$1.decodeKanjiSegment(o,i,E);break;default:throw new FormatException}}}while(e!==Mode$1.TERMINATOR)}catch(l){throw new FormatException}return new DecoderResult(e,i.toString(),0===s.length?null:s,null===r?null:r.toString(),c,d)}static decodeHanziSegment(e,t,r){if(13*r>e.available())throw new FormatException;const n=new Uint8Array(2*r);let o=0;for(;r>0;){const t=e.readBits(13);let i=t/96<<8&4294967295|t%96;i+=i<959?41377:42657,n[o]=i>>8&255,n[o+1]=255&i,o+=2,r--}try{t.append(StringEncoding.decode(n,StringUtils.GB2312))}catch(i){throw new FormatException(i)}}static decodeKanjiSegment(e,t,r){if(13*r>e.available())throw new FormatException;const n=new Uint8Array(2*r);let o=0;for(;r>0;){const t=e.readBits(13);let i=t/192<<8&4294967295|t%192;i+=i<7936?33088:49472,n[o]=i>>8,n[o+1]=i,o+=2,r--}try{t.append(StringEncoding.decode(n,StringUtils.SHIFT_JIS))}catch(i){throw new FormatException(i)}}static decodeByteSegment(e,t,r,n,o,i){if(8*r>e.available())throw new FormatException;const s=new Uint8Array(r);for(let l=0;l<r;l++)s[l]=e.readBits(8);let c;c=null===n?StringUtils.guessEncoding(s,i):n.getName();try{t.append(StringEncoding.decode(s,c))}catch(d){throw new FormatException(d)}o.push(s)}static toAlphaNumericChar(e){if(e>=DecodedBitStreamParser$1.ALPHANUMERIC_CHARS.length)throw new FormatException;return DecodedBitStreamParser$1.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,r,n){const start=t.length();for(;r>1;){if(e.available()<11)throw new FormatException;const n=e.readBits(11);t.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(n/45))),t.append(DecodedBitStreamParser$1.toAlphaNumericChar(n%45)),r-=2}if(1===r){if(e.available()<6)throw new FormatException;t.append(DecodedBitStreamParser$1.toAlphaNumericChar(e.readBits(6)))}if(n)for(let o=start;o<t.length();o++)"%"===t.charAt(o)&&(o<t.length()-1&&"%"===t.charAt(o+1)?t.deleteCharAt(o+1):t.setCharAt(o,String.fromCharCode(29)))}static decodeNumericSegment(e,t,r){for(;r>=3;){if(e.available()<10)throw new FormatException;const n=e.readBits(10);if(n>=1e3)throw new FormatException;t.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(n/100))),t.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(n/10)%10)),t.append(DecodedBitStreamParser$1.toAlphaNumericChar(n%10)),r-=3}if(2===r){if(e.available()<7)throw new FormatException;const r=e.readBits(7);if(r>=100)throw new FormatException;t.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(r/10))),t.append(DecodedBitStreamParser$1.toAlphaNumericChar(r%10))}else if(1===r){if(e.available()<4)throw new FormatException;const r=e.readBits(4);if(r>=10)throw new FormatException;t.append(DecodedBitStreamParser$1.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if(!(128&t))return 127&t;if(128==(192&t))return(63&t)<<8&4294967295|e.readBits(8);if(192==(224&t))return(31&t)<<16&4294967295|e.readBits(16);throw new FormatException}}DecodedBitStreamParser$1.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",DecodedBitStreamParser$1.GB2312_SUBSET=1;class QRCodeDecoderMetaData{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||null===e||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Decoder$2{constructor(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(BitMatrix.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const r=new BitMatrixParser$1(e);let n=null;try{return this.decodeBitMatrixParser(r,t)}catch(o){n=o}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const e=this.decodeBitMatrixParser(r,t);return e.setOther(new QRCodeDecoderMetaData(!0)),e}catch(o){if(null!==n)throw n;throw o}}decodeBitMatrixParser(e,t){const r=e.readVersion(),n=e.readFormatInformation().getErrorCorrectionLevel(),o=e.readCodewords(),i=DataBlock$1.getDataBlocks(o,r,n);let s=0;for(const l of i)s+=l.getNumDataCodewords();const c=new Uint8Array(s);let d=0;for(const l of i){const e=l.getCodewords(),t=l.getNumDataCodewords();this.correctErrors(e,t);for(let r=0;r<t;r++)c[d++]=e[r]}return DecodedBitStreamParser$1.decode(c,r,n,t)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch(n){throw new ChecksumException}for(let o=0;o<t;o++)e[o]=r[o]}}class AlignmentPattern extends ResultPoint{constructor(e,t,r){super(e,t),this.estimatedModuleSize=r}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const n=(this.getX()+t)/2,o=(this.getY()+e)/2,i=(this.estimatedModuleSize+r)/2;return new AlignmentPattern(n,o,i)}}class AlignmentPatternFinder{constructor(e,t,r,n,o,i,s){this.image=e,this.startX=t,this.startY=r,this.width=n,this.height=o,this.moduleSize=i,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,r=e+this.width,n=this.startY+t/2,o=new Int32Array(3),i=this.image;for(let s=0;s<t;s++){const t=n+(1&s?-Math.floor((s+1)/2):Math.floor((s+1)/2));o[0]=0,o[1]=0,o[2]=0;let c=e;for(;c<r&&!i.get(c,t);)c++;let d=0;for(;c<r;){if(i.get(c,t))if(1===d)o[1]++;else if(2===d){if(this.foundPatternCross(o)){const e=this.handlePossibleCenter(o,t,c);if(null!==e)return e}o[0]=o[2],o[1]=1,o[2]=0,d=1}else o[++d]++;else 1===d&&d++,o[d]++;c++}if(this.foundPatternCross(o)){const e=this.handlePossibleCenter(o,t,r);if(null!==e)return e}}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new NotFoundException}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,r=t/2;for(let n=0;n<3;n++)if(Math.abs(t-e[n])>=r)return!1;return!0}crossCheckVertical(e,t,r,n){const o=this.image,i=o.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;let c=e;for(;c>=0&&o.get(t,c)&&s[1]<=r;)s[1]++,c--;if(c<0||s[1]>r)return NaN;for(;c>=0&&!o.get(t,c)&&s[0]<=r;)s[0]++,c--;if(s[0]>r)return NaN;for(c=e+1;c<i&&o.get(t,c)&&s[1]<=r;)s[1]++,c++;if(c===i||s[1]>r)return NaN;for(;c<i&&!o.get(t,c)&&s[2]<=r;)s[2]++,c++;if(s[2]>r)return NaN;const d=s[0]+s[1]+s[2];return 5*Math.abs(d-n)>=2*n?NaN:this.foundPatternCross(s)?AlignmentPatternFinder.centerFromEnd(s,c):NaN}handlePossibleCenter(e,t,r){const n=e[0]+e[1]+e[2],o=AlignmentPatternFinder.centerFromEnd(e,r),i=this.crossCheckVertical(t,o,2*e[1],n);if(!isNaN(i)){const t=(e[0]+e[1]+e[2])/3;for(const e of this.possibleCenters)if(e.aboutEquals(t,i,o))return e.combineEstimate(i,o,t);const r=new AlignmentPattern(o,i,t);this.possibleCenters.push(r),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(r)}return null}}class FinderPattern$1 extends ResultPoint{constructor(e,t,r,n){super(e,t),this.estimatedModuleSize=r,this.count=n,void 0===n&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const n=this.count+1,o=(this.count*this.getX()+t)/n,i=(this.count*this.getY()+e)/n,s=(this.count*this.estimatedModuleSize+r)/n;return new FinderPattern$1(o,i,s,n)}}class FinderPatternInfo{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class FinderPatternFinder{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=null!=e&&void 0!==e.get(i.TRY_HARDER),r=null!=e&&void 0!==e.get(i.PURE_BARCODE),n=this.image,o=n.getHeight(),s=n.getWidth();let c=Math.floor(3*o/(4*FinderPatternFinder.MAX_MODULES));(c<FinderPatternFinder.MIN_SKIP||t)&&(c=FinderPatternFinder.MIN_SKIP);let d=!1;const l=new Int32Array(5);for(let i=c-1;i<o&&!d;i+=c){l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0;let e=0;for(let t=0;t<s;t++)if(n.get(t,i))1&~e||e++,l[e]++;else if(1&e)l[e]++;else if(4===e)if(FinderPatternFinder.foundPatternCross(l)){if(!0!==this.handlePossibleCenter(l,i,t,r)){l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,e=3;continue}if(c=2,!0===this.hasSkipped)d=this.haveMultiplyConfirmedCenters();else{const e=this.findRowSkip();e>l[2]&&(i+=e-l[2]-c,t=s-1)}e=0,l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0}else l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,e=3;else l[++e]++;FinderPatternFinder.foundPatternCross(l)&&!0===this.handlePossibleCenter(l,i,s,r)&&(c=l[0],this.hasSkipped&&(d=this.haveMultiplyConfirmedCenters()))}const u=this.selectBestPatterns();return ResultPoint.orderBestPatterns(u),new FinderPatternInfo(u)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let o=0;o<5;o++){const r=e[o];if(0===r)return!1;t+=r}if(t<7)return!1;const r=t/7,n=r/2;return Math.abs(r-e[0])<n&&Math.abs(r-e[1])<n&&Math.abs(3*r-e[2])<3*n&&Math.abs(r-e[3])<n&&Math.abs(r-e[4])<n}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,r,n){const o=this.getCrossCheckStateCount();let i=0;const s=this.image;for(;e>=i&&t>=i&&s.get(t-i,e-i);)o[2]++,i++;if(e<i||t<i)return!1;for(;e>=i&&t>=i&&!s.get(t-i,e-i)&&o[1]<=r;)o[1]++,i++;if(e<i||t<i||o[1]>r)return!1;for(;e>=i&&t>=i&&s.get(t-i,e-i)&&o[0]<=r;)o[0]++,i++;if(o[0]>r)return!1;const c=s.getHeight(),d=s.getWidth();for(i=1;e+i<c&&t+i<d&&s.get(t+i,e+i);)o[2]++,i++;if(e+i>=c||t+i>=d)return!1;for(;e+i<c&&t+i<d&&!s.get(t+i,e+i)&&o[3]<r;)o[3]++,i++;if(e+i>=c||t+i>=d||o[3]>=r)return!1;for(;e+i<c&&t+i<d&&s.get(t+i,e+i)&&o[4]<r;)o[4]++,i++;if(o[4]>=r)return!1;const l=o[0]+o[1]+o[2]+o[3]+o[4];return Math.abs(l-n)<2*n&&FinderPatternFinder.foundPatternCross(o)}crossCheckVertical(e,t,r,n){const o=this.image,i=o.getHeight(),s=this.getCrossCheckStateCount();let c=e;for(;c>=0&&o.get(t,c);)s[2]++,c--;if(c<0)return NaN;for(;c>=0&&!o.get(t,c)&&s[1]<=r;)s[1]++,c--;if(c<0||s[1]>r)return NaN;for(;c>=0&&o.get(t,c)&&s[0]<=r;)s[0]++,c--;if(s[0]>r)return NaN;for(c=e+1;c<i&&o.get(t,c);)s[2]++,c++;if(c===i)return NaN;for(;c<i&&!o.get(t,c)&&s[3]<r;)s[3]++,c++;if(c===i||s[3]>=r)return NaN;for(;c<i&&o.get(t,c)&&s[4]<r;)s[4]++,c++;if(s[4]>=r)return NaN;const d=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(d-n)>=2*n?NaN:FinderPatternFinder.foundPatternCross(s)?FinderPatternFinder.centerFromEnd(s,c):NaN}crossCheckHorizontal(e,t,r,n){const o=this.image,i=o.getWidth(),s=this.getCrossCheckStateCount();let c=e;for(;c>=0&&o.get(c,t);)s[2]++,c--;if(c<0)return NaN;for(;c>=0&&!o.get(c,t)&&s[1]<=r;)s[1]++,c--;if(c<0||s[1]>r)return NaN;for(;c>=0&&o.get(c,t)&&s[0]<=r;)s[0]++,c--;if(s[0]>r)return NaN;for(c=e+1;c<i&&o.get(c,t);)s[2]++,c++;if(c===i)return NaN;for(;c<i&&!o.get(c,t)&&s[3]<r;)s[3]++,c++;if(c===i||s[3]>=r)return NaN;for(;c<i&&o.get(c,t)&&s[4]<r;)s[4]++,c++;if(s[4]>=r)return NaN;const d=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(d-n)>=n?NaN:FinderPatternFinder.foundPatternCross(s)?FinderPatternFinder.centerFromEnd(s,c):NaN}handlePossibleCenter(e,t,r,n){const o=e[0]+e[1]+e[2]+e[3]+e[4];let i=FinderPatternFinder.centerFromEnd(e,r),s=this.crossCheckVertical(t,Math.floor(i),e[2],o);if(!isNaN(s)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(s),e[2],o),!isNaN(i)&&(!n||this.crossCheckDiagonal(Math.floor(s),Math.floor(i),e[2],o)))){const e=o/7;let t=!1;const r=this.possibleCenters;for(let n=0,o=r.length;n<o;n++){const o=r[n];if(o.aboutEquals(e,s,i)){r[n]=o.combineEstimate(s,i,e),t=!0;break}}if(!t){const t=new FinderPattern$1(i,s,e);r.push(t),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(t)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let e=null;for(const t of this.possibleCenters)if(t.getCount()>=FinderPatternFinder.CENTER_QUORUM){if(null!=e)return this.hasSkipped=!0,Math.floor((Math.abs(e.getX()-t.getX())-Math.abs(e.getY()-t.getY()))/2);e=t}return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const r=this.possibleCenters.length;for(const i of this.possibleCenters)i.getCount()>=FinderPatternFinder.CENTER_QUORUM&&(e++,t+=i.getEstimatedModuleSize());if(e<3)return!1;const n=t/r;let o=0;for(const i of this.possibleCenters)o+=Math.abs(i.getEstimatedModuleSize()-n);return o<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new NotFoundException;const t=this.possibleCenters;let r;if(e>3){let n=0,o=0;for(const e of this.possibleCenters){const t=e.getEstimatedModuleSize();n+=t,o+=t*t}r=n/e;let i=Math.sqrt(o/e-r*r);t.sort((e,t)=>{const n=Math.abs(t.getEstimatedModuleSize()-r),o=Math.abs(e.getEstimatedModuleSize()-r);return n<o?-1:n>o?1:0});const s=Math.max(.2*r,i);for(let e=0;e<t.length&&t.length>3;e++){const n=t[e];Math.abs(n.getEstimatedModuleSize()-r)>s&&(t.splice(e,1),e--)}}if(t.length>3){let e=0;for(const r of t)e+=r.getEstimatedModuleSize();r=e/t.length,t.sort((e,t)=>{if(t.getCount()===e.getCount()){const n=Math.abs(t.getEstimatedModuleSize()-r),o=Math.abs(e.getEstimatedModuleSize()-r);return n<o?1:n>o?-1:0}return t.getCount()-e.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}FinderPatternFinder.CENTER_QUORUM=2,FinderPatternFinder.MIN_SKIP=3,FinderPatternFinder.MAX_MODULES=57;class Detector$2{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=null==e?null:e.get(i.NEED_RESULT_POINT_CALLBACK);const t=new FinderPatternFinder(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(t)}processFinderPatternInfo(e){const t=e.getTopLeft(),r=e.getTopRight(),n=e.getBottomLeft(),o=this.calculateModuleSize(t,r,n);if(o<1)throw new NotFoundException("No pattern found in proccess finder.");const i=Detector$2.computeDimension(t,r,n,o),s=Version$1.getProvisionalVersionForDimension(i),c=s.getDimensionForVersion()-7;let d=null;if(s.getAlignmentPatternCenters().length>0){const e=r.getX()-t.getX()+n.getX(),i=r.getY()-t.getY()+n.getY(),s=1-3/c,l=Math.floor(t.getX()+s*(e-t.getX())),u=Math.floor(t.getY()+s*(i-t.getY()));for(let t=4;t<=16;t<<=1)try{d=this.findAlignmentInRegion(o,l,u,t);break}catch(g){if(!(g instanceof NotFoundException))throw g}}const l=Detector$2.createTransform(t,r,n,d,i),u=Detector$2.sampleGrid(this.image,l,i);let h;return h=null===d?[n,t,r]:[n,t,r,d],new DetectorResult(u,h)}static createTransform(e,t,r,n,o){const i=o-3.5;let s,c,d,l;return null!==n?(s=n.getX(),c=n.getY(),d=i-3,l=d):(s=t.getX()-e.getX()+r.getX(),c=t.getY()-e.getY()+r.getY(),d=i,l=i),PerspectiveTransform.quadrilateralToQuadrilateral(3.5,3.5,i,3.5,d,l,3.5,i,e.getX(),e.getY(),t.getX(),t.getY(),s,c,r.getX(),r.getY())}static sampleGrid(e,t,r){return GridSamplerInstance.getInstance().sampleGridWithTransform(e,r,r,t)}static computeDimension(e,t,r,n){const o=MathUtils.round(ResultPoint.distance(e,t)/n),i=MathUtils.round(ResultPoint.distance(e,r)/n);let s=Math.floor((o+i)/2)+7;switch(3&s){case 0:s++;break;case 2:s--;break;case 3:throw new NotFoundException("Dimensions could be not found.")}return s}calculateModuleSize(e,t,r){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,r))/2}calculateModuleSizeOneWay(e,t){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(r)?n/7:isNaN(n)?r/7:(r+n)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,r,n){let o=this.sizeOfBlackWhiteBlackRun(e,t,r,n),i=1,s=e-(r-e);s<0?(i=e/(e-s),s=0):s>=this.image.getWidth()&&(i=(this.image.getWidth()-1-e)/(s-e),s=this.image.getWidth()-1);let c=Math.floor(t-(n-t)*i);return i=1,c<0?(i=t/(t-c),c=0):c>=this.image.getHeight()&&(i=(this.image.getHeight()-1-t)/(c-t),c=this.image.getHeight()-1),s=Math.floor(e+(s-e)*i),o+=this.sizeOfBlackWhiteBlackRun(e,t,s,c),o-1}sizeOfBlackWhiteBlackRun(e,t,r,n){const o=Math.abs(n-t)>Math.abs(r-e);if(o){let o=e;e=t,t=o,o=r,r=n,n=o}const i=Math.abs(r-e),s=Math.abs(n-t);let c=-i/2;const d=e<r?1:-1,l=t<n?1:-1;let u=0;const h=r+d;for(let g=e,E=t;g!==h;g+=d){const r=o?E:g,d=o?g:E;if(1===u===this.image.get(r,d)){if(2===u)return MathUtils.distance(g,E,e,t);u++}if(c+=s,c>0){if(E===n)break;E+=l,c-=i}}return 2===u?MathUtils.distance(r+d,n,e,t):NaN}findAlignmentInRegion(e,t,r,n){const o=Math.floor(n*e),i=Math.max(0,t-o),s=Math.min(this.image.getWidth()-1,t+o);if(s-i<3*e)throw new NotFoundException("Alignment top exceeds estimated module size.");const c=Math.max(0,r-o),d=Math.min(this.image.getHeight()-1,r+o);if(d-c<3*e)throw new NotFoundException("Alignment bottom exceeds estimated module size.");return new AlignmentPatternFinder(this.image,i,c,s-i,d-c,e,this.resultPointCallback).find()}}class QRCodeReader{constructor(){this.decoder=new Decoder$2}getDecoder(){return this.decoder}decode(e,t){let r,n;if(null!=t&&void 0!==t.get(i.PURE_BARCODE)){const o=QRCodeReader.extractPureBits(e.getBlackMatrix());r=this.decoder.decodeBitMatrix(o,t),n=QRCodeReader.NO_POINTS}else{const o=new Detector$2(e.getBlackMatrix()).detect(t);r=this.decoder.decodeBitMatrix(o.getBits(),t),n=o.getPoints()}r.getOther()instanceof QRCodeDecoderMetaData&&r.getOther().applyMirroredCorrection(n);const o=new Result(r.getText(),r.getRawBytes(),void 0,n,d.QR_CODE,void 0),s=r.getByteSegments();null!==s&&o.putMetadata(C.BYTE_SEGMENTS,s);const c=r.getECLevel();return null!==c&&o.putMetadata(C.ERROR_CORRECTION_LEVEL,c),r.hasStructuredAppend()&&(o.putMetadata(C.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),o.putMetadata(C.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),o}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(null===t||null===r)throw new NotFoundException;const n=this.moduleSize(t,e);let o=t[1],i=r[1],s=t[0],c=r[0];if(s>=c||o>=i)throw new NotFoundException;if(i-o!==c-s&&(c=s+(i-o),c>=e.getWidth()))throw new NotFoundException;const d=Math.round((c-s+1)/n),l=Math.round((i-o+1)/n);if(d<=0||l<=0)throw new NotFoundException;if(l!==d)throw new NotFoundException;const u=Math.floor(n/2);o+=u,s+=u;const h=s+Math.floor((d-1)*n)-c;if(h>0){if(h>u)throw new NotFoundException;s-=h}const g=o+Math.floor((l-1)*n)-i;if(g>0){if(g>u)throw new NotFoundException;o-=g}const E=new BitMatrix(d,l);for(let f=0;f<l;f++){const t=o+Math.floor(f*n);for(let r=0;r<d;r++)e.get(s+Math.floor(r*n),t)&&E.set(r,f)}return E}static moduleSize(e,t){const r=t.getHeight(),n=t.getWidth();let o=e[0],i=e[1],s=!0,c=0;for(;o<n&&i<r;){if(s!==t.get(o,i)){if(5===++c)break;s=!s}o++,i++}if(o===n||i===r)throw new NotFoundException;return(o-e[0])/7}}QRCodeReader.NO_POINTS=new Array;class PDF417Common{PDF417Common(){}static getBitCountSum(e){return MathUtils.sum(e)}static toIntArray(e){if(null==e||!e.length)return PDF417Common.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let r=0;for(const n of e)t[r++]=n;return t}static getCodeword(e){const t=Arrays.binarySearch(PDF417Common.SYMBOL_TABLE,262143&e);return t<0?-1:(PDF417Common.CODEWORD_TABLE[t]-1)%PDF417Common.NUMBER_OF_CODEWORDS}}PDF417Common.NUMBER_OF_CODEWORDS=929,PDF417Common.MAX_CODEWORDS_IN_BARCODE=PDF417Common.NUMBER_OF_CODEWORDS-1,PDF417Common.MIN_ROWS_IN_BARCODE=3,PDF417Common.MAX_ROWS_IN_BARCODE=90,PDF417Common.MODULES_IN_CODEWORD=17,PDF417Common.MODULES_IN_STOP_PATTERN=18,PDF417Common.BARS_IN_MODULE=8,PDF417Common.EMPTY_INT_ARRAY=new Int32Array([]),PDF417Common.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),PDF417Common.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class PDF417DetectorResult{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Detector$3{static detectMultiple(e,t,r){let n=e.getBlackMatrix(),o=Detector$3.detect(r,n);return o.length||(n=n.clone(),n.rotate180(),o=Detector$3.detect(r,n)),new PDF417DetectorResult(n,o)}static detect(e,t){const r=new Array;let n=0,o=0,i=!1;for(;n<t.getHeight();){const s=Detector$3.findVertices(t,n,o);if(null!=s[0]||null!=s[3]){if(i=!0,r.push(s),!e)break;null!=s[2]?(o=Math.trunc(s[2].getX()),n=Math.trunc(s[2].getY())):(o=Math.trunc(s[4].getX()),n=Math.trunc(s[4].getY()))}else{if(!i)break;i=!1,o=0;for(const e of r)null!=e[1]&&(n=Math.trunc(Math.max(n,e[1].getY()))),null!=e[3]&&(n=Math.max(n,Math.trunc(e[3].getY())));n+=Detector$3.ROW_STEP}}return r}static findVertices(e,t,r){const n=e.getHeight(),o=e.getWidth(),i=new Array(8);return Detector$3.copyToResult(i,Detector$3.findRowsWithPattern(e,n,o,t,r,Detector$3.START_PATTERN),Detector$3.INDEXES_START_PATTERN),null!=i[4]&&(r=Math.trunc(i[4].getX()),t=Math.trunc(i[4].getY())),Detector$3.copyToResult(i,Detector$3.findRowsWithPattern(e,n,o,t,r,Detector$3.STOP_PATTERN),Detector$3.INDEXES_STOP_PATTERN),i}static copyToResult(e,t,r){for(let n=0;n<r.length;n++)e[r[n]]=t[n]}static findRowsWithPattern(e,t,r,n,o,i){const s=new Array(4);let c=!1;const d=new Int32Array(i.length);for(;n<t;n+=Detector$3.ROW_STEP){let t=Detector$3.findGuardPattern(e,o,n,r,!1,i,d);if(null!=t){for(;n>0;){const s=Detector$3.findGuardPattern(e,o,--n,r,!1,i,d);if(null==s){n++;break}t=s}s[0]=new ResultPoint(t[0],n),s[1]=new ResultPoint(t[1],n),c=!0;break}}let l=n+1;if(c){let n=0,o=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);for(;l<t;l++){const t=Detector$3.findGuardPattern(e,o[0],l,r,!1,i,d);if(null!=t&&Math.abs(o[0]-t[0])<Detector$3.MAX_PATTERN_DRIFT&&Math.abs(o[1]-t[1])<Detector$3.MAX_PATTERN_DRIFT)o=t,n=0;else{if(n>Detector$3.SKIPPED_ROW_COUNT_MAX)break;n++}}l-=n+1,s[2]=new ResultPoint(o[0],l),s[3]=new ResultPoint(o[1],l)}return l-n<Detector$3.BARCODE_MIN_HEIGHT&&Arrays.fill(s,null),s}static findGuardPattern(e,t,r,n,o,i,s){Arrays.fillWithin(s,0,s.length,0);let c=t,d=0;for(;e.get(c,r)&&c>0&&d++<Detector$3.MAX_PIXEL_DRIFT;)c--;let l=c,u=0,h=i.length;for(let g=o;l<n;l++)if(e.get(l,r)!==g)s[u]++;else{if(u===h-1){if(Detector$3.patternMatchVariance(s,i,Detector$3.MAX_INDIVIDUAL_VARIANCE)<Detector$3.MAX_AVG_VARIANCE)return new Int32Array([c,l]);c+=s[0]+s[1],System.arraycopy(s,2,s,0,u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,g=!g}return u===h-1&&Detector$3.patternMatchVariance(s,i,Detector$3.MAX_INDIVIDUAL_VARIANCE)<Detector$3.MAX_AVG_VARIANCE?new Int32Array([c,l-1]):null}static patternMatchVariance(e,t,r){let n=e.length,o=0,i=0;for(let d=0;d<n;d++)o+=e[d],i+=t[d];if(o<i)return 1/0;let s=o/i;r*=s;let c=0;for(let d=0;d<n;d++){let n=e[d],o=t[d]*s,i=n>o?n-o:o-n;if(i>r)return 1/0;c+=i}return c/o}}Detector$3.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Detector$3.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Detector$3.MAX_AVG_VARIANCE=.42,Detector$3.MAX_INDIVIDUAL_VARIANCE=.8,Detector$3.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Detector$3.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Detector$3.MAX_PIXEL_DRIFT=3,Detector$3.MAX_PATTERN_DRIFT=5,Detector$3.SKIPPED_ROW_COUNT_MAX=25,Detector$3.ROW_STEP=5,Detector$3.BARCODE_MIN_HEIGHT=10;class ModulusPoly{constructor(e,t){if(0===t.length)throw new IllegalArgumentException;this.field=e;let r=t.length;if(r>1&&0===t[0]){let e=1;for(;e<r&&0===t[e];)e++;e===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-e),System.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);if(1===e){let e=0;for(let t of this.coefficients)e=this.field.add(e,t);return e}let t=this.coefficients[0],r=this.coefficients.length;for(let n=1;n<r;n++)t=this.field.add(this.field.multiply(e,t),this.coefficients[n]);return t}add(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){let e=t;t=r,r=e}let n=new Int32Array(r.length),o=r.length-t.length;System.arraycopy(r,0,n,0,o);for(let i=o;i<r.length;i++)n[i]=this.field.add(t[i-o],r[i]);return new ModulusPoly(this.field,n)}subtract(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof ModulusPoly?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new ModulusPoly(this.field,new Int32Array([0]));let t=this.coefficients,r=t.length,n=e.coefficients,o=n.length,i=new Int32Array(r+o-1);for(let s=0;s<r;s++){let e=t[s];for(let t=0;t<o;t++)i[s+t]=this.field.add(i[s+t],this.field.multiply(e,n[t]))}return new ModulusPoly(this.field,i)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=this.field.subtract(0,this.coefficients[r]);return new ModulusPoly(this.field,t)}multiplyScalar(e){if(0===e)return new ModulusPoly(this.field,new Int32Array([0]));if(1===e)return this;let t=this.coefficients.length,r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=this.field.multiply(this.coefficients[n],e);return new ModulusPoly(this.field,r)}multiplyByMonomial(e,t){if(e<0)throw new IllegalArgumentException;if(0===t)return new ModulusPoly(this.field,new Int32Array([0]));let r=this.coefficients.length,n=new Int32Array(r+e);for(let o=0;o<r;o++)n[o]=this.field.multiply(this.coefficients[o],t);return new ModulusPoly(this.field,n)}toString(){let e=new StringBuilder;for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);0!==r&&(r<0?(e.append(" - "),r=-r):e.length()>0&&e.append(" + "),0!==t&&1===r||e.append(r),0!==t&&(1===t?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class ModulusBase{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(0===e)throw new IllegalArgumentException;return this.logTable[e]}inverse(e){if(0===e)throw new ArithmeticException;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class ModulusGF extends ModulusBase{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let r=1;for(let n=0;n<e;n++)this.expTable[n]=r,r=r*t%e;for(let n=0;n<e-1;n++)this.logTable[this.expTable[n]]=n;this.zero=new ModulusPoly(this,new Int32Array([0])),this.one=new ModulusPoly(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new IllegalArgumentException;if(0===t)return this.zero;let r=new Int32Array(e+1);return r[0]=t,new ModulusPoly(this,r)}}ModulusGF.PDF417_GF=new ModulusGF(PDF417Common.NUMBER_OF_CODEWORDS,3);class ErrorCorrection{constructor(){this.field=ModulusGF.PDF417_GF}decode(e,t,r){let n=new ModulusPoly(this.field,e),o=new Int32Array(t),i=!1;for(let E=t;E>0;E--){let e=n.evaluateAt(this.field.exp(E));o[t-E]=e,0!==e&&(i=!0)}if(!i)return 0;let s=this.field.getOne();if(null!=r)for(const E of r){let t=this.field.exp(e.length-1-E),r=new ModulusPoly(this.field,new Int32Array([this.field.subtract(0,t),1]));s=s.multiply(r)}let c=new ModulusPoly(this.field,o),d=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),c,t),l=d[0],u=d[1],h=this.findErrorLocations(l),g=this.findErrorMagnitudes(u,l,h);for(let E=0;E<h.length;E++){let t=e.length-1-this.field.log(h[E]);if(t<0)throw ChecksumException.getChecksumInstance();e[t]=this.field.subtract(e[t],g[E])}return h.length}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){let r=e;e=t,t=r}let n=e,o=t,i=this.field.getZero(),s=this.field.getOne();for(;o.getDegree()>=Math.round(r/2);){let e=n,t=i;if(n=o,i=s,n.isZero())throw ChecksumException.getChecksumInstance();o=e;let r=this.field.getZero(),c=n.getCoefficient(n.getDegree()),d=this.field.inverse(c);for(;o.getDegree()>=n.getDegree()&&!o.isZero();){let e=o.getDegree()-n.getDegree(),t=this.field.multiply(o.getCoefficient(o.getDegree()),d);r=r.add(this.field.buildMonomial(e,t)),o=o.subtract(n.multiplyByMonomial(e,t))}s=r.multiply(i).subtract(t).negative()}let c=s.getCoefficient(0);if(0===c)throw ChecksumException.getChecksumInstance();let d=this.field.inverse(c);return[s.multiply(d),o.multiply(d)]}findErrorLocations(e){let t=e.getDegree(),r=new Int32Array(t),n=0;for(let o=1;o<this.field.getSize()&&n<t;o++)0===e.evaluateAt(o)&&(r[n]=this.field.inverse(o),n++);if(n!==t)throw ChecksumException.getChecksumInstance();return r}findErrorMagnitudes(e,t,r){let n=t.getDegree(),o=new Int32Array(n);for(let d=1;d<=n;d++)o[n-d]=this.field.multiply(d,t.getCoefficient(d));let i=new ModulusPoly(this.field,o),s=r.length,c=new Int32Array(s);for(let d=0;d<s;d++){let t=this.field.inverse(r[d]),n=this.field.subtract(0,e.evaluateAt(t)),o=this.field.inverse(i.evaluateAt(t));c[d]=this.field.multiply(n,o)}return c}}class BoundingBox{constructor(e,t,r,n,o){e instanceof BoundingBox?this.constructor_2(e):this.constructor_1(e,t,r,n,o)}constructor_1(e,t,r,n,o){const i=null==t||null==r,s=null==n||null==o;if(i&&s)throw new NotFoundException;i?(t=new ResultPoint(0,n.getY()),r=new ResultPoint(0,o.getY())):s&&(n=new ResultPoint(e.getWidth()-1,t.getY()),o=new ResultPoint(e.getWidth()-1,r.getY())),this.image=e,this.topLeft=t,this.bottomLeft=r,this.topRight=n,this.bottomRight=o,this.minX=Math.trunc(Math.min(t.getX(),r.getX())),this.maxX=Math.trunc(Math.max(n.getX(),o.getX())),this.minY=Math.trunc(Math.min(t.getY(),n.getY())),this.maxY=Math.trunc(Math.max(r.getY(),o.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return null==e?t:null==t?e:new BoundingBox(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,r){let n=this.topLeft,o=this.bottomLeft,i=this.topRight,s=this.bottomRight;if(e>0){let t=r?this.topLeft:this.topRight,o=Math.trunc(t.getY()-e);o<0&&(o=0);let s=new ResultPoint(t.getX(),o);r?n=s:i=s}if(t>0){let e=r?this.bottomLeft:this.bottomRight,n=Math.trunc(e.getY()+t);n>=this.image.getHeight()&&(n=this.image.getHeight()-1);let i=new ResultPoint(e.getX(),n);r?o=i:s=i}return new BoundingBox(this.image,n,o,i,s)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class BarcodeMetadata{constructor(e,t,r,n){this.columnCount=e,this.errorCorrectionLevel=n,this.rowCountUpperPart=t,this.rowCountLowerPart=r,this.rowCount=t+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Formatter{constructor(){this.buffer=""}static form(e,t){let r=-1;function callback(e,n,o,i,s,c){if("%%"===e)return"%";if(void 0===t[++r])return;e=i?parseInt(i.substr(1)):void 0;let d,l=s?parseInt(s.substr(1)):void 0;switch(c){case"s":d=t[r];break;case"c":d=t[r][0];break;case"f":d=parseFloat(t[r]).toFixed(e);break;case"p":d=parseFloat(t[r]).toPrecision(e);break;case"e":d=parseFloat(t[r]).toExponential(e);break;case"x":d=parseInt(t[r]).toString(l||16);break;case"d":d=parseFloat(parseInt(t[r],l||10).toPrecision(e)).toFixed(0)}d="object"==typeof d?JSON.stringify(d):(+d).toString(l);let u=parseInt(o),h=o&&o[0]+""=="0"?"0":" ";for(;d.length<u;)d=void 0!==n?d+h:h+d;return d}let n=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(n,callback)}format(e,...t){this.buffer+=Formatter.form(e,t)}toString(){return this.buffer}}class DetectionResultColumn{constructor(e){this.boundingBox=new BoundingBox(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(null!=t)return t;for(let r=1;r<DetectionResultColumn.MAX_NEARBY_DISTANCE;r++){let n=this.imageRowToCodewordIndex(e)-r;if(n>=0&&(t=this.codewords[n],null!=t))return t;if(n=this.imageRowToCodewordIndex(e)+r,n<this.codewords.length&&(t=this.codewords[n],null!=t))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new Formatter;let t=0;for(const r of this.codewords)null!=r?e.format("%3d: %3d|%3d%n",t++,r.getRowNumber(),r.getValue()):e.format("%3d:    |   %n",t++);return e.toString()}}DetectionResultColumn.MAX_NEARBY_DISTANCE=5;class BarcodeValue{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);null==t&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[r,n]of this.values.entries()){const o={getKey:()=>r,getValue:()=>n};o.getValue()>e?(e=o.getValue(),t=[],t.push(o.getKey())):o.getValue()===e&&t.push(o.getKey())}return PDF417Common.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class DetectionResultRowIndicatorColumn extends DetectionResultColumn{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())null!=e&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let r=this.getBoundingBox(),n=this._isLeft?r.getTopLeft():r.getTopRight(),o=this._isLeft?r.getBottomLeft():r.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.imageRowToCodewordIndex(Math.trunc(o.getY())),c=-1,d=1,l=0;for(let u=i;u<s;u++){if(null==t[u])continue;let r=t[u],n=r.getRowNumber()-c;if(0===n)l++;else if(1===n)d=Math.max(d,l),l=1,c=r.getRowNumber();else if(n<0||r.getRowNumber()>=e.getRowCount()||n>u)t[u]=null;else{let e;e=d>2?(d-2)*n:n;let o=e>=u;for(let r=1;r<=e&&!o;r++)o=null!=t[u-r];o?t[u]=null:(c=r.getRowNumber(),l=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(null==e)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let r of this.getCodewords())if(null!=r){let e=r.getRowNumber();if(e>=t.length)continue;t[e]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),r=this._isLeft?t.getTopLeft():t.getTopRight(),n=this._isLeft?t.getBottomLeft():t.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.getCodewords(),c=-1;for(let d=o;d<i;d++){if(null==s[d])continue;let t=s[d];t.setRowNumberAsRowIndicatorColumn();let r=t.getRowNumber()-c;0===r||(1===r?c=t.getRowNumber():t.getRowNumber()>=e.getRowCount()?s[d]=null:c=t.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new BarcodeValue,r=new BarcodeValue,n=new BarcodeValue,o=new BarcodeValue;for(let s of e){if(null==s)continue;s.setRowNumberAsRowIndicatorColumn();let e=s.getValue()%30,i=s.getRowNumber();switch(this._isLeft||(i+=2),i%3){case 0:r.setValue(3*e+1);break;case 1:o.setValue(e/3),n.setValue(e%3);break;case 2:t.setValue(e+1)}}if(0===t.getValue().length||0===r.getValue().length||0===n.getValue().length||0===o.getValue().length||t.getValue()[0]<1||r.getValue()[0]+n.getValue()[0]<PDF417Common.MIN_ROWS_IN_BARCODE||r.getValue()[0]+n.getValue()[0]>PDF417Common.MAX_ROWS_IN_BARCODE)return null;let i=new BarcodeMetadata(t.getValue()[0],r.getValue()[0],n.getValue()[0],o.getValue()[0]);return this.removeIncorrectCodewords(e,i),i}removeIncorrectCodewords(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(null==e[r])continue;let o=n.getValue()%30,i=n.getRowNumber();if(i>t.getRowCount())e[r]=null;else switch(this._isLeft||(i+=2),i%3){case 0:3*o+1!==t.getRowCountUpperPart()&&(e[r]=null);break;case 1:Math.trunc(o/3)===t.getErrorCorrectionLevel()&&o%3===t.getRowCountLowerPart()||(e[r]=null);break;case 2:o+1!==t.getColumnCount()&&(e[r]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}class DetectionResult{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e,t=PDF417Common.MAX_CODEWORDS_IN_BARCODE;do{e=t,t=this.adjustRowNumbersAndGetCount()}while(t>0&&t<e);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){null!=e&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(0===e)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let e=this.detectionResultColumns[t].getCodewords();for(let r=0;r<e.length;r++)null!=e[r]&&(e[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,e))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<e.length;r++)if(null!=e[r]&&null!=t[r]&&e[r].getRowNumber()===t[r].getRowNumber())for(let t=1;t<=this.barcodeColumnCount;t++){let n=this.detectionResultColumns[t].getCodewords()[r];null!=n&&(n.setRowNumber(e[r].getRowNumber()),n.hasValidRowNumber()||(this.detectionResultColumns[t].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<t.length;r++){if(null==t[r])continue;let n=t[r].getRowNumber(),o=0;for(let t=this.barcodeColumnCount+1;t>0&&o<this.ADJUST_ROW_NUMBER_SKIP;t--){let i=this.detectionResultColumns[t].getCodewords()[r];null!=i&&(o=DetectionResult.adjustRowNumberIfValid(n,o,i),i.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let r=0;r<t.length;r++){if(null==t[r])continue;let n=t[r].getRowNumber(),o=0;for(let t=1;t<this.barcodeColumnCount+1&&o<this.ADJUST_ROW_NUMBER_SKIP;t++){let i=this.detectionResultColumns[t].getCodewords()[r];null!=i&&(o=DetectionResult.adjustRowNumberIfValid(n,o,i),i.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,r){return null==r||r.hasValidRowNumber()||(r.isValidRowNumber(e)?(r.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,r){if(!this.detectionResultColumns[e-1])return;let n=r[t],o=this.detectionResultColumns[e-1].getCodewords(),i=o;null!=this.detectionResultColumns[e+1]&&(i=this.detectionResultColumns[e+1].getCodewords());let s=new Array(14);s[2]=o[t],s[3]=i[t],t>0&&(s[0]=r[t-1],s[4]=o[t-1],s[5]=i[t-1]),t>1&&(s[8]=r[t-2],s[10]=o[t-2],s[11]=i[t-2]),t<r.length-1&&(s[1]=r[t+1],s[6]=o[t+1],s[7]=i[t+1]),t<r.length-2&&(s[9]=r[t+2],s[12]=o[t+2],s[13]=i[t+2]);for(let c of s)if(DetectionResult.adjustRowNumber(n,c))return}static adjustRowNumber(e,t){return!(null==t||!t.hasValidRowNumber()||t.getBucket()!==e.getBucket()||(e.setRowNumber(t.getRowNumber()),0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];null==e&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new Formatter;for(let r=0;r<e.getCodewords().length;r++){t.format("CW %3d:",r);for(let e=0;e<this.barcodeColumnCount+2;e++){if(null==this.detectionResultColumns[e]){t.format("    |   ");continue}let n=this.detectionResultColumns[e].getCodewords()[r];null!=n?t.format(" %3d|%3d",n.getRowNumber(),n.getValue()):t.format("    |   ")}t.format("%n")}return t.toString()}}class Codeword{constructor(e,t,r,n){this.rowNumber=Codeword.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(r),this.value=Math.trunc(n)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==Codeword.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}Codeword.BARCODE_ROW_UNKNOWN=-1;class PDF417CodewordDecoder{static initialize(){for(let e=0;e<PDF417Common.SYMBOL_TABLE.length;e++){let t=PDF417Common.SYMBOL_TABLE[e],r=1&t;for(let n=0;n<PDF417Common.BARS_IN_MODULE;n++){let o=0;for(;(1&t)===r;)o+=1,t>>=1;r=1&t,PDF417CodewordDecoder.RATIOS_TABLE[e]||(PDF417CodewordDecoder.RATIOS_TABLE[e]=new Array(PDF417Common.BARS_IN_MODULE)),PDF417CodewordDecoder.RATIOS_TABLE[e][PDF417Common.BARS_IN_MODULE-n-1]=Math.fround(o/PDF417Common.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=PDF417CodewordDecoder.getDecodedCodewordValue(PDF417CodewordDecoder.sampleBitCounts(e));return-1!==t?t:PDF417CodewordDecoder.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=MathUtils.sum(e),r=new Int32Array(PDF417Common.BARS_IN_MODULE),n=0,o=0;for(let i=0;i<PDF417Common.MODULES_IN_CODEWORD;i++){let s=t/(2*PDF417Common.MODULES_IN_CODEWORD)+i*t/PDF417Common.MODULES_IN_CODEWORD;o+e[n]<=s&&(o+=e[n],n++),r[n]++}return r}static getDecodedCodewordValue(e){let t=PDF417CodewordDecoder.getBitValue(e);return-1===PDF417Common.getCodeword(t)?-1:t}static getBitValue(e){let t=0;for(let r=0;r<e.length;r++)for(let n=0;n<e[r];n++)t=t<<1|(r%2==0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=MathUtils.sum(e),r=new Array(PDF417Common.BARS_IN_MODULE);if(t>1)for(let i=0;i<r.length;i++)r[i]=Math.fround(e[i]/t);let n=Float.MAX_VALUE,o=-1;this.bSymbolTableReady||PDF417CodewordDecoder.initialize();for(let i=0;i<PDF417CodewordDecoder.RATIOS_TABLE.length;i++){let e=0,t=PDF417CodewordDecoder.RATIOS_TABLE[i];for(let o=0;o<PDF417Common.BARS_IN_MODULE;o++){let i=Math.fround(t[o]-r[o]);if(e+=Math.fround(i*i),e>=n)break}e<n&&(n=e,o=PDF417Common.SYMBOL_TABLE[i])}return o}}PDF417CodewordDecoder.bSymbolTableReady=!1,PDF417CodewordDecoder.RATIOS_TABLE=new Array(PDF417Common.SYMBOL_TABLE.length).map(e=>new Array(PDF417Common.BARS_IN_MODULE));class PDF417ResultMetadata{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Long{static parseLong(e,t=void 0){return parseInt(e,t)}}class NullPointerException extends Exception{}NullPointerException.kind="NullPointerException";class OutputStream{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,r){if(null==e)throw new NullPointerException;if(t<0||t>e.length||r<0||t+r>e.length||t+r<0)throw new IndexOutOfBoundsException;if(0!==r)for(let n=0;n<r;n++)this.write(e[t+n])}flush(){}close(){}}class OutOfMemoryError extends Exception{}class ByteArrayOutputStream extends OutputStream{constructor(e=32){if(super(),this.count=0,e<0)throw new IllegalArgumentException("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let t=this.buf.length<<1;if(t-e<0&&(t=e),t<0){if(e<0)throw new OutOfMemoryError;t=Integer.MAX_VALUE}this.buf=Arrays.copyOfUint8Array(this.buf,t)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,r){if(t<0||t>e.length||r<0||t+r-e.length>0)throw new IndexOutOfBoundsException;this.ensureCapacity(this.count+r),System.arraycopy(e,t,this.buf,this.count,r),this.count+=r}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return Arrays.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?"string"==typeof e?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}function getBigIntConstructor(){if("undefined"!=typeof window)return window.BigInt||null;if(void 0!==t)return t.BigInt||null;if("undefined"!=typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let m;function createBigInt(e){if(void 0===m&&(m=getBigIntConstructor()),null===m)throw new Error("BigInt is not supported!");return m(e)}function getEXP900(){let e=[];e[0]=createBigInt(1);let t=createBigInt(900);e[1]=t;for(let r=2;r<16;r++)e[r]=e[r-1]*t;return e}!function(e){e[e.ALPHA=0]="ALPHA",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.PUNCT=3]="PUNCT",e[e.ALPHA_SHIFT=4]="ALPHA_SHIFT",e[e.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(f||(f={}));class DecodedBitStreamParser$2{static decode(e,t){let r=new StringBuilder(""),n=CharacterSetECI.ISO8859_1;r.enableDecoding(n);let o=1,i=e[o++],s=new PDF417ResultMetadata;for(;o<e[0];){switch(i){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=DecodedBitStreamParser$2.textCompaction(e,o,r);break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:o=DecodedBitStreamParser$2.byteCompaction(i,e,n,o,r);break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[o++]);break;case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:o=DecodedBitStreamParser$2.numericCompaction(e,o,r);break;case DecodedBitStreamParser$2.ECI_CHARSET:CharacterSetECI.getCharacterSetECIByValue(e[o++]);break;case DecodedBitStreamParser$2.ECI_GENERAL_PURPOSE:o+=2;break;case DecodedBitStreamParser$2.ECI_USER_DEFINED:o++;break;case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:o=DecodedBitStreamParser$2.decodeMacroBlock(e,o,s);break;case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:throw new FormatException;default:o--,o=DecodedBitStreamParser$2.textCompaction(e,o,r)}if(!(o<e.length))throw FormatException.getFormatInstance();i=e[o++]}if(0===r.length())throw FormatException.getFormatInstance();let c=new DecoderResult(null,r.toString(),null,t);return c.setOther(s),c}static decodeMacroBlock(e,t,r){if(t+DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw FormatException.getFormatInstance();let n=new Int32Array(DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS);for(let s=0;s<DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS;s++,t++)n[s]=e[t];r.setSegmentIndex(Integer.parseInt(DecodedBitStreamParser$2.decodeBase900toBase10(n,DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS)));let o=new StringBuilder;t=DecodedBitStreamParser$2.textCompaction(e,t,o),r.setFileId(o.toString());let i=-1;for(e[t]===DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(i=t+1);t<e[0];)switch(e[t]){case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(e[++t]){case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let n=new StringBuilder;t=DecodedBitStreamParser$2.textCompaction(e,t+1,n),r.setFileName(n.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let o=new StringBuilder;t=DecodedBitStreamParser$2.textCompaction(e,t+1,o),r.setSender(o.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let i=new StringBuilder;t=DecodedBitStreamParser$2.textCompaction(e,t+1,i),r.setAddressee(i.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let s=new StringBuilder;t=DecodedBitStreamParser$2.numericCompaction(e,t+1,s),r.setSegmentCount(Integer.parseInt(s.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let c=new StringBuilder;t=DecodedBitStreamParser$2.numericCompaction(e,t+1,c),r.setTimestamp(Long.parseLong(c.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let d=new StringBuilder;t=DecodedBitStreamParser$2.numericCompaction(e,t+1,d),r.setChecksum(Integer.parseInt(d.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let l=new StringBuilder;t=DecodedBitStreamParser$2.numericCompaction(e,t+1,l),r.setFileSize(Long.parseLong(l.toString()));break;default:throw FormatException.getFormatInstance()}break;case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:t++,r.setLastSegment(!0);break;default:throw FormatException.getFormatInstance()}if(-1!==i){let n=t-i;r.isLastSegment()&&n--,r.setOptionalData(Arrays.copyOfRange(e,i,i+n))}return t}static textCompaction(e,t,r){let n=new Int32Array(2*(e[0]-t)),o=new Int32Array(2*(e[0]-t)),i=0,s=!1;for(;t<e[0]&&!s;){let r=e[t++];if(r<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH)n[i]=r/30,n[i+1]=r%30,i+=2;else switch(r){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:n[i++]=DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH;break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:t--,s=!0;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n[i]=DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,r=e[t++],o[i]=r,i++}}return DecodedBitStreamParser$2.decodeTextCompaction(n,o,i,r),t}static decodeTextCompaction(e,t,r,n){let o=f.ALPHA,i=f.ALPHA,s=0;for(;s<r;){let r=e[s],c="";switch(o){case f.ALPHA:if(r<26)c=String.fromCharCode(65+r);else switch(r){case 26:c=" ";break;case DecodedBitStreamParser$2.LL:o=f.LOWER;break;case DecodedBitStreamParser$2.ML:o=f.MIXED;break;case DecodedBitStreamParser$2.PS:i=o,o=f.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[s]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=f.ALPHA}break;case f.LOWER:if(r<26)c=String.fromCharCode(97+r);else switch(r){case 26:c=" ";break;case DecodedBitStreamParser$2.AS:i=o,o=f.ALPHA_SHIFT;break;case DecodedBitStreamParser$2.ML:o=f.MIXED;break;case DecodedBitStreamParser$2.PS:i=o,o=f.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[s]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=f.ALPHA}break;case f.MIXED:if(r<DecodedBitStreamParser$2.PL)c=DecodedBitStreamParser$2.MIXED_CHARS[r];else switch(r){case DecodedBitStreamParser$2.PL:o=f.PUNCT;break;case 26:c=" ";break;case DecodedBitStreamParser$2.LL:o=f.LOWER;break;case DecodedBitStreamParser$2.AL:o=f.ALPHA;break;case DecodedBitStreamParser$2.PS:i=o,o=f.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[s]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=f.ALPHA}break;case f.PUNCT:if(r<DecodedBitStreamParser$2.PAL)c=DecodedBitStreamParser$2.PUNCT_CHARS[r];else switch(r){case DecodedBitStreamParser$2.PAL:o=f.ALPHA;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[s]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=f.ALPHA}break;case f.ALPHA_SHIFT:if(o=i,r<26)c=String.fromCharCode(65+r);else switch(r){case 26:c=" ";break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=f.ALPHA}break;case f.PUNCT_SHIFT:if(o=i,r<DecodedBitStreamParser$2.PAL)c=DecodedBitStreamParser$2.PUNCT_CHARS[r];else switch(r){case DecodedBitStreamParser$2.PAL:o=f.ALPHA;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[s]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:o=f.ALPHA}}""!==c&&n.append(c),s++}}static byteCompaction(e,t,r,n,o){let i=new ByteArrayOutputStream,s=0,c=0,d=!1;switch(e){case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:let e=new Int32Array(6),r=t[n++];for(;n<t[0]&&!d;)switch(e[s++]=r,c=900*c+r,r=t[n++],r){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:n--,d=!0;break;default:if(s%5==0&&s>0){for(let e=0;e<6;++e)i.write(Number(createBigInt(c)>>createBigInt(8*(5-e))));c=0,s=0}}n===t[0]&&r<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH&&(e[s++]=r);for(let t=0;t<s;t++)i.write(e[t]);break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:for(;n<t[0]&&!d;){let e=t[n++];if(e<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH)s++,c=900*c+e;else switch(e){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:n--,d=!0}if(s%5==0&&s>0){for(let e=0;e<6;++e)i.write(Number(createBigInt(c)>>createBigInt(8*(5-e))));c=0,s=0}}}return o.append(StringEncoding.decode(i.toByteArray(),r)),n}static numericCompaction(e,t,r){let n=0,o=!1,i=new Int32Array(DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!o;){let s=e[t++];if(t===e[0]&&(o=!0),s<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH)i[n]=s,n++;else switch(s){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:t--,o=!0}(n%DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS===0||s===DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH||o)&&n>0&&(r.append(DecodedBitStreamParser$2.decodeBase900toBase10(i,n)),n=0)}return t}static decodeBase900toBase10(e,t){let r=createBigInt(0);for(let o=0;o<t;o++)r+=DecodedBitStreamParser$2.EXP900[t-o-1]*createBigInt(e[o]);let n=r.toString();if("1"!==n.charAt(0))throw new FormatException;return n.substring(1)}}DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH=900,DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH=901,DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH=902,DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6=924,DecodedBitStreamParser$2.ECI_USER_DEFINED=925,DecodedBitStreamParser$2.ECI_GENERAL_PURPOSE=926,DecodedBitStreamParser$2.ECI_CHARSET=927,DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR=922,DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS=15,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,DecodedBitStreamParser$2.PL=25,DecodedBitStreamParser$2.LL=27,DecodedBitStreamParser$2.AS=27,DecodedBitStreamParser$2.ML=28,DecodedBitStreamParser$2.AL=28,DecodedBitStreamParser$2.PS=29,DecodedBitStreamParser$2.PAL=29,DecodedBitStreamParser$2.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",DecodedBitStreamParser$2.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",DecodedBitStreamParser$2.EXP900=getBigIntConstructor()?getEXP900():[],DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS=2;class PDF417ScanningDecoder{constructor(){}static decode(e,t,r,n,o,i,s){let c,d=new BoundingBox(e,t,r,n,o),l=null,u=null;for(let E=!0;;E=!1){if(null!=t&&(l=PDF417ScanningDecoder.getRowIndicatorColumn(e,d,t,!0,i,s)),null!=n&&(u=PDF417ScanningDecoder.getRowIndicatorColumn(e,d,n,!1,i,s)),c=PDF417ScanningDecoder.merge(l,u),null==c)throw NotFoundException.getNotFoundInstance();let r=c.getBoundingBox();if(!E||null==r||!(r.getMinY()<d.getMinY()||r.getMaxY()>d.getMaxY()))break;d=r}c.setBoundingBox(d);let h=c.getBarcodeColumnCount()+1;c.setDetectionResultColumn(0,l),c.setDetectionResultColumn(h,u);let g=null!=l;for(let E=1;E<=h;E++){let t,r=g?E:h-E;if(void 0!==c.getDetectionResultColumn(r))continue;t=0===r||r===h?new DetectionResultRowIndicatorColumn(d,0===r):new DetectionResultColumn(d),c.setDetectionResultColumn(r,t);let n=-1,o=n;for(let l=d.getMinY();l<=d.getMaxY();l++){if(n=PDF417ScanningDecoder.getStartColumn(c,r,l,g),n<0||n>d.getMaxX()){if(-1===o)continue;n=o}let u=PDF417ScanningDecoder.detectCodeword(e,d.getMinX(),d.getMaxX(),g,n,l,i,s);null!=u&&(t.setCodeword(l,u),o=n,i=Math.min(i,u.getWidth()),s=Math.max(s,u.getWidth()))}}return PDF417ScanningDecoder.createDecoderResult(c)}static merge(e,t){if(null==e&&null==t)return null;let r=PDF417ScanningDecoder.getBarcodeMetadata(e,t);if(null==r)return null;let n=BoundingBox.merge(PDF417ScanningDecoder.adjustBoundingBox(e),PDF417ScanningDecoder.adjustBoundingBox(t));return new DetectionResult(r,n)}static adjustBoundingBox(e){if(null==e)return null;let t=e.getRowHeights();if(null==t)return null;let r=PDF417ScanningDecoder.getMax(t),n=0;for(let s of t)if(n+=r-s,s>0)break;let o=e.getCodewords();for(let s=0;n>0&&null==o[s];s++)n--;let i=0;for(let s=t.length-1;s>=0&&(i+=r-t[s],!(t[s]>0));s--);for(let s=o.length-1;i>0&&null==o[s];s--)i--;return e.getBoundingBox().addMissingRows(n,i,e.isLeft())}static getMax(e){let t=-1;for(let r of e)t=Math.max(t,r);return t}static getBarcodeMetadata(e,t){let r,n;return null==e||null==(r=e.getBarcodeMetadata())?null==t?null:t.getBarcodeMetadata():null==t||null==(n=t.getBarcodeMetadata())?r:r.getColumnCount()!==n.getColumnCount()&&r.getErrorCorrectionLevel()!==n.getErrorCorrectionLevel()&&r.getRowCount()!==n.getRowCount()?null:r}static getRowIndicatorColumn(e,t,r,n,o,i){let s=new DetectionResultRowIndicatorColumn(t,n);for(let c=0;c<2;c++){let d=0===c?1:-1,l=Math.trunc(Math.trunc(r.getX()));for(let c=Math.trunc(Math.trunc(r.getY()));c<=t.getMaxY()&&c>=t.getMinY();c+=d){let t=PDF417ScanningDecoder.detectCodeword(e,0,e.getWidth(),n,l,c,o,i);null!=t&&(s.setCodeword(c,t),l=n?t.getStartX():t.getEndX())}}return s}static adjustCodewordCount(e,t){let r=t[0][1],n=r.getValue(),o=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-PDF417ScanningDecoder.getNumberOfECCodeWords(e.getBarcodeECLevel());if(0===n.length){if(o<1||o>PDF417Common.MAX_CODEWORDS_IN_BARCODE)throw NotFoundException.getNotFoundInstance();r.setValue(o)}else n[0]!==o&&r.setValue(o)}static createDecoderResult(e){let t=PDF417ScanningDecoder.createBarcodeMatrix(e);PDF417ScanningDecoder.adjustCodewordCount(e,t);let r=new Array,n=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),o=[],i=new Array;for(let c=0;c<e.getBarcodeRowCount();c++)for(let s=0;s<e.getBarcodeColumnCount();s++){let d=t[c][s+1].getValue(),l=c*e.getBarcodeColumnCount()+s;0===d.length?r.push(l):1===d.length?n[l]=d[0]:(i.push(l),o.push(d))}let s=new Array(o.length);for(let c=0;c<s.length;c++)s[c]=o[c];return PDF417ScanningDecoder.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),n,PDF417Common.toIntArray(r),PDF417Common.toIntArray(i),s)}static createDecoderResultFromAmbiguousValues(e,t,r,n,o){let i=new Int32Array(n.length),s=100;for(;s-- >0;){for(let e=0;e<i.length;e++)t[n[e]]=o[e][i[e]];try{return PDF417ScanningDecoder.decodeCodewords(t,e,r)}catch(c){if(!(c instanceof ChecksumException))throw c}if(0===i.length)throw ChecksumException.getChecksumInstance();for(let e=0;e<i.length;e++){if(i[e]<o[e].length-1){i[e]++;break}if(i[e]=0,e===i.length-1)throw ChecksumException.getChecksumInstance()}}throw ChecksumException.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let n=0;n<t.length;n++)for(let e=0;e<t[n].length;e++)t[n][e]=new BarcodeValue;let r=0;for(let n of e.getDetectionResultColumns()){if(null!=n)for(let e of n.getCodewords())if(null!=e){let n=e.getRowNumber();if(n>=0){if(n>=t.length)continue;t[n][r].setValue(e.getValue())}}r++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,r,n){let o=n?1:-1,i=null;if(PDF417ScanningDecoder.isValidBarcodeColumn(e,t-o)&&(i=e.getDetectionResultColumn(t-o).getCodeword(r)),null!=i)return n?i.getEndX():i.getStartX();if(i=e.getDetectionResultColumn(t).getCodewordNearby(r),null!=i)return n?i.getStartX():i.getEndX();if(PDF417ScanningDecoder.isValidBarcodeColumn(e,t-o)&&(i=e.getDetectionResultColumn(t-o).getCodewordNearby(r)),null!=i)return n?i.getEndX():i.getStartX();let s=0;for(;PDF417ScanningDecoder.isValidBarcodeColumn(e,t-o);){t-=o;for(let r of e.getDetectionResultColumn(t).getCodewords())if(null!=r)return(n?r.getEndX():r.getStartX())+o*s*(r.getEndX()-r.getStartX());s++}return n?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,r,n,o,i,s,c){o=PDF417ScanningDecoder.adjustCodewordStartColumn(e,t,r,n,o,i);let d,l=PDF417ScanningDecoder.getModuleBitCount(e,t,r,n,o,i);if(null==l)return null;let u=MathUtils.sum(l);if(n)d=o+u;else{for(let e=0;e<l.length/2;e++){let t=l[e];l[e]=l[l.length-1-e],l[l.length-1-e]=t}d=o,o=d-u}if(!PDF417ScanningDecoder.checkCodewordSkew(u,s,c))return null;let h=PDF417CodewordDecoder.getDecodedValue(l),g=PDF417Common.getCodeword(h);return-1===g?null:new Codeword(o,d,PDF417ScanningDecoder.getCodewordBucketNumber(h),g)}static getModuleBitCount(e,t,r,n,o,i){let s=o,c=new Int32Array(8),d=0,l=n?1:-1,u=n;for(;(n?s<r:s>=t)&&d<c.length;)e.get(s,i)===u?(c[d]++,s+=l):(d++,u=!u);return d===c.length||s===(n?r:t)&&d===c.length-1?c:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,r,n,o,i){let s=o,c=n?-1:1;for(let d=0;d<2;d++){for(;(n?s>=t:s<r)&&n===e.get(s,i);){if(Math.abs(o-s)>PDF417ScanningDecoder.CODEWORD_SKEW_SIZE)return o;s+=c}c=-c,n=!n}return s}static checkCodewordSkew(e,t,r){return t-PDF417ScanningDecoder.CODEWORD_SKEW_SIZE<=e&&e<=r+PDF417ScanningDecoder.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,r){if(0===e.length)throw FormatException.getFormatInstance();let n=1<<t+1,o=PDF417ScanningDecoder.correctErrors(e,r,n);PDF417ScanningDecoder.verifyCodewordCount(e,n);let i=DecodedBitStreamParser$2.decode(e,""+t);return i.setErrorsCorrected(o),i.setErasures(r.length),i}static correctErrors(e,t,r){if(null!=t&&t.length>r/2+PDF417ScanningDecoder.MAX_ERRORS||r<0||r>PDF417ScanningDecoder.MAX_EC_CODEWORDS)throw ChecksumException.getChecksumInstance();return PDF417ScanningDecoder.errorCorrection.decode(e,r,t)}static verifyCodewordCount(e,t){if(e.length<4)throw FormatException.getFormatInstance();let r=e[0];if(r>e.length)throw FormatException.getFormatInstance();if(0===r){if(!(t<e.length))throw FormatException.getFormatInstance();e[0]=e.length-t}}static getBitCountForCodeword(e){let t=new Int32Array(8),r=0,n=t.length-1;for(;!((1&e)!==r&&(r=1&e,n--,n<0));)t[n]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return PDF417ScanningDecoder.getCodewordBucketNumber(PDF417ScanningDecoder.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new Formatter;for(let r=0;r<e.length;r++){t.format("Row %2d: ",r);for(let n=0;n<e[r].length;n++){let o=e[r][n];0===o.getValue().length?t.format("        ",null):t.format("%4d(%2d)",o.getValue()[0],o.getConfidence(o.getValue()[0]))}t.format("%n")}return t.toString()}}PDF417ScanningDecoder.CODEWORD_SKEW_SIZE=2,PDF417ScanningDecoder.MAX_ERRORS=3,PDF417ScanningDecoder.MAX_EC_CODEWORDS=512,PDF417ScanningDecoder.errorCorrection=new ErrorCorrection;class PDF417Reader{decode(e,t=null){let r=PDF417Reader.decode(e,t,!1);if(null==r||0===r.length||null==r[0])throw NotFoundException.getNotFoundInstance();return r[0]}decodeMultiple(e,t=null){try{return PDF417Reader.decode(e,t,!0)}catch(r){if(r instanceof FormatException||r instanceof ChecksumException)throw NotFoundException.getNotFoundInstance();throw r}}static decode(e,t,r){const n=new Array,o=Detector$3.detectMultiple(e,t,r);for(const i of o.getPoints()){const e=PDF417ScanningDecoder.decode(o.getBits(),i[4],i[5],i[6],i[7],PDF417Reader.getMinCodewordWidth(i),PDF417Reader.getMaxCodewordWidth(i)),t=new Result(e.getText(),e.getRawBytes(),void 0,i,d.PDF_417);t.putMetadata(C.ERROR_CORRECTION_LEVEL,e.getECLevel());const r=e.getOther();null!=r&&t.putMetadata(C.PDF417_EXTRA_METADATA,r),n.push(t)}return n.map(e=>e)}static getMaxWidth(e,t){return null==e||null==t?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return null==e||null==t?Integer.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(PDF417Reader.getMaxWidth(e[0],e[4]),PDF417Reader.getMaxWidth(e[6],e[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.max(PDF417Reader.getMaxWidth(e[1],e[5]),PDF417Reader.getMaxWidth(e[7],e[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(PDF417Reader.getMinWidth(e[0],e[4]),PDF417Reader.getMinWidth(e[6],e[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.min(PDF417Reader.getMinWidth(e[1],e[5]),PDF417Reader.getMinWidth(e[7],e[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)))}reset(){}}class ReaderException extends Exception{}ReaderException.kind="ReaderException";class MultiFormatReader{constructor(e,t){this.verbose=!0===e,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!isNullOrUndefined(e)&&!0===e.get(i.TRY_HARDER),r=isNullOrUndefined(e)?null:e.get(i.POSSIBLE_FORMATS),n=new Array;if(!isNullOrUndefined(r)){const o=r.some(e=>e===d.UPC_A||e===d.UPC_E||e===d.EAN_13||e===d.EAN_8||e===d.CODABAR||e===d.CODE_39||e===d.CODE_93||e===d.CODE_128||e===d.ITF||e===d.RSS_14||e===d.RSS_EXPANDED);o&&!t&&n.push(new MultiFormatOneDReader(e,this.verbose)),r.includes(d.QR_CODE)&&n.push(new QRCodeReader),r.includes(d.DATA_MATRIX)&&n.push(new DataMatrixReader),r.includes(d.AZTEC)&&n.push(new AztecReader),r.includes(d.PDF_417)&&n.push(new PDF417Reader),o&&t&&n.push(new MultiFormatOneDReader(e,this.verbose))}0===n.length&&(t||n.push(new MultiFormatOneDReader(e,this.verbose)),n.push(new QRCodeReader),n.push(new DataMatrixReader),n.push(new AztecReader),n.push(new PDF417Reader),t&&n.push(new MultiFormatOneDReader(e,this.verbose))),this.readers=n}reset(){if(null!==this.readers)for(const e of this.readers)e.reset()}decodeInternal(e){if(null===this.readers)throw new ReaderException("No readers where selected, nothing can be read.");for(const r of this.readers)try{return r.decode(e,this.hints)}catch(t){if(t instanceof ReaderException)continue}throw new NotFoundException("No MultiFormat Readers were able to detect the code.")}}class BrowserMultiFormatReader extends BrowserCodeReader{constructor(e=null,t=500){const r=new MultiFormatReader;r.setHints(e),super(r,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class BrowserPDF417Reader extends BrowserCodeReader{constructor(e=500){super(new PDF417Reader,e)}}class BrowserQRCodeReader extends BrowserCodeReader{constructor(e=500){super(new QRCodeReader,e)}}var p;!function(e){e[e.ERROR_CORRECTION=0]="ERROR_CORRECTION",e[e.CHARACTER_SET=1]="CHARACTER_SET",e[e.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",e[e.MIN_SIZE=3]="MIN_SIZE",e[e.MAX_SIZE=4]="MAX_SIZE",e[e.MARGIN=5]="MARGIN",e[e.PDF417_COMPACT=6]="PDF417_COMPACT",e[e.PDF417_COMPACTION=7]="PDF417_COMPACTION",e[e.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",e[e.AZTEC_LAYERS=9]="AZTEC_LAYERS",e[e.QR_VERSION=10]="QR_VERSION"}(p||(p={}));var A=p;class ReedSolomonEncoder{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new GenericGFPoly(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let r=t[t.length-1];const n=this.field;for(let o=t.length;o<=e;o++){const e=r.multiply(new GenericGFPoly(n,Int32Array.from([1,n.exp(o-1+n.getGeneratorBase())])));t.push(e),r=e}}return t[e]}encode(e,t){if(0===t)throw new IllegalArgumentException("No error correction bytes");const r=e.length-t;if(r<=0)throw new IllegalArgumentException("No data bytes provided");const n=this.buildGenerator(t),o=new Int32Array(r);System.arraycopy(e,0,o,0,r);let i=new GenericGFPoly(this.field,o);i=i.multiplyByMonomial(t,1);const s=i.divide(n)[1].getCoefficients(),c=t-s.length;for(let d=0;d<c;d++)e[r+d]=0;System.arraycopy(s,0,e,r+c,s.length)}}class MaskUtil{constructor(){}static applyMaskPenaltyRule1(e){return MaskUtil.applyMaskPenaltyRule1Internal(e,!0)+MaskUtil.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const r=e.getArray(),n=e.getWidth(),o=e.getHeight();for(let i=0;i<o-1;i++){const e=r[i];for(let o=0;o<n-1;o++){const n=e[o];n===e[o+1]&&n===r[i+1][o]&&n===r[i+1][o+1]&&t++}}return MaskUtil.N2*t}static applyMaskPenaltyRule3(e){let t=0;const r=e.getArray(),n=e.getWidth(),o=e.getHeight();for(let i=0;i<o;i++)for(let e=0;e<n;e++){const s=r[i];e+6<n&&1===s[e]&&0===s[e+1]&&1===s[e+2]&&1===s[e+3]&&1===s[e+4]&&0===s[e+5]&&1===s[e+6]&&(MaskUtil.isWhiteHorizontal(s,e-4,e)||MaskUtil.isWhiteHorizontal(s,e+7,e+11))&&t++,i+6<o&&1===r[i][e]&&0===r[i+1][e]&&1===r[i+2][e]&&1===r[i+3][e]&&1===r[i+4][e]&&0===r[i+5][e]&&1===r[i+6][e]&&(MaskUtil.isWhiteVertical(r,e,i-4,i)||MaskUtil.isWhiteVertical(r,e,i+7,i+11))&&t++}return t*MaskUtil.N3}static isWhiteHorizontal(e,t,r){t=Math.max(t,0),r=Math.min(r,e.length);for(let n=t;n<r;n++)if(1===e[n])return!1;return!0}static isWhiteVertical(e,t,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(let o=r;o<n;o++)if(1===e[o][t])return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const r=e.getArray(),n=e.getWidth(),o=e.getHeight();for(let s=0;s<o;s++){const e=r[s];for(let r=0;r<n;r++)1===e[r]&&t++}const i=e.getHeight()*e.getWidth();return Math.floor(10*Math.abs(2*t-i)/i)*MaskUtil.N4}static getDataMaskBit(e,t,r){let n,o;switch(e){case 0:n=r+t&1;break;case 1:n=1&r;break;case 2:n=t%3;break;case 3:n=(r+t)%3;break;case 4:n=Math.floor(r/2)+Math.floor(t/3)&1;break;case 5:o=r*t,n=(1&o)+o%3;break;case 6:o=r*t,n=(1&o)+o%3&1;break;case 7:o=r*t,n=o%3+(r+t&1)&1;break;default:throw new IllegalArgumentException("Invalid mask pattern: "+e)}return 0===n}static applyMaskPenaltyRule1Internal(e,t){let r=0;const n=t?e.getHeight():e.getWidth(),o=t?e.getWidth():e.getHeight(),i=e.getArray();for(let s=0;s<n;s++){let e=0,n=-1;for(let c=0;c<o;c++){const o=t?i[s][c]:i[c][s];o===n?e++:(e>=5&&(r+=MaskUtil.N1+(e-5)),e=1,n=o)}e>=5&&(r+=MaskUtil.N1+(e-5))}return r}}MaskUtil.N1=3,MaskUtil.N2=3,MaskUtil.N3=40,MaskUtil.N4=10;class ByteMatrix{constructor(e,t){this.width=e,this.height=t;const r=new Array(t);for(let n=0;n!==t;n++)r[n]=new Uint8Array(e);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,r){this.bytes[t][e]=r}setBoolean(e,t,r){this.bytes[t][e]=r?1:0}clear(e){for(const t of this.bytes)Arrays.fill(t,e)}equals(e){if(!(e instanceof ByteMatrix))return!1;const t=e;if(this.width!==t.width)return!1;if(this.height!==t.height)return!1;for(let r=0,n=this.height;r<n;++r){const e=this.bytes[r],n=t.bytes[r];for(let t=0,r=this.width;t<r;++t)if(e[t]!==n[t])return!1}return!0}toString(){const e=new StringBuilder;for(let t=0,r=this.height;t<r;++t){const r=this.bytes[t];for(let t=0,n=this.width;t<n;++t)switch(r[t]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ")}e.append("\n")}return e.toString()}}class QRCode{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new StringBuilder;return e.append("<<\n"),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append("\n ecLevel: "),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append("\n version: "),e.append(this.version?this.version.toString():"null"),e.append("\n maskPattern: "),e.append(this.maskPattern.toString()),this.matrix?(e.append("\n matrix:\n"),e.append(this.matrix.toString())):e.append("\n matrix: null\n"),e.append(">>\n"),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<QRCode.NUM_MASK_PATTERNS}}QRCode.NUM_MASK_PATTERNS=8;class WriterException extends Exception{}WriterException.kind="WriterException";class MatrixUtil{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,r,n,o){MatrixUtil.clearMatrix(o),MatrixUtil.embedBasicPatterns(r,o),MatrixUtil.embedTypeInfo(t,n,o),MatrixUtil.maybeEmbedVersionInfo(r,o),MatrixUtil.embedDataBits(e,n,o)}static embedBasicPatterns(e,t){MatrixUtil.embedPositionDetectionPatternsAndSeparators(t),MatrixUtil.embedDarkDotAtLeftBottomCorner(t),MatrixUtil.maybeEmbedPositionAdjustmentPatterns(e,t),MatrixUtil.embedTimingPatterns(t)}static embedTypeInfo(e,t,r){const n=new BitArray;MatrixUtil.makeTypeInfoBits(e,t,n);for(let o=0,i=n.getSize();o<i;++o){const e=n.get(n.getSize()-1-o),t=MatrixUtil.TYPE_INFO_COORDINATES[o],i=t[0],s=t[1];if(r.setBoolean(i,s,e),o<8){const t=r.getWidth()-o-1,n=8;r.setBoolean(t,n,e)}else{const t=8,n=r.getHeight()-7+(o-8);r.setBoolean(t,n,e)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const r=new BitArray;MatrixUtil.makeVersionInfoBits(e,r);let n=17;for(let o=0;o<6;++o)for(let e=0;e<3;++e){const i=r.get(n);n--,t.setBoolean(o,t.getHeight()-11+e,i),t.setBoolean(t.getHeight()-11+e,o,i)}}static embedDataBits(e,t,r){let n=0,o=-1,i=r.getWidth()-1,s=r.getHeight()-1;for(;i>0;){for(6===i&&(i-=1);s>=0&&s<r.getHeight();){for(let o=0;o<2;++o){const c=i-o;if(!MatrixUtil.isEmpty(r.get(c,s)))continue;let d;n<e.getSize()?(d=e.get(n),++n):d=!1,255!==t&&MaskUtil.getDataMaskBit(t,c,s)&&(d=!d),r.setBoolean(c,s,d)}s+=o}o=-o,s+=o,i-=2}if(n!==e.getSize())throw new WriterException("Not all bits consumed: "+n+"/"+e.getSize())}static findMSBSet(e){return 32-Integer.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(0===t)throw new IllegalArgumentException("0 polynomial");const r=MatrixUtil.findMSBSet(t);for(e<<=r-1;MatrixUtil.findMSBSet(e)>=r;)e^=t<<MatrixUtil.findMSBSet(e)-r;return e}static makeTypeInfoBits(e,t,r){if(!QRCode.isValidMaskPattern(t))throw new WriterException("Invalid mask pattern");const n=e.getBits()<<3|t;r.appendBits(n,5);const o=MatrixUtil.calculateBCHCode(n,MatrixUtil.TYPE_INFO_POLY);r.appendBits(o,10);const i=new BitArray;if(i.appendBits(MatrixUtil.TYPE_INFO_MASK_PATTERN,15),r.xor(i),15!==r.getSize())throw new WriterException("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const r=MatrixUtil.calculateBCHCode(e.getVersionNumber(),MatrixUtil.VERSION_INFO_POLY);if(t.appendBits(r,12),18!==t.getSize())throw new WriterException("should not happen but we got: "+t.getSize())}static isEmpty(e){return 255===e}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const r=(t+1)%2;MatrixUtil.isEmpty(e.get(t,6))&&e.setNumber(t,6,r),MatrixUtil.isEmpty(e.get(6,t))&&e.setNumber(6,t,r)}}static embedDarkDotAtLeftBottomCorner(e){if(0===e.get(8,e.getHeight()-8))throw new WriterException;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,r){for(let n=0;n<8;++n){if(!MatrixUtil.isEmpty(r.get(e+n,t)))throw new WriterException;r.setNumber(e+n,t,0)}}static embedVerticalSeparationPattern(e,t,r){for(let n=0;n<7;++n){if(!MatrixUtil.isEmpty(r.get(e,t+n)))throw new WriterException;r.setNumber(e,t+n,0)}}static embedPositionAdjustmentPattern(e,t,r){for(let n=0;n<5;++n){const o=MatrixUtil.POSITION_ADJUSTMENT_PATTERN[n];for(let i=0;i<5;++i)r.setNumber(e+i,t+n,o[i])}}static embedPositionDetectionPattern(e,t,r){for(let n=0;n<7;++n){const o=MatrixUtil.POSITION_DETECTION_PATTERN[n];for(let i=0;i<7;++i)r.setNumber(e+i,t+n,o[i])}}static embedPositionDetectionPatternsAndSeparators(e){const t=MatrixUtil.POSITION_DETECTION_PATTERN[0].length;MatrixUtil.embedPositionDetectionPattern(0,0,e),MatrixUtil.embedPositionDetectionPattern(e.getWidth()-t,0,e),MatrixUtil.embedPositionDetectionPattern(0,e.getWidth()-t,e);const r=8;MatrixUtil.embedHorizontalSeparationPattern(0,r-1,e),MatrixUtil.embedHorizontalSeparationPattern(e.getWidth()-r,r-1,e),MatrixUtil.embedHorizontalSeparationPattern(0,e.getWidth()-r,e);const n=7;MatrixUtil.embedVerticalSeparationPattern(n,0,e),MatrixUtil.embedVerticalSeparationPattern(e.getHeight()-n-1,0,e),MatrixUtil.embedVerticalSeparationPattern(n,e.getHeight()-n,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const r=e.getVersionNumber()-1,n=MatrixUtil.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let o=0,i=n.length;o!==i;o++){const e=n[o];if(e>=0)for(let r=0;r!==i;r++){const o=n[r];o>=0&&MatrixUtil.isEmpty(t.get(o,e))&&MatrixUtil.embedPositionAdjustmentPattern(o-2,e-2,t)}}}}MatrixUtil.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),MatrixUtil.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),MatrixUtil.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),MatrixUtil.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),MatrixUtil.VERSION_INFO_POLY=7973,MatrixUtil.TYPE_INFO_POLY=1335,MatrixUtil.TYPE_INFO_MASK_PATTERN=21522;class BlockPair{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Encoder{constructor(){}static calculateMaskPenalty(e){return MaskUtil.applyMaskPenaltyRule1(e)+MaskUtil.applyMaskPenaltyRule2(e)+MaskUtil.applyMaskPenaltyRule3(e)+MaskUtil.applyMaskPenaltyRule4(e)}static encode(e,t,r=null){let n=Encoder.DEFAULT_BYTE_MODE_ENCODING;const o=null!==r&&void 0!==r.get(A.CHARACTER_SET);o&&(n=r.get(A.CHARACTER_SET).toString());const i=this.chooseMode(e,n),s=new BitArray;if(i===Mode$1.BYTE&&(o||Encoder.DEFAULT_BYTE_MODE_ENCODING!==n)){const e=CharacterSetECI.getCharacterSetECIByName(n);void 0!==e&&this.appendECI(e,s)}this.appendModeInfo(i,s);const c=new BitArray;let d;if(this.appendBytes(e,i,c,n),null!==r&&void 0!==r.get(A.QR_VERSION)){const e=Number.parseInt(r.get(A.QR_VERSION).toString(),10);d=Version$1.getVersionForNumber(e);const n=this.calculateBitsNeeded(i,s,c,d);if(!this.willFit(n,d,t))throw new WriterException("Data too big for requested version")}else d=this.recommendVersion(t,i,s,c);const l=new BitArray;l.appendBitArray(s);const u=i===Mode$1.BYTE?c.getSizeInBytes():e.length;this.appendLengthInfo(u,d,i,l),l.appendBitArray(c);const h=d.getECBlocksForLevel(t),g=d.getTotalCodewords()-h.getTotalECCodewords();this.terminateBits(g,l);const E=this.interleaveWithECBytes(l,d.getTotalCodewords(),g,h.getNumBlocks()),f=new QRCode;f.setECLevel(t),f.setMode(i),f.setVersion(d);const C=d.getDimensionForVersion(),m=new ByteMatrix(C,C),p=this.chooseMaskPattern(E,t,d,m);return f.setMaskPattern(p),MatrixUtil.buildMatrix(E,t,d,p,m),f.setMatrix(m),f}static recommendVersion(e,t,r,n){const o=this.calculateBitsNeeded(t,r,n,Version$1.getVersionForNumber(1)),i=this.chooseVersion(o,e),s=this.calculateBitsNeeded(t,r,n,i);return this.chooseVersion(s,e)}static calculateBitsNeeded(e,t,r,n){return t.getSize()+e.getCharacterCountBits(n)+r.getSize()}static getAlphanumericCode(e){return e<Encoder.ALPHANUMERIC_TABLE.length?Encoder.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(CharacterSetECI.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return Mode$1.KANJI;let r=!1,n=!1;for(let o=0,i=e.length;o<i;++o){const t=e.charAt(o);if(Encoder.isDigit(t))r=!0;else{if(-1===this.getAlphanumericCode(t.charCodeAt(0)))return Mode$1.BYTE;n=!0}}return n?Mode$1.ALPHANUMERIC:r?Mode$1.NUMERIC:Mode$1.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=StringEncoding.encode(e,CharacterSetECI.SJIS)}catch(n){return!1}const r=t.length;if(r%2!=0)return!1;for(let o=0;o<r;o+=2){const e=255&t[o];if((e<129||e>159)&&(e<224||e>235))return!1}return!0}static chooseMaskPattern(e,t,r,n){let o=Number.MAX_SAFE_INTEGER,i=-1;for(let s=0;s<QRCode.NUM_MASK_PATTERNS;s++){MatrixUtil.buildMatrix(e,t,r,s,n);let c=this.calculateMaskPenalty(n);c<o&&(o=c,i=s)}return i}static chooseVersion(e,t){for(let r=1;r<=40;r++){const n=Version$1.getVersionForNumber(r);if(Encoder.willFit(e,n,t))return n}throw new WriterException("Data too big")}static willFit(e,t,r){return t.getTotalCodewords()-t.getECBlocksForLevel(r).getTotalECCodewords()>=(e+7)/8}static terminateBits(e,t){const r=8*e;if(t.getSize()>r)throw new WriterException("data bits cannot fit in the QR Code"+t.getSize()+" > "+r);for(let i=0;i<4&&t.getSize()<r;++i)t.appendBit(!1);const n=7&t.getSize();if(n>0)for(let i=n;i<8;i++)t.appendBit(!1);const o=e-t.getSizeInBytes();for(let i=0;i<o;++i)t.appendBits(1&i?17:236,8);if(t.getSize()!==r)throw new WriterException("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,r,n,o,i){if(n>=r)throw new WriterException("Block ID too large");const s=e%r,c=r-s,d=Math.floor(e/r),l=d+1,u=Math.floor(t/r),h=u+1,g=d-u,E=l-h;if(g!==E)throw new WriterException("EC bytes mismatch");if(r!==c+s)throw new WriterException("RS blocks mismatch");if(e!==(u+g)*c+(h+E)*s)throw new WriterException("Total bytes mismatch");n<c?(o[0]=u,i[0]=g):(o[0]=h,i[0]=E)}static interleaveWithECBytes(e,t,r,n){if(e.getSizeInBytes()!==r)throw new WriterException("Number of bits and data bytes does not match");let o=0,i=0,s=0;const c=new Array;for(let l=0;l<n;++l){const d=new Int32Array(1),u=new Int32Array(1);Encoder.getNumDataBytesAndNumECBytesForBlockID(t,r,n,l,d,u);const h=d[0],g=new Uint8Array(h);e.toBytes(8*o,g,0,h);const E=Encoder.generateECBytes(g,u[0]);c.push(new BlockPair(g,E)),i=Math.max(i,h),s=Math.max(s,E.length),o+=d[0]}if(r!==o)throw new WriterException("Data bytes does not match offset");const d=new BitArray;for(let l=0;l<i;++l)for(const e of c){const t=e.getDataBytes();l<t.length&&d.appendBits(t[l],8)}for(let l=0;l<s;++l)for(const e of c){const t=e.getErrorCorrectionBytes();l<t.length&&d.appendBits(t[l],8)}if(t!==d.getSizeInBytes())throw new WriterException("Interleaving error: "+t+" and "+d.getSizeInBytes()+" differ.");return d}static generateECBytes(e,t){const r=e.length,n=new Int32Array(r+t);for(let i=0;i<r;i++)n[i]=255&e[i];new ReedSolomonEncoder(GenericGF.QR_CODE_FIELD_256).encode(n,t);const o=new Uint8Array(t);for(let i=0;i<t;i++)o[i]=n[r+i];return o}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,r,n){const o=r.getCharacterCountBits(t);if(e>=1<<o)throw new WriterException(e+" is bigger than "+((1<<o)-1));n.appendBits(e,o)}static appendBytes(e,t,r,n){switch(t){case Mode$1.NUMERIC:Encoder.appendNumericBytes(e,r);break;case Mode$1.ALPHANUMERIC:Encoder.appendAlphanumericBytes(e,r);break;case Mode$1.BYTE:Encoder.append8BitBytes(e,r,n);break;case Mode$1.KANJI:Encoder.appendKanjiBytes(e,r);break;default:throw new WriterException("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=Encoder.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const r=e.length;let n=0;for(;n<r;){const o=Encoder.getDigit(e.charAt(n));if(n+2<r){const r=Encoder.getDigit(e.charAt(n+1)),i=Encoder.getDigit(e.charAt(n+2));t.appendBits(100*o+10*r+i,10),n+=3}else if(n+1<r){const r=Encoder.getDigit(e.charAt(n+1));t.appendBits(10*o+r,7),n+=2}else t.appendBits(o,4),n++}}static appendAlphanumericBytes(e,t){const r=e.length;let n=0;for(;n<r;){const o=Encoder.getAlphanumericCode(e.charCodeAt(n));if(-1===o)throw new WriterException;if(n+1<r){const r=Encoder.getAlphanumericCode(e.charCodeAt(n+1));if(-1===r)throw new WriterException;t.appendBits(45*o+r,11),n+=2}else t.appendBits(o,6),n++}}static append8BitBytes(e,t,r){let n;try{n=StringEncoding.encode(e,r)}catch(o){throw new WriterException(o)}for(let i=0,s=n.length;i!==s;i++){const e=n[i];t.appendBits(e,8)}}static appendKanjiBytes(e,t){let r;try{r=StringEncoding.encode(e,CharacterSetECI.SJIS)}catch(o){throw new WriterException(o)}const n=r.length;for(let i=0;i<n;i+=2){const e=(255&r[i])<<8&4294967295|255&r[i+1];let n=-1;if(e>=33088&&e<=40956?n=e-33088:e>=57408&&e<=60351&&(n=e-49472),-1===n)throw new WriterException("Invalid byte sequence");const o=192*(n>>8)+(255&n);t.appendBits(o,13)}}static appendECI(e,t){t.appendBits(Mode$1.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}Encoder.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Encoder.DEFAULT_BYTE_MODE_ENCODING=CharacterSetECI.UTF8.getName();class BrowserQRCodeSvgWriter{write(e,t,r,n=null){if(0===e.length)throw new IllegalArgumentException("Found empty contents");if(t<0||r<0)throw new IllegalArgumentException("Requested dimensions are too small: "+t+"x"+r);let o=ErrorCorrectionLevel.L,i=BrowserQRCodeSvgWriter.QUIET_ZONE_SIZE;null!==n&&(void 0!==n.get(A.ERROR_CORRECTION)&&(o=ErrorCorrectionLevel.fromString(n.get(A.ERROR_CORRECTION).toString())),void 0!==n.get(A.MARGIN)&&(i=Number.parseInt(n.get(A.MARGIN).toString(),10)));const s=Encoder.encode(e,o,n);return this.renderResult(s,t,r,i)}writeToDom(e,t,r,n,o=null){"string"==typeof e&&(e=document.querySelector(e));const i=this.write(t,r,n,o);e&&e.appendChild(i)}renderResult(e,t,r,n){const o=e.getMatrix();if(null===o)throw new IllegalStateException;const i=o.getWidth(),s=o.getHeight(),c=i+2*n,d=s+2*n,l=Math.max(t,c),u=Math.max(r,d),h=Math.min(Math.floor(l/c),Math.floor(u/d)),g=Math.floor((l-i*h)/2),E=Math.floor((u-s*h)/2),f=this.createSVGElement(l,u);for(let C=0,m=E;C<s;C++,m+=h)for(let e=0,t=g;e<i;e++,t+=h)if(1===o.get(e,C)){const e=this.createSvgRectElement(t,m,h,h);f.appendChild(e)}return f}createSVGElement(e,t){const r=document.createElementNS(BrowserQRCodeSvgWriter.SVG_NS,"svg");return r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"width",t.toString()),r}createSvgRectElement(e,t,r,n){const o=document.createElementNS(BrowserQRCodeSvgWriter.SVG_NS,"rect");return o.setAttributeNS(null,"x",e.toString()),o.setAttributeNS(null,"y",t.toString()),o.setAttributeNS(null,"height",r.toString()),o.setAttributeNS(null,"width",n.toString()),o.setAttributeNS(null,"fill","#000000"),o}}BrowserQRCodeSvgWriter.QUIET_ZONE_SIZE=4,BrowserQRCodeSvgWriter.SVG_NS="http://www.w3.org/2000/svg";class QRCodeWriter{encode(e,t,r,n,o){if(0===e.length)throw new IllegalArgumentException("Found empty contents");if(t!==d.QR_CODE)throw new IllegalArgumentException("Can only encode QR_CODE, but got "+t);if(r<0||n<0)throw new IllegalArgumentException(`Requested dimensions are too small: ${r}x${n}`);let i=ErrorCorrectionLevel.L,s=QRCodeWriter.QUIET_ZONE_SIZE;null!==o&&(void 0!==o.get(A.ERROR_CORRECTION)&&(i=ErrorCorrectionLevel.fromString(o.get(A.ERROR_CORRECTION).toString())),void 0!==o.get(A.MARGIN)&&(s=Number.parseInt(o.get(A.MARGIN).toString(),10)));const c=Encoder.encode(e,i,o);return QRCodeWriter.renderResult(c,r,n,s)}static renderResult(e,t,r,n){const o=e.getMatrix();if(null===o)throw new IllegalStateException;const i=o.getWidth(),s=o.getHeight(),c=i+2*n,d=s+2*n,l=Math.max(t,c),u=Math.max(r,d),h=Math.min(Math.floor(l/c),Math.floor(u/d)),g=Math.floor((l-i*h)/2),E=Math.floor((u-s*h)/2),f=new BitMatrix(l,u);for(let C=0,m=E;C<s;C++,m+=h)for(let e=0,t=g;e<i;e++,t+=h)1===o.get(e,C)&&f.setRegion(t,m,h,h);return f}}QRCodeWriter.QUIET_ZONE_SIZE=4;class MultiFormatWriter{encode(e,t,r,n,o){let i;if(t!==d.QR_CODE)throw new IllegalArgumentException("No encoder available for format "+t);return i=new QRCodeWriter,i.encode(e,t,r,n,o)}}class PlanarYUVLuminanceSource extends LuminanceSource{constructor(e,t,r,n,o,i,s,c){if(super(i,s),this.yuvData=e,this.dataWidth=t,this.dataHeight=r,this.left=n,this.top=o,n+i>t||o+s>r)throw new IllegalArgumentException("Crop rectangle does not fit within image data.");c&&this.reverseHorizontal(i,s)}getRow(e,t){if(e<0||e>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+e);const r=this.getWidth();(null==t||t.length<r)&&(t=new Uint8ClampedArray(r));const n=(e+this.top)*this.dataWidth+this.left;return System.arraycopy(this.yuvData,n,t,0,r),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const r=e*t,n=new Uint8ClampedArray(r);let o=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return System.arraycopy(this.yuvData,o,n,0,r),n;for(let i=0;i<t;i++){const t=i*e;System.arraycopy(this.yuvData,o,n,t,e),o+=this.dataWidth}return n}isCropSupported(){return!0}crop(e,t,r,n){return new PlanarYUVLuminanceSource(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,r,n,!1)}renderThumbnail(){const e=this.getWidth()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(e*t),n=this.yuvData;let o=this.top*this.dataWidth+this.left;for(let i=0;i<t;i++){const t=i*e;for(let i=0;i<e;i++){const e=255&n[o+i*PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR];r[t+i]=4278190080|65793*e}o+=this.dataWidth*PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const r=this.yuvData;for(let n=0,o=this.top*this.dataWidth+this.left;n<t;n++,o+=this.dataWidth){const t=o+e/2;for(let n=o,i=o+e-1;n<t;n++,i--){const e=r[n];r[n]=r[i],r[i]=e}}}invert(){return new InvertedLuminanceSource(this)}}PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR=2;class RGBLuminanceSource extends LuminanceSource{constructor(e,t,r,n,o,i,s){if(super(t,r),this.dataWidth=n,this.dataHeight=o,this.left=i,this.top=s,4===e.BYTES_PER_ELEMENT){const n=t*r,o=new Uint8ClampedArray(n);for(let t=0;t<n;t++){const r=e[t],n=r>>16&255,i=r>>7&510,s=255&r;o[t]=(n+i+s)/4&255}this.luminances=o}else this.luminances=e;if(void 0===n&&(this.dataWidth=t),void 0===o&&(this.dataHeight=r),void 0===i&&(this.left=0),void 0===s&&(this.top=0),this.left+t>this.dataWidth||this.top+r>this.dataHeight)throw new IllegalArgumentException("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+e);const r=this.getWidth();(null==t||t.length<r)&&(t=new Uint8ClampedArray(r));const n=(e+this.top)*this.dataWidth+this.left;return System.arraycopy(this.luminances,n,t,0,r),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const r=e*t,n=new Uint8ClampedArray(r);let o=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return System.arraycopy(this.luminances,o,n,0,r),n;for(let i=0;i<t;i++){const t=i*e;System.arraycopy(this.luminances,o,n,t,e),o+=this.dataWidth}return n}isCropSupported(){return!0}crop(e,t,r,n){return new RGBLuminanceSource(this.luminances,r,n,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new InvertedLuminanceSource(this)}}class Charset extends CharacterSetECI{static forName(e){return this.getCharacterSetECIByName(e)}}class StandardCharsets{}StandardCharsets.ISO_8859_1=CharacterSetECI.ISO8859_1;class AztecCode{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Collections{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class Token{constructor(e){this.previous=e}getPrevious(){return this.previous}}class SimpleToken extends Token{constructor(e,t,r){super(e),this.value=t,this.bitCount=r}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new SimpleToken(this,e,t)}addBinaryShift(start,e){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new SimpleToken(this,start,e)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+Integer.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class BinaryShiftToken extends SimpleToken{constructor(e,t,r){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=r}appendTo(e,t){for(let r=0;r<this.binaryShiftByteCount;r++)(0===r||31===r&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):0===r?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+r],8)}addBinaryShift(start,e){return new BinaryShiftToken(this,start,e)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function addBinaryShift(e,start,t){return new BinaryShiftToken(e,start,t)}function add(e,t,r){return new SimpleToken(e,t,r)}const S=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],w=0,I=1,R=2,_=3,D=4,B=new SimpleToken(null,0,0),y=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])];function static_SHIFT_TABLE(e){for(let t of e)Arrays.fill(t,-1);return e[w][D]=0,e[I][D]=0,e[I][w]=28,e[_][D]=0,e[R][D]=0,e[R][w]=15,e}const T=static_SHIFT_TABLE(Arrays.createInt32Array(6,6));class State{constructor(e,t,r,n){this.token=e,this.mode=t,this.binaryShiftByteCount=r,this.bitCount=n}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let r=this.bitCount,n=this.token;if(e!==this.mode){let t=y[this.mode][e];n=add(n,65535&t,t>>16),r+=t>>16}let o=e===R?4:5;return n=add(n,t,o),new State(n,e,0,r+o)}shiftAndAppend(e,t){let r=this.token,n=this.mode===R?4:5;return r=add(r,T[this.mode][e],n),r=add(r,t,5),new State(r,this.mode,0,this.bitCount+n+5)}addBinaryShiftChar(e){let t=this.token,r=this.mode,n=this.bitCount;if(this.mode===D||this.mode===R){let e=y[r][w];t=add(t,65535&e,e>>16),n+=e>>16,r=w}let o=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,i=new State(t,r,this.binaryShiftByteCount+1,n+o);return 2078===i.binaryShiftByteCount&&(i=i.endBinaryShift(e+1)),i}endBinaryShift(e){if(0===this.binaryShiftByteCount)return this;let t=this.token;return t=addBinaryShift(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new State(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(y[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=State.calculateBinaryShiftCost(e)-State.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let n=this.endBinaryShift(e.length).token;null!==n;n=n.getPrevious())t.unshift(n);let r=new BitArray;for(const n of t)n.appendTo(r,e);return r}toString(){return StringUtils.format("%s bits=%d bytes=%d",S[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}function static_CHAR_MAP(e){const t=StringUtils.getCharCode(" "),r=StringUtils.getCharCode("."),n=StringUtils.getCharCode(",");e[w][t]=1;const o=StringUtils.getCharCode("Z"),i=StringUtils.getCharCode("A");for(let g=i;g<=o;g++)e[w][g]=g-i+2;e[I][t]=1;const s=StringUtils.getCharCode("z"),c=StringUtils.getCharCode("a");for(let g=c;g<=s;g++)e[I][g]=g-c+2;e[R][t]=1;const d=StringUtils.getCharCode("9"),l=StringUtils.getCharCode("0");for(let g=l;g<=d;g++)e[R][g]=g-l+2;e[R][n]=12,e[R][r]=13;const u=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""];for(let g=0;g<u.length;g++)e[_][StringUtils.getCharCode(u[g])]=g;const h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let g=0;g<h.length;g++)StringUtils.getCharCode(h[g])>0&&(e[D][StringUtils.getCharCode(h[g])]=g);return e}State.INITIAL_STATE=new State(B,w,0,0);const N=static_CHAR_MAP(Arrays.createInt32Array(5,256));class HighLevelEncoder{constructor(e){this.text=e}encode(){const e=StringUtils.getCharCode(" "),t=StringUtils.getCharCode("\n");let r=Collections.singletonList(State.INITIAL_STATE);for(let n=0;n<this.text.length;n++){let o,i=n+1<this.text.length?this.text[n+1]:0;switch(this.text[n]){case StringUtils.getCharCode("\r"):o=i===t?2:0;break;case StringUtils.getCharCode("."):o=i===e?3:0;break;case StringUtils.getCharCode(","):o=i===e?4:0;break;case StringUtils.getCharCode(":"):o=i===e?5:0;break;default:o=0}o>0?(r=HighLevelEncoder.updateStateListForPair(r,n,o),n++):r=this.updateStateListForChar(r,n)}return Collections.min(r,(e,t)=>e.getBitCount()-t.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const r=[];for(let n of e)this.updateStateForChar(n,t,r);return HighLevelEncoder.simplifyStates(r)}updateStateForChar(e,t,r){let n=255&this.text[t],o=N[e.getMode()][n]>0,i=null;for(let s=0;s<=D;s++){let c=N[s][n];if(c>0){if(null==i&&(i=e.endBinaryShift(t)),!o||s===e.getMode()||s===R){const e=i.latchAndAppend(s,c);r.push(e)}if(!o&&T[e.getMode()][s]>=0){const e=i.shiftAndAppend(s,c);r.push(e)}}}if(e.getBinaryShiftByteCount()>0||0===N[e.getMode()][n]){let n=e.addBinaryShiftChar(t);r.push(n)}}static updateStateListForPair(e,t,r){const n=[];for(let o of e)this.updateStateForPair(o,t,r,n);return this.simplifyStates(n)}static updateStateForPair(e,t,r,n){let o=e.endBinaryShift(t);if(n.push(o.latchAndAppend(D,r)),e.getMode()!==D&&n.push(o.shiftAndAppend(D,r)),3===r||4===r){let e=o.latchAndAppend(R,16-r).latchAndAppend(R,1);n.push(e)}if(e.getBinaryShiftByteCount()>0){let r=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);n.push(r)}}static simplifyStates(e){let t=[];for(const r of e){let e=!0;for(const n of t){if(n.isBetterThanOrEqualTo(r)){e=!1;break}r.isBetterThanOrEqualTo(n)&&(t=t.filter(e=>e!==n))}e&&t.push(r)}return t}}class Encoder$1{constructor(){}static encodeBytes(e){return Encoder$1.encode(e,Encoder$1.DEFAULT_EC_PERCENT,Encoder$1.DEFAULT_AZTEC_LAYERS)}static encode(e,t,r){let n,o,i,s,c,d=new HighLevelEncoder(e).encode(),l=Integer.truncDivision(d.getSize()*t,100)+11,u=d.getSize()+l;if(r!==Encoder$1.DEFAULT_AZTEC_LAYERS){if(n=r<0,o=Math.abs(r),o>(n?Encoder$1.MAX_NB_BITS_COMPACT:Encoder$1.MAX_NB_BITS))throw new IllegalArgumentException(StringUtils.format("Illegal value %s for layers",r));i=Encoder$1.totalBitsInLayer(o,n),s=Encoder$1.WORD_SIZE[o];let e=i-i%s;if(c=Encoder$1.stuffBits(d,s),c.getSize()+l>e)throw new IllegalArgumentException("Data to large for user specified layer");if(n&&c.getSize()>64*s)throw new IllegalArgumentException("Data to large for user specified layer")}else{s=0,c=null;for(let e=0;;e++){if(e>Encoder$1.MAX_NB_BITS)throw new IllegalArgumentException("Data too large for an Aztec code");if(n=e<=3,o=n?e+1:e,i=Encoder$1.totalBitsInLayer(o,n),u>i)continue;null!=c&&s===Encoder$1.WORD_SIZE[o]||(s=Encoder$1.WORD_SIZE[o],c=Encoder$1.stuffBits(d,s));let t=i-i%s;if(!(n&&c.getSize()>64*s)&&c.getSize()+l<=t)break}}let h,g=Encoder$1.generateCheckWords(c,i,s),E=c.getSize()/s,f=Encoder$1.generateModeMessage(n,o,E),C=(n?11:14)+4*o,m=new Int32Array(C);if(n){h=C;for(let e=0;e<m.length;e++)m[e]=e}else{h=C+1+2*Integer.truncDivision(Integer.truncDivision(C,2)-1,15);let e=Integer.truncDivision(C,2),t=Integer.truncDivision(h,2);for(let r=0;r<e;r++){let n=r+Integer.truncDivision(r,15);m[e-r-1]=t-n-1,m[e+r]=t+n+1}}let p=new BitMatrix(h);for(let S=0,w=0;S<o;S++){let e=4*(o-S)+(n?9:12);for(let t=0;t<e;t++){let r=2*t;for(let n=0;n<2;n++)g.get(w+r+n)&&p.set(m[2*S+n],m[2*S+t]),g.get(w+2*e+r+n)&&p.set(m[2*S+t],m[C-1-2*S-n]),g.get(w+4*e+r+n)&&p.set(m[C-1-2*S-n],m[C-1-2*S-t]),g.get(w+6*e+r+n)&&p.set(m[C-1-2*S-t],m[2*S+n])}w+=8*e}if(Encoder$1.drawModeMessage(p,n,h,f),n)Encoder$1.drawBullsEye(p,Integer.truncDivision(h,2),5);else{Encoder$1.drawBullsEye(p,Integer.truncDivision(h,2),7);for(let e=0,t=0;e<Integer.truncDivision(C,2)-1;e+=15,t+=16)for(let r=1&Integer.truncDivision(h,2);r<h;r+=2)p.set(Integer.truncDivision(h,2)-t,r),p.set(Integer.truncDivision(h,2)+t,r),p.set(r,Integer.truncDivision(h,2)-t),p.set(r,Integer.truncDivision(h,2)+t)}let A=new AztecCode;return A.setCompact(n),A.setSize(h),A.setLayers(o),A.setCodeWords(E),A.setMatrix(p),A}static drawBullsEye(e,t,r){for(let n=0;n<r;n+=2)for(let r=t-n;r<=t+n;r++)e.set(r,t-n),e.set(r,t+n),e.set(t-n,r),e.set(t+n,r);e.set(t-r,t-r),e.set(t-r+1,t-r),e.set(t-r,t-r+1),e.set(t+r,t-r),e.set(t+r,t-r+1),e.set(t+r,t+r-1)}static generateModeMessage(e,t,r){let n=new BitArray;return e?(n.appendBits(t-1,2),n.appendBits(r-1,6),n=Encoder$1.generateCheckWords(n,28,4)):(n.appendBits(t-1,5),n.appendBits(r-1,11),n=Encoder$1.generateCheckWords(n,40,4)),n}static drawModeMessage(e,t,r,n){let o=Integer.truncDivision(r,2);if(t)for(let i=0;i<7;i++){let t=o-3+i;n.get(i)&&e.set(t,o-5),n.get(i+7)&&e.set(o+5,t),n.get(20-i)&&e.set(t,o+5),n.get(27-i)&&e.set(o-5,t)}else for(let i=0;i<10;i++){let t=o-5+i+Integer.truncDivision(i,5);n.get(i)&&e.set(t,o-7),n.get(i+10)&&e.set(o+7,t),n.get(29-i)&&e.set(t,o+7),n.get(39-i)&&e.set(o-7,t)}}static generateCheckWords(e,t,r){let n=e.getSize()/r,o=new ReedSolomonEncoder(Encoder$1.getGF(r)),i=Integer.truncDivision(t,r),s=Encoder$1.bitsToWords(e,r,i);o.encode(s,i-n);let c=t%r,d=new BitArray;d.appendBits(0,c);for(const l of Array.from(s))d.appendBits(l,r);return d}static bitsToWords(e,t,r){let n,o,i=new Int32Array(r);for(n=0,o=e.getSize()/t;n<o;n++){let r=0;for(let o=0;o<t;o++)r|=e.get(n*t+o)?1<<t-o-1:0;i[n]=r}return i}static getGF(e){switch(e){case 4:return GenericGF.AZTEC_PARAM;case 6:return GenericGF.AZTEC_DATA_6;case 8:return GenericGF.AZTEC_DATA_8;case 10:return GenericGF.AZTEC_DATA_10;case 12:return GenericGF.AZTEC_DATA_12;default:throw new IllegalArgumentException("Unsupported word size "+e)}}static stuffBits(e,t){let r=new BitArray,n=e.getSize(),o=(1<<t)-2;for(let i=0;i<n;i+=t){let s=0;for(let r=0;r<t;r++)(i+r>=n||e.get(i+r))&&(s|=1<<t-1-r);(s&o)===o?(r.appendBits(s&o,t),i--):0===(s&o)?(r.appendBits(1|s,t),i--):r.appendBits(s,t)}return r}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Encoder$1.DEFAULT_EC_PERCENT=33,Encoder$1.DEFAULT_AZTEC_LAYERS=0,Encoder$1.MAX_NB_BITS=32,Encoder$1.MAX_NB_BITS_COMPACT=4,Encoder$1.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class AztecWriter{encode(e,t,r,n){return this.encodeWithHints(e,t,r,n,null)}encodeWithHints(e,t,r,n,o){let i=StandardCharsets.ISO_8859_1,s=Encoder$1.DEFAULT_EC_PERCENT,c=Encoder$1.DEFAULT_AZTEC_LAYERS;return null!=o&&(o.has(A.CHARACTER_SET)&&(i=Charset.forName(o.get(A.CHARACTER_SET).toString())),o.has(A.ERROR_CORRECTION)&&(s=Integer.parseInt(o.get(A.ERROR_CORRECTION).toString())),o.has(A.AZTEC_LAYERS)&&(c=Integer.parseInt(o.get(A.AZTEC_LAYERS).toString()))),AztecWriter.encodeLayers(e,t,r,n,i,s,c)}static encodeLayers(e,t,r,n,o,i,s){if(t!==d.AZTEC)throw new IllegalArgumentException("Can only encode AZTEC, but got "+t);let c=Encoder$1.encode(StringUtils.getBytes(e,o),i,s);return AztecWriter.renderResult(c,r,n)}static renderResult(e,t,r){let n=e.getMatrix();if(null==n)throw new IllegalStateException;let o=n.getWidth(),i=n.getHeight(),s=Math.max(t,o),c=Math.max(r,i),d=Math.min(s/o,c/i),l=(s-o*d)/2,u=(c-i*d)/2,h=new BitMatrix(s,c);for(let g=0,E=u;g<i;g++,E+=d)for(let e=0,t=l;e<o;e++,t+=d)n.get(e,g)&&h.setRegion(t,E,d,d);return h}}e.AbstractExpandedDecoder=AbstractExpandedDecoder,e.ArgumentException=ArgumentException,e.ArithmeticException=ArithmeticException,e.AztecCode=AztecCode,e.AztecCodeReader=AztecReader,e.AztecCodeWriter=AztecWriter,e.AztecDecoder=Decoder,e.AztecDetector=Detector,e.AztecDetectorResult=AztecDetectorResult,e.AztecEncoder=Encoder$1,e.AztecHighLevelEncoder=HighLevelEncoder,e.AztecPoint=Point,e.BarcodeFormat=d,e.Binarizer=Binarizer,e.BinaryBitmap=BinaryBitmap,e.BitArray=BitArray,e.BitMatrix=BitMatrix,e.BitSource=BitSource,e.BrowserAztecCodeReader=BrowserAztecCodeReader,e.BrowserBarcodeReader=BrowserBarcodeReader,e.BrowserCodeReader=BrowserCodeReader,e.BrowserDatamatrixCodeReader=BrowserDatamatrixCodeReader,e.BrowserMultiFormatReader=BrowserMultiFormatReader,e.BrowserPDF417Reader=BrowserPDF417Reader,e.BrowserQRCodeReader=BrowserQRCodeReader,e.BrowserQRCodeSvgWriter=BrowserQRCodeSvgWriter,e.CharacterSetECI=CharacterSetECI,e.ChecksumException=ChecksumException,e.Code128Reader=Code128Reader,e.Code39Reader=Code39Reader,e.DataMatrixDecodedBitStreamParser=DecodedBitStreamParser,e.DataMatrixReader=DataMatrixReader,e.DecodeHintType=i,e.DecoderResult=DecoderResult,e.DefaultGridSampler=DefaultGridSampler,e.DetectorResult=DetectorResult,e.EAN13Reader=EAN13Reader,e.EncodeHintType=A,e.Exception=Exception,e.FormatException=FormatException,e.GenericGF=GenericGF,e.GenericGFPoly=GenericGFPoly,e.GlobalHistogramBinarizer=GlobalHistogramBinarizer,e.GridSampler=GridSampler,e.GridSamplerInstance=GridSamplerInstance,e.HTMLCanvasElementLuminanceSource=HTMLCanvasElementLuminanceSource,e.HybridBinarizer=HybridBinarizer,e.ITFReader=ITFReader,e.IllegalArgumentException=IllegalArgumentException,e.IllegalStateException=IllegalStateException,e.InvertedLuminanceSource=InvertedLuminanceSource,e.LuminanceSource=LuminanceSource,e.MathUtils=MathUtils,e.MultiFormatOneDReader=MultiFormatOneDReader,e.MultiFormatReader=MultiFormatReader,e.MultiFormatWriter=MultiFormatWriter,e.NotFoundException=NotFoundException,e.OneDReader=OneDReader,e.PDF417DecodedBitStreamParser=DecodedBitStreamParser$2,e.PDF417DecoderErrorCorrection=ErrorCorrection,e.PDF417Reader=PDF417Reader,e.PDF417ResultMetadata=PDF417ResultMetadata,e.PerspectiveTransform=PerspectiveTransform,e.PlanarYUVLuminanceSource=PlanarYUVLuminanceSource,e.QRCodeByteMatrix=ByteMatrix,e.QRCodeDataMask=DataMask,e.QRCodeDecodedBitStreamParser=DecodedBitStreamParser$1,e.QRCodeDecoderErrorCorrectionLevel=ErrorCorrectionLevel,e.QRCodeDecoderFormatInformation=FormatInformation,e.QRCodeEncoder=Encoder,e.QRCodeEncoderQRCode=QRCode,e.QRCodeMaskUtil=MaskUtil,e.QRCodeMatrixUtil=MatrixUtil,e.QRCodeMode=Mode$1,e.QRCodeReader=QRCodeReader,e.QRCodeVersion=Version$1,e.QRCodeWriter=QRCodeWriter,e.RGBLuminanceSource=RGBLuminanceSource,e.RSS14Reader=RSS14Reader,e.RSSExpandedReader=RSSExpandedReader,e.ReaderException=ReaderException,e.ReedSolomonDecoder=ReedSolomonDecoder,e.ReedSolomonEncoder=ReedSolomonEncoder,e.ReedSolomonException=ReedSolomonException,e.Result=Result,e.ResultMetadataType=C,e.ResultPoint=ResultPoint,e.StringUtils=StringUtils,e.UnsupportedOperationException=UnsupportedOperationException,e.VideoInputDevice=VideoInputDevice,e.WhiteRectangleDetector=WhiteRectangleDetector,e.WriterException=WriterException,e.ZXingArrays=Arrays,e.ZXingCharset=Charset,e.ZXingInteger=Integer,e.ZXingStandardCharsets=StandardCharsets,e.ZXingStringBuilder=StringBuilder,e.ZXingStringEncoding=StringEncoding,e.ZXingSystem=System,e.createAbstractExpandedDecoder=createDecoder,Object.defineProperty(e,"__esModule",{value:!0})}(h.exports);var g=h.exports;const E=_mergeNamespaces({__proto__:null,default:getDefaultExportFromCjs(g)},[g]);var f,C,m=function(){function ZXingHtml5QrcodeDecoder(e,t,r){if(this.formatMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,g.BarcodeFormat.QR_CODE],[Html5QrcodeSupportedFormats.AZTEC,g.BarcodeFormat.AZTEC],[Html5QrcodeSupportedFormats.CODABAR,g.BarcodeFormat.CODABAR],[Html5QrcodeSupportedFormats.CODE_39,g.BarcodeFormat.CODE_39],[Html5QrcodeSupportedFormats.CODE_93,g.BarcodeFormat.CODE_93],[Html5QrcodeSupportedFormats.CODE_128,g.BarcodeFormat.CODE_128],[Html5QrcodeSupportedFormats.DATA_MATRIX,g.BarcodeFormat.DATA_MATRIX],[Html5QrcodeSupportedFormats.MAXICODE,g.BarcodeFormat.MAXICODE],[Html5QrcodeSupportedFormats.ITF,g.BarcodeFormat.ITF],[Html5QrcodeSupportedFormats.EAN_13,g.BarcodeFormat.EAN_13],[Html5QrcodeSupportedFormats.EAN_8,g.BarcodeFormat.EAN_8],[Html5QrcodeSupportedFormats.PDF_417,g.BarcodeFormat.PDF_417],[Html5QrcodeSupportedFormats.RSS_14,g.BarcodeFormat.RSS_14],[Html5QrcodeSupportedFormats.RSS_EXPANDED,g.BarcodeFormat.RSS_EXPANDED],[Html5QrcodeSupportedFormats.UPC_A,g.BarcodeFormat.UPC_A],[Html5QrcodeSupportedFormats.UPC_E,g.BarcodeFormat.UPC_E],[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,g.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!E)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=r;var n=this.createZXingFormats(e),o=new Map;o.set(g.DecodeHintType.POSSIBLE_FORMATS,n),o.set(g.DecodeHintType.TRY_HARDER,!1),this.hints=o}return ZXingHtml5QrcodeDecoder.prototype.decodeAsync=function(e){var t=this;return new Promise(function(r,n){try{r(t.decode(e))}catch(o){n(o)}})},ZXingHtml5QrcodeDecoder.prototype.decode=function(e){var t=new g.MultiFormatReader(this.verbose,this.hints),r=new g.HTMLCanvasElementLuminanceSource(e),n=new g.BinaryBitmap(new g.HybridBinarizer(r)),o=t.decode(n);return{text:o.text,format:s.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}},ZXingHtml5QrcodeDecoder.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,r,n){e.set(t,r)}),e},ZXingHtml5QrcodeDecoder.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},ZXingHtml5QrcodeDecoder.prototype.createZXingFormats=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var o=n[r];this.formatMap.has(o)?t.push(this.formatMap.get(o)):this.logger.logError("".concat(o," is not supported by")+"ZXingHtml5QrcodeShim")}return t},ZXingHtml5QrcodeDecoder.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},ZXingHtml5QrcodeDecoder}(),__awaiter$4=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function fulfilled(e){try{step(n.next(e))}catch(t){i(t)}}function rejected(e){try{step(n.throw(e))}catch(t){i(t)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})},__generator$4=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(c){return function(d){return function step(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(d){c=[6,d],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},p=function(){function BarcodeDetectorDelegate(e,t,r){if(this.formatMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,"qr_code"],[Html5QrcodeSupportedFormats.AZTEC,"aztec"],[Html5QrcodeSupportedFormats.CODABAR,"codabar"],[Html5QrcodeSupportedFormats.CODE_39,"code_39"],[Html5QrcodeSupportedFormats.CODE_93,"code_93"],[Html5QrcodeSupportedFormats.CODE_128,"code_128"],[Html5QrcodeSupportedFormats.DATA_MATRIX,"data_matrix"],[Html5QrcodeSupportedFormats.ITF,"itf"],[Html5QrcodeSupportedFormats.EAN_13,"ean_13"],[Html5QrcodeSupportedFormats.EAN_8,"ean_8"],[Html5QrcodeSupportedFormats.PDF_417,"pdf417"],[Html5QrcodeSupportedFormats.UPC_A,"upc_a"],[Html5QrcodeSupportedFormats.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!BarcodeDetectorDelegate.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=r;var n=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(n),!this.detector)throw"BarcodeDetector detector not supported"}return BarcodeDetectorDelegate.isSupported=function(){return"BarcodeDetector"in window&&void 0!==new BarcodeDetector({formats:["qr_code"]})},BarcodeDetectorDelegate.prototype.decodeAsync=function(e){return __awaiter$4(this,void 0,void 0,function(){var t,r;return __generator$4(this,function(n){switch(n.label){case 0:return[4,this.detector.detect(e)];case 1:if(!(t=n.sent())||0===t.length)throw"No barcode or QR code detected.";return[2,{text:(r=this.selectLargestBarcode(t)).rawValue,format:s.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},BarcodeDetectorDelegate.prototype.selectLargestBarcode=function(e){for(var t=null,r=0,n=0,o=e;n<o.length;n++){var i=o[n],s=i.boundingBox.width*i.boundingBox.height;s>r&&(r=s,t=i)}if(!t)throw"No largest barcode found";return t},BarcodeDetectorDelegate.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var o=n[r];this.formatMap.has(o)?t.push(this.formatMap.get(o)):this.logger.warn("".concat(o," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},BarcodeDetectorDelegate.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},BarcodeDetectorDelegate.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,r,n){e.set(t,r)}),e},BarcodeDetectorDelegate.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},BarcodeDetectorDelegate}(),__awaiter$3=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function fulfilled(e){try{step(n.next(e))}catch(t){i(t)}}function rejected(e){try{step(n.throw(e))}catch(t){i(t)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})},__generator$3=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(c){return function(d){return function step(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(d){c=[6,d],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},A=function(){function Html5QrcodeShim(e,t,r,n){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,t&&p.isSupported()?(this.primaryDecoder=new p(e,r,n),this.secondaryDecoder=new m(e,r,n)):this.primaryDecoder=new m(e,r,n)}return Html5QrcodeShim.prototype.decodeAsync=function(e){return __awaiter$3(this,void 0,void 0,function(){var t;return __generator$3(this,function(r){switch(r.label){case 0:t=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},Html5QrcodeShim.prototype.decodeRobustlyAsync=function(e){return __awaiter$3(this,void 0,void 0,function(){var t,r;return __generator$3(this,function(n){switch(n.label){case 0:t=performance.now(),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,n.sent()];case 3:if(r=n.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw r;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},Html5QrcodeShim.prototype.getDecoder=function(){return this.secondaryDecoder?!1===this.wasPrimaryDecoderUsedInLastDecode?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},Html5QrcodeShim.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},Html5QrcodeShim.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,r=this.executionResults;t<r.length;t++)e+=r[t];var n=e/this.executionResults.length;console.log("".concat(n," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},Html5QrcodeShim}(),S=(f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},f(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),__awaiter$2=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function fulfilled(e){try{step(n.next(e))}catch(t){i(t)}}function rejected(e){try{step(n.throw(e))}catch(t){i(t)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})},__generator$2=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(c){return function(d){return function step(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(d){c=[6,d],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},w=function(){function AbstractCameraCapability(e,t){this.name=e,this.track=t}return AbstractCameraCapability.prototype.isSupported=function(){return!!this.track.getCapabilities&&this.name in this.track.getCapabilities()},AbstractCameraCapability.prototype.apply=function(e){var t={};t[this.name]=e;var r={advanced:[t]};return this.track.applyConstraints(r)},AbstractCameraCapability.prototype.value=function(){var e=this.track.getSettings();return this.name in e?e[this.name]:null},AbstractCameraCapability}(),I=function(e){function ZoomFeatureImpl(t){return e.call(this,"zoom",t)||this}return S(ZoomFeatureImpl,e),ZoomFeatureImpl}(function(e){function AbstractRangeCameraCapability(t,r){return e.call(this,t,r)||this}return S(AbstractRangeCameraCapability,e),AbstractRangeCameraCapability.prototype.min=function(){return this.getCapabilities().min},AbstractRangeCameraCapability.prototype.max=function(){return this.getCapabilities().max},AbstractRangeCameraCapability.prototype.step=function(){return this.getCapabilities().step},AbstractRangeCameraCapability.prototype.apply=function(e){var t={};t[this.name]=e;var r={advanced:[t]};return this.track.applyConstraints(r)},AbstractRangeCameraCapability.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities()[this.name];return{min:e.min,max:e.max,step:e.step}},AbstractRangeCameraCapability.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},AbstractRangeCameraCapability}(w)),R=function(e){function TorchFeatureImpl(t){return e.call(this,"torch",t)||this}return S(TorchFeatureImpl,e),TorchFeatureImpl}(w),_=function(){function CameraCapabilitiesImpl(e){this.track=e}return CameraCapabilitiesImpl.prototype.zoomFeature=function(){return new I(this.track)},CameraCapabilitiesImpl.prototype.torchFeature=function(){return new R(this.track)},CameraCapabilitiesImpl}(),D=function(){function RenderedCameraImpl(e,t,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return RenderedCameraImpl.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},RenderedCameraImpl.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var onVideoStart=function(){var t=e.surface.clientWidth,r=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(t,r),e.surface.removeEventListener("playing",onVideoStart)};this.surface.addEventListener("playing",onVideoStart),this.surface.srcObject=this.mediaStream,this.surface.play()},RenderedCameraImpl.create=function(e,t,r,n){return __awaiter$2(this,void 0,void 0,function(){var o,i;return __generator$2(this,function(s){switch(s.label){case 0:return o=new RenderedCameraImpl(e,t,n),r.aspectRatio?(i={aspectRatio:r.aspectRatio},[4,o.getFirstTrackOrFail().applyConstraints(i)]):[3,2];case 1:s.sent(),s.label=2;case 2:return o.setupSurface(),[2,o]}})})},RenderedCameraImpl.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},RenderedCameraImpl.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),0===this.mediaStream.getVideoTracks().length)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},RenderedCameraImpl.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},RenderedCameraImpl.prototype.resume=function(e){this.failIfClosed();var t=this,onVideoResume=function(){setTimeout(e,200),t.surface.removeEventListener("playing",onVideoResume)};this.surface.addEventListener("playing",onVideoResume),this.surface.play()},RenderedCameraImpl.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},RenderedCameraImpl.prototype.getSurface=function(){return this.failIfClosed(),this.surface},RenderedCameraImpl.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},RenderedCameraImpl.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},RenderedCameraImpl.prototype.applyVideoConstraints=function(e){return __awaiter$2(this,void 0,void 0,function(){return __generator$2(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},RenderedCameraImpl.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,r){var n=e.mediaStream.getVideoTracks().length,o=0;e.mediaStream.getVideoTracks().forEach(function(r){e.mediaStream.removeTrack(r),r.stop(),++o>=n&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},RenderedCameraImpl.prototype.getCapabilities=function(){return new _(this.getFirstTrackOrFail())},RenderedCameraImpl}(),B=function(){function CameraImpl(e){this.mediaStream=e}return CameraImpl.prototype.render=function(e,t,r){return __awaiter$2(this,void 0,void 0,function(){return __generator$2(this,function(n){return[2,D.create(e,this.mediaStream,t,r)]})})},CameraImpl.create=function(e){return __awaiter$2(this,void 0,void 0,function(){var t;return __generator$2(this,function(r){switch(r.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return[2,new CameraImpl(r.sent())]}})})},CameraImpl}(),__awaiter$1=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function fulfilled(e){try{step(n.next(e))}catch(t){i(t)}}function rejected(e){try{step(n.throw(e))}catch(t){i(t)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})},__generator$1=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(c){return function(d){return function step(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(d){c=[6,d],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},y=function(){function CameraFactory(){}return CameraFactory.failIfNotSupported=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new CameraFactory]})})},CameraFactory.prototype.create=function(e){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(t){return[2,B.create(e)]})})},CameraFactory}(),__awaiter=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function fulfilled(e){try{step(n.next(e))}catch(t){i(t)}}function rejected(e){try{step(n.throw(e))}catch(t){i(t)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})},__generator=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(c){return function(d){return function step(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,n=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(d){c=[6,d],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},T=function(){function CameraRetriever(){}return CameraRetriever.retrieve=function(){if(navigator.mediaDevices)return CameraRetriever.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?CameraRetriever.getCamerasFromMediaStreamTrack():CameraRetriever.rejectWithError()},CameraRetriever.rejectWithError=function(){var e=l.unableToQuerySupportedDevices();return CameraRetriever.isHttpsOrLocalhost()||(e=l.insecureContextCameraQueryError()),Promise.reject(e)},CameraRetriever.isHttpsOrLocalhost=function(){if("https:"===location.protocol)return!0;var e=location.host.split(":")[0];return"127.0.0.1"===e||"localhost"===e},CameraRetriever.getCamerasFromMediaDevices=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r,n,o,i,s;return __generator(this,function(c){switch(c.label){case 0:return e=function(e){for(var t=0,r=e.getVideoTracks();t<r.length;t++){var n=r[t];n.enabled=!1,n.stop(),e.removeTrack(n)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=c.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=c.sent(),n=[],o=0,i=r;o<i.length;o++)"videoinput"===(s=i[o]).kind&&n.push({id:s.deviceId,label:s.label});return e(t),[2,n]}})})},CameraRetriever.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){MediaStreamTrack.getSources(function(t){for(var r=[],n=0,o=t;n<o.length;n++){var i=o[n];"video"===i.kind&&r.push({id:i.id,label:i.label})}e(r)})})},CameraRetriever}();!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"}(C||(C={}));var N,P=function(){function StateManagerImpl(){this.state=C.NOT_STARTED,this.onGoingTransactionNewState=C.UNKNOWN}return StateManagerImpl.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},StateManagerImpl.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},StateManagerImpl.prototype.execute=function(){if(this.onGoingTransactionNewState===C.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=C.UNKNOWN,this.directTransition(e)},StateManagerImpl.prototype.cancel=function(){if(this.onGoingTransactionNewState===C.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=C.UNKNOWN},StateManagerImpl.prototype.getState=function(){return this.state},StateManagerImpl.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==C.UNKNOWN)throw"Cannot transition to a new state, already under transition"},StateManagerImpl.prototype.validateTransition=function(e){switch(this.state){case C.UNKNOWN:throw"Transition from unknown is not allowed";case C.NOT_STARTED:this.failIfNewStateIs(e,[C.PAUSED]);case C.SCANNING:case C.PAUSED:}},StateManagerImpl.prototype.failIfNewStateIs=function(e,t){for(var r=0,n=t;r<n.length;r++)if(e===n[r])throw"Cannot transition from ".concat(this.state," to ").concat(e)},StateManagerImpl}(),M=function(){function StateManagerProxy(e){this.stateManager=e}return StateManagerProxy.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},StateManagerProxy.prototype.directTransition=function(e){this.stateManager.directTransition(e)},StateManagerProxy.prototype.getState=function(){return this.stateManager.getState()},StateManagerProxy.prototype.canScanFile=function(){return this.stateManager.getState()===C.NOT_STARTED},StateManagerProxy.prototype.isScanning=function(){return this.stateManager.getState()!==C.NOT_STARTED},StateManagerProxy.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===C.SCANNING},StateManagerProxy.prototype.isPaused=function(){return this.stateManager.getState()===C.PAUSED},StateManagerProxy}(),O=function(){function StateManagerFactory(){}return StateManagerFactory.create=function(){return new M(new P)},StateManagerFactory}(),b=function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},extendStatics(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),F=function(e){function Constants(){return null!==e&&e.apply(this,arguments)||this}return b(Constants,e),Constants.DEFAULT_WIDTH=300,Constants.DEFAULT_WIDTH_OFFSET=2,Constants.FILE_SCAN_MIN_HEIGHT=300,Constants.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,Constants.MIN_QR_BOX_SIZE=50,Constants.SHADED_LEFT=1,Constants.SHADED_RIGHT=2,Constants.SHADED_TOP=3,Constants.SHADED_BOTTOM=4,Constants.SHADED_REGION_ELEMENT_ID="qr-shaded-region",Constants.VERBOSE=!1,Constants.BORDER_SHADER_DEFAULT_COLOR="#ffffff",Constants.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",Constants}(i),x=function(){function InternalHtml5QrcodeConfig(e,t){this.logger=t,this.fps=F.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=!0===e.disableFlip,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=F.DEFAULT_DISABLE_FLIP}return InternalHtml5QrcodeConfig.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?u.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},InternalHtml5QrcodeConfig.prototype.isShadedBoxEnabled=function(){return!isNullOrUndefined(this.qrbox)},InternalHtml5QrcodeConfig.create=function(e,t){return new InternalHtml5QrcodeConfig(e,t)},InternalHtml5QrcodeConfig}();e("b",function(){function Html5Qrcode(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");var r;this.elementId=e,this.verbose=!1,"boolean"==typeof t?this.verbose=!0===t:t&&(r=t,this.verbose=!0===r.verbose,r.experimentalFeatures),this.logger=new d(this.verbose),this.qrcode=new A(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=O.create()}return Html5Qrcode.prototype.start=function(e,t,r,n){var o,i=this;if(!e)throw"cameraIdOrConfig is required";if(!r||"function"!=typeof r)throw"qrCodeSuccessCallback is required and should be a function.";o=n||(this.verbose?this.logger.log:function(){});var s=x.create(t,this.logger);this.clearElement();var c=!1;s.videoConstraints&&(s.isMediaStreamConstraintsValid()?c=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var d=c,u=document.getElementById(this.elementId);u.clientWidth?u.clientWidth:F.DEFAULT_WIDTH,u.style.position="relative",this.shouldScan=!0,this.element=u;var h=this,g=this.stateManagerProxy.startTransition(C.SCANNING);return new Promise(function(t,n){var c=d?s.videoConstraints:h.createVideoConstraints(e);if(!c)return g.cancel(),void n("videoConstraints should be defined");var u={};d&&!s.aspectRatio||(u.aspectRatio=s.aspectRatio);var E={onRenderSurfaceReady:function(e,t){h.setupUi(e,t,s),h.isScanning=!0,h.foreverScan(s,r,o)}};y.failIfNotSupported().then(function(e){e.create(c).then(function(e){return e.render(i.element,u,E).then(function(e){h.renderedCamera=e,g.execute(),t(null)}).catch(function(e){g.cancel(),n(e)})}).catch(function(e){g.cancel(),n(l.errorGettingUserMedia(e))})}).catch(function(e){g.cancel(),n(l.cameraStreamingNotSupported())})})},Html5Qrcode.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(C.PAUSED),this.showPausedState(),(isNullOrUndefined(e)||!0!==e)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},Html5Qrcode.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,transitionToScanning=function(){e.stateManagerProxy.directTransition(C.SCANNING),e.hidePausedState()};this.renderedCamera.isPaused()?this.renderedCamera.resume(function(){transitionToScanning()}):transitionToScanning()},Html5Qrcode.prototype.getState=function(){return this.stateManagerProxy.getState()},Html5Qrcode.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(C.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=this;return this.renderedCamera.close().then(function(){return r.renderedCamera=null,r.element&&(r.element.removeChild(r.canvasElement),r.canvasElement=null),function(){if(e.element){var t=document.getElementById(F.SHADED_REGION_ELEMENT_ID);t&&e.element.removeChild(t)}}(),r.qrRegion&&(r.qrRegion=null),r.context&&(r.context=null),t.execute(),r.hidePausedState(),r.isScanning=!1,Promise.resolve()})},Html5Qrcode.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(e){return e.decodedText})},Html5Qrcode.prototype.scanFileV2=function(e,t){var r=this;if(!(e&&e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(isNullOrUndefined(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(n,o){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(e);var i=new Image;i.onload=function(){var e=i.width,s=i.height,d=document.getElementById(r.elementId),l=d.clientWidth?d.clientWidth:F.DEFAULT_WIDTH,u=Math.max(d.clientHeight?d.clientHeight:s,F.FILE_SCAN_MIN_HEIGHT),h=r.computeCanvasDrawConfig(e,s,l,u);if(t){var g=r.createCanvasElement(l,u,"qr-canvas-visible");g.style.display="inline-block",d.appendChild(g);var E=g.getContext("2d");if(!E)throw"Unable to get 2d context from canvas";E.canvas.width=l,E.canvas.height=u,E.drawImage(i,0,0,e,s,h.x,h.y,h.width,h.height)}var f=F.FILE_SCAN_HIDDEN_CANVAS_PADDING,C=Math.max(i.width,h.width),m=Math.max(i.height,h.height),p=C+2*f,A=m+2*f,S=r.createCanvasElement(p,A);d.appendChild(S);var w=S.getContext("2d");if(!w)throw"Unable to get 2d context from canvas";w.canvas.width=p,w.canvas.height=A,w.drawImage(i,0,0,e,s,f,f,C,m);try{r.qrcode.decodeRobustlyAsync(S).then(function(e){n(c.createFromQrcodeResult(e))}).catch(o)}catch(I){o("QR code parse error, error = ".concat(I))}},i.onerror=o,i.onabort=o,i.onstalled=o,i.onsuspend=o,i.src=URL.createObjectURL(e)})},Html5Qrcode.prototype.clear=function(){this.clearElement()},Html5Qrcode.getCameras=function(){return T.retrieve()},Html5Qrcode.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},Html5Qrcode.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},Html5Qrcode.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},Html5Qrcode.prototype.applyVideoConstraints=function(e){if(!e)throw"videoConstaints is required argument.";if(!u.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},Html5Qrcode.prototype.getRenderedCameraOrFail=function(){if(null==this.renderedCamera)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},Html5Qrcode.prototype.getSupportedFormats=function(e){var t=[Html5QrcodeSupportedFormats.QR_CODE,Html5QrcodeSupportedFormats.AZTEC,Html5QrcodeSupportedFormats.CODABAR,Html5QrcodeSupportedFormats.CODE_39,Html5QrcodeSupportedFormats.CODE_93,Html5QrcodeSupportedFormats.CODE_128,Html5QrcodeSupportedFormats.DATA_MATRIX,Html5QrcodeSupportedFormats.MAXICODE,Html5QrcodeSupportedFormats.ITF,Html5QrcodeSupportedFormats.EAN_13,Html5QrcodeSupportedFormats.EAN_8,Html5QrcodeSupportedFormats.PDF_417,Html5QrcodeSupportedFormats.RSS_14,Html5QrcodeSupportedFormats.RSS_EXPANDED,Html5QrcodeSupportedFormats.UPC_A,Html5QrcodeSupportedFormats.UPC_E,Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION];if(!e||"boolean"==typeof e)return t;if(!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(0===e.formatsToSupport.length)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],n=0,o=e.formatsToSupport;n<o.length;n++){var i=o[n];isValidHtml5QrcodeSupportedFormats(i)?r.push(i):this.logger.warn("Invalid format: ".concat(i," passed in config, ignoring."))}if(0===r.length)throw"None of formatsToSupport match supported values.";return r},Html5Qrcode.prototype.getUseBarCodeDetectorIfSupported=function(e){if(isNullOrUndefined(e))return!0;if(!isNullOrUndefined(e.useBarCodeDetectorIfSupported))return!1!==e.useBarCodeDetectorIfSupported;if(isNullOrUndefined(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return!!isNullOrUndefined(t.useBarCodeDetectorIfSupported)||!1!==t.useBarCodeDetectorIfSupported},Html5Qrcode.prototype.validateQrboxSize=function(e,t,r){var n=this,o=r.qrbox;this.validateQrboxConfig(o);var i,s=this.toQrdimensions(e,t,o),validateMinSize=function(e){if(e<F.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(F.MIN_QR_BOX_SIZE,"px.")};validateMinSize(s.width),validateMinSize(s.height),s.width=((i=s.width)>e&&(n.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),i=e),i)},Html5Qrcode.prototype.validateQrboxConfig=function(e){if("number"!=typeof e&&"function"!=typeof e&&(void 0===e.width||void 0===e.height))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},Html5Qrcode.prototype.toQrdimensions=function(e,t,r){if("number"==typeof r)return{width:r,height:r};if("function"==typeof r)try{return r(e,t)}catch(n){throw new Error("qrbox config was passed as a function but it failed with unknown error"+n)}return r},Html5Qrcode.prototype.setupUi=function(e,t,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,r);var n=isNullOrUndefined(r.qrbox)?{width:e,height:t}:r.qrbox;this.validateQrboxConfig(n);var o=this.toQrdimensions(e,t,n);o.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var i=r.isShadedBoxEnabled()&&o.height<=t,s={x:0,y:0,width:e,height:t},c=i?this.getShadedRegionBounds(e,t,o):s,d=this.createCanvasElement(c.width,c.height),l=d.getContext("2d",{willReadFrequently:!0});l.canvas.width=c.width,l.canvas.height=c.height,this.element.append(d),i&&this.possiblyInsertShadingElement(this.element,e,t,o),this.createScannerPausedUiElement(this.element),this.qrRegion=c,this.context=l,this.canvasElement=d},Html5Qrcode.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=l.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},Html5Qrcode.prototype.scanContext=function(e,t){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(t){return e(t.text,c.createFromQrcodeResult(t)),r.possiblyUpdateShaders(!0),!0}).catch(function(e){r.possiblyUpdateShaders(!1);var n=l.codeParseError(e);return t(n,Html5QrcodeErrorFactory.createFrom(n)),!1})},Html5Qrcode.prototype.foreverScan=function(e,t,r){var n=this;if(this.shouldScan&&this.renderedCamera){var o=this.renderedCamera.getSurface(),i=o.videoWidth/o.clientWidth,s=o.videoHeight/o.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var c=this.qrRegion.width*i,d=this.qrRegion.height*s,l=this.qrRegion.x*i,u=this.qrRegion.y*s;this.context.drawImage(o,l,u,c,d,0,0,this.qrRegion.width,this.qrRegion.height);var triggerNextScan=function(){n.foreverScanTimeout=setTimeout(function(){n.foreverScan(e,t,r)},n.getTimeoutFps(e.fps))};this.scanContext(t,r).then(function(o){o||!0===e.disableFlip?triggerNextScan():(n.context.translate(n.context.canvas.width,0),n.context.scale(-1,1),n.scanContext(t,r).finally(function(){triggerNextScan()}))}).catch(function(e){n.logger.logError("Error happend while scanning context",e),triggerNextScan()})}},Html5Qrcode.prototype.createVideoConstraints=function(e){if("string"==typeof e)return{deviceId:{exact:e}};if("object"==typeof e){var t="facingMode",r="deviceId",n={user:!0,environment:!0},o="exact",isValidFacingModeValue=function(e){if(e in n)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(e,"'")},i=Object.keys(e);if(1!==i.length)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(i.length," keys");var s=Object.keys(e)[0];if(s!==t&&s!==r)throw"Only '".concat(t,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(s!==t){var c=e.deviceId;if("string"==typeof c)return{deviceId:c};if("object"==typeof c){if(o in c)return{deviceId:{exact:c["".concat(o)]}};throw"'deviceId' should be string or object with"+" ".concat(o," as key.")}throw"Invalid type of 'deviceId' = ".concat(typeof c)}var d=e.facingMode;if("string"==typeof d){if(isValidFacingModeValue(d))return{facingMode:d}}else{if("object"!=typeof d)throw"Invalid type of 'facingMode' = ".concat(typeof d);if(!(o in d))throw"'facingMode' should be string or object with"+" ".concat(o," as key.");if(isValidFacingModeValue(d["".concat(o)]))return{facingMode:{exact:d["".concat(o)]}}}}throw"Invalid type of 'cameraIdOrConfig' = ".concat(typeof e)},Html5Qrcode.prototype.computeCanvasDrawConfig=function(e,t,r,n){if(e<=r&&t<=n)return{x:(r-e)/2,y:(n-t)/2,width:e,height:t};var o=e,i=t;return e>r&&(t*=r/e,e=r),t>n&&(e*=n/t,t=n),this.logger.log("Image downsampled from "+"".concat(o,"X").concat(i)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,r,n)},Html5Qrcode.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},Html5Qrcode.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?F.BORDER_SHADER_MATCH_COLOR:F.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},Html5Qrcode.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},Html5Qrcode.prototype.createCanvasElement=function(e,t,r){var n=e,o=t,i=document.createElement("canvas");return i.style.width="".concat(n,"px"),i.style.height="".concat(o,"px"),i.style.display="none",i.id=isNullOrUndefined(r)?"qr-canvas":r,i},Html5Qrcode.prototype.getShadedRegionBounds=function(e,t,r){if(r.width>e||r.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-r.width)/2,y:(t-r.height)/2,width:r.width,height:r.height}},Html5Qrcode.prototype.possiblyInsertShadingElement=function(e,t,r,n){if(!(t-n.width<1||r-n.height<1)){var o=document.createElement("div");o.style.position="absolute";var i=(t-n.width)/2,s=(r-n.height)/2;if(o.style.borderLeft="".concat(i,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderRight="".concat(i,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderTop="".concat(s,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderBottom="".concat(s,"px solid rgba(0, 0, 0, 0.48)"),o.style.boxSizing="border-box",o.style.top="0px",o.style.bottom="0px",o.style.left="0px",o.style.right="0px",o.id="".concat(F.SHADED_REGION_ELEMENT_ID),t-n.width<11||r-n.height<11)this.hasBorderShaders=!1;else{var c=40;this.insertShaderBorders(o,c,5,-5,null,0,!0),this.insertShaderBorders(o,c,5,-5,null,0,!1),this.insertShaderBorders(o,c,5,null,-5,0,!0),this.insertShaderBorders(o,c,5,null,-5,0,!1),this.insertShaderBorders(o,5,45,-5,null,-5,!0),this.insertShaderBorders(o,5,45,null,-5,-5,!0),this.insertShaderBorders(o,5,45,-5,null,-5,!1),this.insertShaderBorders(o,5,45,null,-5,-5,!1),this.hasBorderShaders=!0}e.append(o)}},Html5Qrcode.prototype.insertShaderBorders=function(e,t,r,n,o,i,s){var c=document.createElement("div");c.style.position="absolute",c.style.backgroundColor=F.BORDER_SHADER_DEFAULT_COLOR,c.style.width="".concat(t,"px"),c.style.height="".concat(r,"px"),null!==n&&(c.style.top="".concat(n,"px")),null!==o&&(c.style.bottom="".concat(o,"px")),s?c.style.left="".concat(i,"px"):c.style.right="".concat(i,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(c),e.appendChild(c)},Html5Qrcode.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},Html5Qrcode.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},Html5Qrcode.prototype.getTimeoutFps=function(e){return 1e3/e},Html5Qrcode}()),function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"}(N||(N={}))}}});
