import{d as a,r as e,o as l,c as o,w as t,u as d,s,b as n,e as i,O as u,ad as c,aM as r,S as p,j as _,ai as f,H as m,J as v,aj as g,bh as k,W as w,n as y,i as h,t as x,ao as b,p as L,V,P as M,Q as j,R as C,F as R,k as P,by as q,b5 as D,y as U,cv as S}from"./index-D9IhqqAc.js";import"./html5-qrcode-D_4nuB1t.js";const A={key:0},N=["src"],O={class:"ion-margin-top"},B=["src"],F={style:{"margin-top":"20px",display:"flex",gap:"12px"}},H=a({__name:"ReviewLocationsView",setup(a){const H=e([]),I=e(!0),J=e(!1),Q=e(null);async function loadPendingLocations(){I.value=!0;const{data:a}=await s.from("locations").select("*").eq("approved",!1).order("created_at",{ascending:!1});H.value=a||[],I.value=!1}function closeModal(){Q.value=null,J.value=!1}return l(loadPendingLocations),(a,e)=>(n(),o(d(U),null,{default:t(()=>[i(d(u),null,{default:t(()=>[i(c,{title:"Review Locations",icon:d(r),showBack:!0,backRoute:"/profile"},null,8,["icon"])]),_:1}),i(d(p),{class:"ion-padding"},{default:t(()=>[I.value?(n(),_("div",A,[i(d(f),null,{default:t(()=>[(n(),_(m,null,v(5,a=>i(d(g),{key:a},{default:t(()=>[i(d(k),{slot:"start"},{default:t(()=>[i(d(w),{animated:"",style:{width:"64px",height:"64px","border-radius":"8px"}})]),_:1}),i(d(y),null,{default:t(()=>[h("h2",null,[i(d(w),{animated:"",style:{width:"60%",height:"16px"}})]),h("p",null,[i(d(w),{animated:"",style:{width:"40%",height:"14px"}})])]),_:1})]),_:2},1024)),64))]),_:1})])):H.value.length?(n(),o(d(f),{key:1},{default:t(()=>[(n(!0),_(m,null,v(H.value,a=>(n(),o(d(g),{key:a.id,button:"",detail:"",onClick:e=>function openLocationModal(a){Q.value=S({...a}),J.value=!0}(a)},{default:t(()=>[i(d(k),{slot:"start"},{default:t(()=>[h("img",{src:a.image,alt:"Location image"},null,8,N)]),_:2},1024),i(d(y),null,{default:t(()=>[h("h2",null,x(a.name),1),h("p",null,x(a.address),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(n(),o(d(b),{key:2,color:"medium"},{default:t(()=>e[5]||(e[5]=[L(" No pending locations. ",-1)])),_:1,__:[5]})),i(d(V),{"is-open":J.value,onDidDismiss:closeModal},{default:t(()=>[i(d(u),null,{default:t(()=>[i(d(M),null,{default:t(()=>[i(d(j),null,{default:t(()=>e[6]||(e[6]=[L("Review Location",-1)])),_:1,__:[6]}),i(d(C),{slot:"end"},{default:t(()=>[i(d(R),{onClick:closeModal},{default:t(()=>e[7]||(e[7]=[L("Close",-1)])),_:1,__:[7]})]),_:1})]),_:1})]),_:1}),i(d(p),{class:"ion-padding"},{default:t(()=>[Q.value?(n(),o(d(f),{key:0},{default:t(()=>[i(d(g),null,{default:t(()=>[i(d(y),{position:"stacked"},{default:t(()=>e[8]||(e[8]=[L("Name",-1)])),_:1,__:[8]}),i(d(q),{modelValue:Q.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>Q.value.name=a)},null,8,["modelValue"])]),_:1}),i(d(g),null,{default:t(()=>[i(d(y),{position:"stacked"},{default:t(()=>e[9]||(e[9]=[L("Address",-1)])),_:1,__:[9]}),i(d(q),{modelValue:Q.value.address,"onUpdate:modelValue":e[1]||(e[1]=a=>Q.value.address=a)},null,8,["modelValue"])]),_:1}),i(d(g),null,{default:t(()=>[i(d(y),{position:"stacked"},{default:t(()=>e[10]||(e[10]=[L("Description",-1)])),_:1,__:[10]}),i(d(D),{modelValue:Q.value.description,"onUpdate:modelValue":e[2]||(e[2]=a=>Q.value.description=a),"auto-grow":""},null,8,["modelValue"])]),_:1}),h("div",O,[h("img",{src:Q.value.image,style:{width:"100%","border-radius":"12px"}},null,8,B)]),h("div",F,[i(d(R),{expand:"block",color:"success",onClick:e[3]||(e[3]=a=>async function approveLocation(a){const{data:e}=await s.auth.getUser(),l=null==e?void 0:e.user;l&&(await s.from("locations").update({name:a.name,address:a.address,description:a.description,approved:!0,approved_by:l.id,approved_at:(new Date).toISOString()}).eq("id",a.id),await loadPendingLocations(),closeModal())}(Q.value))},{default:t(()=>e[11]||(e[11]=[L(" Approve ",-1)])),_:1,__:[11]}),i(d(R),{expand:"block",color:"danger",onClick:e[4]||(e[4]=a=>async function rejectLocation(a){await s.from("locations").delete().eq("id",a),await loadPendingLocations(),closeModal()}(Q.value.id))},{default:t(()=>e[12]||(e[12]=[L(" Reject ",-1)])),_:1,__:[12]})])]),_:1})):P("",!0)]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1}))}});export{H as default};
