System.register(["./index-legacy-DryGZUwD.js","./html5-qrcode-legacy-D5DtuMLO.js"],function(e,a){"use strict";var r,t,l,o,n,c,i,s,d,u,p,v,m,g,f,h,_,y,x,b,k,w,C,P,I,z,$,j,q,S,L,R,V,F,U,B,E,N,O,A,D,H;return{setters:[e=>{r=e.d,t=e.r,l=e.a6,o=e.o,n=e.a8,c=e.c,i=e.w,s=e.u,d=e.s,u=e.B,p=e.b,v=e.e,m=e.O,g=e.ad,f=e.P,h=e.an,_=e.F,y=e.l,x=e.as,b=e.ao,k=e.p,w=e.t,C=e.at,P=e.ap,I=e.au,z=e.av,$=e.i,j=e.c9,q=e.j,S=e.H,L=e.J,R=e.ah,V=e.L,F=e.n,U=e.aw,B=e.S,E=e.k,N=e.D,O=e.W,A=e.ag,D=e.y,H=e._},null],execute:function(){var a=document.createElement("style");a.textContent=".page-description[data-v-85143cd5]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:8px}.discover-grid[data-v-85143cd5]{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}@media (min-width: 768px){.discover-grid[data-v-85143cd5]{grid-template-columns:repeat(auto-fill,minmax(220px,1fr))}}.discover-img[data-v-85143cd5]{width:100%;height:160px;object-fit:contain;background:#fff;border-radius:10px;padding:12px;flex-shrink:0}.discover-name[data-v-85143cd5]{margin-top:6px;font-weight:600;font-size:.95rem;line-height:1.3;text-align:center}.chip-row[data-v-85143cd5]{display:flex;flex-wrap:wrap;gap:4px;justify-content:center;margin-bottom:6px;opacity:.9}.more-chip[data-v-85143cd5]{font-size:12px;opacity:.7}.category-bar[data-v-85143cd5]{display:flex;gap:8px;overflow-x:auto}.category-bar[data-v-85143cd5]::-webkit-scrollbar{display:none}.category-chip[data-v-85143cd5]{--background: transparent;--color: var(--ion-color-medium);--border-color: var(--ion-color-medium);border:1.5px solid var(--border-color);border-radius:999px;font-weight:500;transition:all .2s ease}.category-chip.active[data-v-85143cd5]{--background: var(--ion-color-carrot);--color: #ffffff;--border-color: var(--ion-color-carrot)}.category-chip[data-v-85143cd5]:hover{filter:brightness(1.1)}ion-searchbar.rounded[data-v-85143cd5]{--border-radius: 8px;--box-shadow: 0 1px 3px rgba(0,0,0,.1)}\n",document.head.appendChild(a);const J={class:"filter-section"},T={class:"filter-title"},W={class:"category-bar"},G={class:"discover-grid"},K=["src","alt"],M={class:"chip-row"},Q={class:"discover-name"},X={key:1,class:"text-center text-sm text-gray-500 mt-8"};e("default",H(r({__name:"PartnersListView",setup(e){const a=u(),r=t(!0),H=t([]),Y=t(""),Z=t(!1),ee={gold:3,silver:2,bronze:1},ae=t([]);async function fetchCategories(){const{data:e,error:a}=await d.from("partner_scopes").select("id, name, slug, icon, color").eq("is_active",!0).order("name");a?console.error("[Scopes]",a):ae.value=null!=e?e:[]}async function fetchPartners(){const{data:e,error:a}=await d.from("partners").select("\n      id,\n      name,\n      logo_url,\n      partner_tier,\n      partners_scopes (\n        scope_id,\n        partner_scopes (\n          id,\n          name\n        )\n      )\n    ").eq("is_active",!0);a?console.error("[Partners]",a):re.value=(null!=e?e:[]).map(e=>{var a,r;return{id:e.id,name:e.name,logo:e.logo_url,tier:e.partner_tier,scopeIds:(null!==(a=e.partners_scopes)&&void 0!==a?a:[]).map(e=>e.scope_id),scopes:(null!==(r=e.partners_scopes)&&void 0!==r?r:[]).map(e=>e.partner_scopes.name)}})}const re=t([]),te=l(()=>re.value.filter(e=>{const a=e.name.toLowerCase().includes(Y.value.toLowerCase());if(!H.value.length)return a;const r=e.scopeIds.some(e=>H.value.includes(e));return a&&r}).sort((e,a)=>{var r,t,l,o;const n=null!==(r=ee[null!==(t=e.tier)&&void 0!==t?t:""])&&void 0!==r?r:0,c=null!==(l=ee[null!==(o=a.tier)&&void 0!==o?o:""])&&void 0!==l?l:0;return n!==c?c-n:e.name.localeCompare(a.name)}));function handleSearchInput(e){const a=e.target.value.trim();Y.value=a,a.length>1&&n.log("partner_search",{query:a})}function clearFilters(){n.log("partner_filter_clear",{cleared_categories:H.value}),H.value=[]}return o(async()=>{n.log("partners_page_open"),r.value=!0,await Promise.all([fetchCategories(),fetchPartners()]),r.value=!1}),(e,t)=>(p(),c(s(D),null,{default:i(()=>[v(s(m),null,{default:i(()=>[v(g,{title:e.$t("partner.title"),showBack:!0,backRoute:"/home",icon:"none"},null,8,["title"]),v(s(f),{style:{padding:"8px"}},{default:i(()=>[v(s(h),{modelValue:Y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>Y.value=e),placeholder:e.$t("partner.searchPlaceholder"),debounce:500,class:"rounded",onIonInput:handleSearchInput},null,8,["modelValue","placeholder"])]),_:1}),v(s(f),{class:"search-toolbar"},{default:i(()=>[v(s(_),{fill:"clear",size:"small",onClick:t[1]||(t[1]=e=>Z.value=!Z.value)},{default:i(()=>[v(s(y),{icon:s(x)},null,8,["icon"]),v(s(b),{class:"toolbar-label"},{default:i(()=>[k(" Â  "+w(e.$t("common.filters")),1)]),_:1}),v(s(y),{icon:Z.value?s(C):s(P)},null,8,["icon"])]),_:1}),v(I,{name:"collapse"},{default:i(()=>[z($("div",J,[$("div",T,[v(s(y),{icon:s(j)},null,8,["icon"]),k(" "+w(e.$t("partner.categories")),1)]),$("div",W,[(p(!0),q(S,null,L(ae.value,e=>(p(),c(s(R),{key:e.id,class:V(["category-chip",{active:H.value.includes(e.id)}]),onClick:a=>function toggleCategory(e){const a=H.value.indexOf(e);-1===a?(H.value.push(e),n.log("partner_filter_add",{category_id:e})):(H.value.splice(a,1),n.log("partner_filter_remove",{category_id:e}))}(e.id)},{default:i(()=>[v(s(F),null,{default:i(()=>[k(w(e.name),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])],512),[[U,Z.value]])]),_:1})]),_:1})]),_:1}),v(s(B),{class:"ion-padding"},{default:i(()=>[H.value.length?(p(),c(s(_),{key:0,size:"small",fill:"clear",color:"medium",onClick:clearFilters},{default:i(()=>t[2]||(t[2]=[k(" Clear filters ",-1)])),_:1,__:[2]})):E("",!0),$("div",G,[r.value?(p(),q(S,{key:0},L(4,e=>v(s(N),{key:"skeleton-"+e,class:"discover-item"},{default:i(()=>[v(s(O),{animated:"",style:{width:"100%",height:"140px","border-radius":"12px"}}),v(s(O),{animated:"",style:{width:"80%",height:"16px",margin:"8px auto"}})]),_:2},1024)),64)):(p(!0),q(S,{key:1},L(te.value,e=>(p(),c(s(N),{key:e.id,class:V(["discover-item",e.tier]),onClick:r=>function openPartner(e){n.log("partner_click",{source:"partners_page",partner_id:e.id,partner_name:e.name,partner_tier:e.tier,active_categories:H.value,search_query:Y.value||null}),a.push(`/partner/${e.id}`)}(e)},{default:i(()=>[e.tier?(p(),c(s(A),{key:0,class:V(["tier-badge",e.tier])},{default:i(()=>[k(w(e.tier.toUpperCase())+" PARTNER ",1)]),_:2},1032,["class"])):E("",!0),$("img",{src:e.logo||`https://placehold.co/300x300?text=${encodeURIComponent(e.name)}`,alt:e.name,class:"discover-img"},null,8,K),v(s(F),{class:"discover-label"},{default:i(()=>[$("div",M,[(p(!0),q(S,null,L(e.scopes.slice(0,2),e=>(p(),c(s(R),{key:e,color:"primary"},{default:i(()=>[k(w(e),1)]),_:2},1024))),128)),e.scopes.length>2?(p(),c(s(R),{key:0,color:"medium",class:"more-chip"},{default:i(()=>[k(" +"+w(e.scopes.length-2),1)]),_:2},1024)):E("",!0)]),$("p",Q,w(e.name),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),r.value||0!==te.value.length?E("",!0):(p(),q("p",X," No partner found "))]),_:1})]),_:1}))}}),[["__scopeId","data-v-85143cd5"]]))}}});
